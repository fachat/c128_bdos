
PRA 2.4 .S50


    3 T:27fe  00 28                              .word $2800

    5 T:2800                                    ;PRA 2.4 .S50 ==0801==
    6 T:2800                                    ;****
    7 T:2800                                    fmn=0           ; 1 falls ohne menu
    8 T:2800                                    fci=0           ; 1 falls ohne cli
    9 T:2800                                    eng=0           ; 1 falls englisch
   10 T:2800                                    ;****
   11 T:2800                                    mix=(1-fmn)*(1-fci)
   12 T:2800                                    prg=1
   13 T:2800                                    c128=1
   14 T:2800                                    bdos=$a000
   15 T:2800                                    rs232=0           ; 1 falls rs232 im menue
   16 T:2800                                    ;****

   18 T:2800                                    bufanf=$6c00           ;a-version
   19 T:2800                                    buflen=$0400

   29 T:2800                                    ;****
   30 T:2800                                    keystp=3

   32 T:2800                                     .include "BDK 1.41.S17"

BDK 1.41.S17


    3 T:2800                                    ;BDK 1.41.S17 ==0801==
    4 T:2800                                    setfpar=$ffba
    5 T:2800                                    setfnpar=$ffbd
    6 T:2800                                    open=$ffc0
    7 T:2800                                    close=$ffc3
    8 T:2800                                    chkin=$ffc6
    9 T:2800                                    ckout=$ffc9
   10 T:2800                                    clrch=$ffcc
   11 T:2800                                    basin=$ffcf
   12 T:2800                                    bsout=$ffd2
   13 T:2800                                    getkey=$ffe4
   14 T:2800                                    ;****
   15 T:2800                                    rwbzei=$2e
   16 T:2800                                    abszei=$fc
   17 T:2800                                    dtadr=$fe
   18 T:2800                                    dirzei=$2a
   19 T:2800                                    bf1z=$16
   20 T:2800                                    zei=$18
   21 T:2800                                    pzei=$1a
   22 T:2800                                    tzei=$1e
   23 T:2800                                    dzei=$20
   24 T:2800                                    bfzei=$24
   25 T:2800                                    przei=$3c
   26 T:2800                                    fpzei=$28
   27 T:2800                                    status=$90
   28 T:2800                                    stavec=$02b9
   29 T:2800                                    stash=$02af
   30 T:2800                                    fetvec=$02aa
   31 T:2800                                    fetch=$02a2
   32 T:2800                                    serial=$0a1c
   33 T:2800                                    basirq=$0a04
   34 T:2800                                    ;****
   35 T:2800                                    cia1=$dc00
   36 T:2800                                    cia2=$dd00
   37 T:2800                                    sdr=cia1+$0c
   38 T:2800                                    icr=cia1+$0d
   39 T:2800                                    dra=cia2+$00
   40 T:2800                                    nmicr=cia2+$0d
   41 T:2800                                    cra=cia1+$0e
   42 T:2800                                    mmureg=$d505
   43 T:2800                                    timal=cia1+$04
   44 T:2800                                    timah=cia1+$05
   45 T:2800                                    tcia=cia1
   46 T:2800                                    ;****
   47 T:2800                                    unit=8
   48 T:2800                                    ff=255
   49 T:2800                                    clkin=%01000000
   50 T:2800                                    clkout=%00010000
   51 T:2800                                    backs=$5c
   52 T:2800                                    prgbank=$0e

PRA 2.4 .S50

    1 T:2800                                     .include "BDJ 1.45.S31"

BDJ 1.45.S31


    3 T:2800                                    ;BDJ 1.45.S31 ==0801==

   75 T:2800                                    init=bdos             ; start von vorne
   76 T:2800                                    exit=bdos+3       ; start von vorne
   77 T:2800                                    query=bdos+6       ; disk-format feststellen
   78 T:2800                                    mediach=bdos+9       ; disk gewechselt
   79 T:2800                                    getbpb=bdos+12       ; adr des bpb holen
   80 T:2800                                    floprw=bdos+15       ; pfloprw  ; block lesen/schreiben
   81 T:2800                                    rwabs=bdos+18       ; blockreihe r/w ueber log blocknummer
   82 T:2800                                    flopfmt=bdos+21       ; floppy formatieren
   83 T:2800                                    sgdta=bdos+24       ; adresse dta-puffer setzten/holen
   84 T:2800                                    sgdrive=bdos+27       ; drive holen/setzen
   85 T:2800                                    gtpath=bdos+30       ; holt adresse des aktuellen pfades
   86 T:2800                                    sgnexcl=bdos+33       ; folgecluster holen/setzen
   87 T:2800                                    sfrclus=bdos+36       ; naechsten freien sektor suchen
   88 T:2800                                    gtdskfr=bdos+39       ; freien platz auf der diskette berechnen
   89 T:2800                                    sfirst=bdos+42       ; ersten eintrag in dir suchen nach dta
   90 T:2800                                    sfirso=bdos+45       ; file umbenennen
   91 T:2800                                    snext=bdos+48       ; naechsten eintrag
   92 T:2800                                    chdir=bdos+51       ; directory wechseln
   93 T:2800                                    namedtp=bdos+54       ; pfad fuer prg setzen
   94 T:2800                                    wrentry=bdos+57       ; entry in dta auf disk schreiben
   95 T:2800                                    delete=bdos+60       ; file loeschen
   96 T:2800                                    dcreate=bdos+63       ; file zum ersten mal oeffnen
   97 T:2800                                    mkdir=bdos+66       ; directory anlegen
   98 T:2800                                    rmdir=bdos+69       ; directory loeschen
   99 T:2800                                    dopen=bdos+72       ; file oeffnen
  100 T:2800                                    dclose=bdos+75       ; file schliessen
  101 T:2800                                    dread=bdos+78       ; aus file lesen
  102 T:2800                                    dwrite=bdos+81       ; in file schreiben
  103 T:2800                                    lseek=bdos+84       ; position in file bestimmen
  104 T:2800                                    version=bdos+87       ; versionsblock holen
  105 T:2800                                    reschain=bdos+90       ;
  106 T:2800                                    irqchain=bdos+93       ;
  107 T:2800                                    nmichain=bdos+96       ;
  108 T:2800                                    sgtime=bdos+99       ;
  109 T:2800                                    sgdate=bdos+102       ;
  110 T:2800                                    salarm=bdos+105       ;
  111 T:2800                                    writfat=bdos+108
  112 T:2800                                    readfat=bdos+111
  113 T:2800                                    writbuf=bdos+114
  114 T:2800                                    readbuf=bdos+117
  115 T:2800                                    sfrbuf=bdos+120
  116 T:2800                                    rlbuf=bdos+123
  117 T:2800                                    bufabs=bdos+126
  118 T:2800                                    bfzset=bdos+129
  119 T:2800                                    bfset=bdos+132
  120 T:2800                                    bfget=bdos+135
  121 T:2800                                    bout=bdos+138
  122 T:2800                                    bin=bdos+141
  123 T:2800                                    bcan=bdos+144
  124 T:2800                                    bcaus=bdos+147
  125 T:2800                                    bbcol=bdos+150
  126 T:2800                                    btcol=bdos+153
  127 T:2800                                    bcpos=bdos+156
  128 T:2800                                    bgkey=bdos+159
  129 T:2800                                    bfetch=bdos+162
  130 T:2800                                    bstash=bdos+165
  131 T:2800                                    bfadr=bdos+168
  132 T:2800                                    bsadr=bdos+171
  133 T:2800                                    setvec=bdos+174
  134 T:2800                                    chout=bdos+177
  135 T:2800                                    chodev=bdos+180
  136 T:2800                                    chost=bdos+183
  137 T:2800                                    chin=bdos+186
  138 T:2800                                    chidev=bdos+189
  139 T:2800                                    chist=bdos+192
  140 T:2800                                    devout=bdos+195
  141 T:2800                                    devin=bdos+198
  142 T:2800                                    devcmd=bdos+201

PRA 2.4 .S50

    1 T:2800                                     .include "BDS 1.44.S24"

BDS 1.44.S24


    3 T:2800                                    ;BDS 1.44.S24 ==0801==
    4 T:2800                                    dfval=%10000000
    5 T:2800                                    dfwrit=%01000000
    6 T:2800                                    pathlen=64
    7 T:2800                                    ;****  struktur versions-block
    8 T:2800                                    vever=0           ;2 byte version
    9 T:2800                                    vebufanz=2           ;bufanz
   10 T:2800                                    vepathle=3           ;pathlen
   11 T:2800                                    veanzdrv=4           ;anzdrv
   12 T:2800                                    vefpbanz=5           ;fpbanz
   13 T:2800                                    vejmpadr=6           ;adresse jmp-tabelle
   14 T:2800                                    vetext=16           ;text by a.fachat
   15 T:2800                                    ;****  struktur pblock fuer floprw
   16 T:2800                                    pbrwflag=0           ;byte
   17 T:2800                                    pbdrive=1           ;byte
   18 T:2800                                    pbside=2           ;byte
   19 T:2800                                    pbtrack=3           ;byte
   20 T:2800                                    pbsector=4           ;byte
   21 T:2800                                    pbbuffer=5           ;word
   22 T:2800                                    pbbank=7           ;byte
   23 T:2800                                    ;****  struktur bios-parameter-block (32 byte)
   24 T:2800                                    bprecsiz=0           ;word
   25 T:2800                                    bpclsiz=2           ;word
   26 T:2800                                    bpclsizb=4           ;word
   27 T:2800                                    bprdlen=6           ;word
   28 T:2800                                    bpfsiz=8           ;word
   29 T:2800                                    bpfatrec=10           ;word
   30 T:2800                                    bpdatrec=12           ;word
   31 T:2800                                    bpnumcl=14           ;word
   32 T:2800                                    bflags=16           ;word
   33 T:2800                                    bptracks=18           ;word
   34 T:2800                                    bpsides=20           ;word
   35 T:2800                                    bpspts=22           ;word
   36 T:2800                                    bpspt=24           ;word
   37 T:2800                                    bphidden=26           ;word
   38 T:2800                                    bpserial=28           ;3 byte
   39 T:2800                                    bpbval=31           ;byte
   40 T:2800                                    bpbfat=32           ;byte
   41 T:2800                                    bpbflag=33           ;byte
   41 T:2800                                    bpblen=34
   42 T:2800                                    bpdirclu=34           ;word
   43 T:2800                                    bppath=36           ;64 byte
   44 T:2800                                    bpplen=bppath+pathlen
   45 T:2800                                    ;**** struktur boot-sektor (8-29)
   46 T:2800                                    btserial=8           ;3 byte
   47 T:2800                                    btbps=11           ;word
   48 T:2800                                    btspc=13           ;byte
   49 T:2800                                    btres=14           ;word
   50 T:2800                                    btfat=16           ;byte
   51 T:2800                                    btdir=17           ;word
   52 T:2800                                    btsec=19           ;word
   53 T:2800                                    btmedia=21           ;byte
   54 T:2800                                    btspf=22           ;word
   55 T:2800                                    btspt=24           ;word
   56 T:2800                                    btside=26           ;word
   57 T:2800                                    bthid=28           ;word
   58 T:2800                                    ;**** struktur abspar
   59 T:2800                                    aprwflag=0           ;byte
   60 T:2800                                    apdrive=1           ;byte
   61 T:2800                                    aprecord=2           ;word
   62 T:2800                                    apanz=4           ;word
   63 T:2800                                    apbuffer=6           ;word
   64 T:2800                                    apbank=8           ;byte
   65 T:2800                                    ;**** struktur disk-transfer-puffer
   66 T:2800                                    dsname=0           ;name 8 byte
   67 T:2800                                    dsext=8           ;ext 3 byte
   68 T:2800                                    dsattr=11           ;fileattribut als suchmaske
   69 T:2800                                    dgname=12           ;gefundener name
   70 T:2800                                    dgext=20           ;gefundene ext
   71 T:2800                                    dgattr=23           ;gefundenes attr
   72 T:2800                                    dgclus=24           ;first cluster
   73 T:2800                                    dgsize=26           ;groesse
   74 T:2800                                    dgsec=30           ;sekunden
   75 T:2800                                    dgmin=31           ;minuten
   76 T:2800                                    dghour=32           ;stunden
   77 T:2800                                    dgday=33           ;tag
   78 T:2800                                    dgmonth=34           ;monat
   79 T:2800                                    dgyear=35           ;jahr-1980
   80 T:2800                                    dtpos=36           ;nummer des dir-eintrags
   81 T:2800                                    dtflag=37           ;flag fuer leeren/gueltigen eintrag suchen
   82 T:2800                                    dtanz=38           ;max anz eintraege in 1 block
   83 T:2800                                    dtdrv=39           ;drive
   84 T:2800                                    dtclus=40           ;aktueller cluster
   85 T:2800                                    dtsec=42           ;aktueller sektor (im cluster)
   86 T:2800                                    dtstart=44           ;startcluster des dir
   87 T:2800                                    dtplen=46           ;laenge des dtp
   88 T:2800                                    ;**** struktur dir-eintrag
   89 T:2800                                    dename=0           ;name 8 byte
   90 T:2800                                    deext=8           ;ext 3 byte
   91 T:2800                                    deattr=11           ;fileattribut als suchmaske
   92 T:2800                                    deuhr=22           ;uhrzeit
   93 T:2800                                    dedate=24           ;datum
   94 T:2800                                    defclus=26           ;erster cluster
   95 T:2800                                    desize=28           ;file-laenge
   96 T:2800                                    ;**** struktur file-parameter-block
   97 T:2800                                    fpname=dgname             ;name
   98 T:2800                                    fpext=dgext             ;extension
   99 T:2800                                    fpdrive=dtdrv             ;drive
  100 T:2800                                    fphandle=dtplen+0       ;file-handle nr
  101 T:2800                                    fpos=dtplen+1       ;position read-write in datei
  102 T:2800                                    fpsize=dgsize             ;groesse der datei
  103 T:2800                                    fpstart=dgclus             ;startcluster der datei
  104 T:2800                                    fpclus=dtplen+5       ;aktueller cluster
  105 T:2800                                    fpsec=dtplen+7       ;aktueller sektor im cluster
  106 T:2800                                    fpbyt=dtplen+9       ;aktuelles byte im sektor
  107 T:2800                                    fpanz=dtplen+11       ;anzahl zu lesender byte
  108 T:2800                                    fpadr=dtplen+13       ;adresse fuer read-write
  109 T:2800                                    fpshift=dtplen+15       ;anzahl fuer lseek
  110 T:2800                                    fpdir=dtplen+19       ;flag fuer lseek
  111 T:2800                                    fpbuf=dtplen+20       ;puffer-nr
  112 T:2800                                    fpflag=dtplen+21       ;flag fuer wrentry bei close
  113 T:2800                                    fpbank=dtplen+22       ;bank fuer r/w
  114 T:2800                                    fpblen=dtplen+23       ;laenge des fpb
  115 T:2800                                    ;**** struktur getname-transfer-puffer
  116 T:2800                                    gndrive=0           ;drive
  117 T:2800                                    gnflag=1           ;flag fuer letzten namen im suchpfad
  118 T:2800                                    gnact=2           ;cluster des root-dir des letzten eintrags
  119 T:2800                                    gnfile=4           ;startcluster des letzten suchnamens
  120 T:2800                                    gnpath=6           ;64 byte gefundener pfad
  121 T:2800                                    ;**** struktur getpath
  122 T:2800                                    gpclus=0           ; startcluster
  123 T:2800                                    gppath=2           ; path
  124 T:2800                                    ;**** struktur setvektor
  125 T:2800                                    svanz=0           ; anzahl zu linkender vektoren
  126 T:2800                                    ; svadr/new/old sind zeiger auf arrays der angegebenen adressen
  127 T:2800                                    svadr=2           ; adressen in der vektor-tabelle [ (xxx-bdos)*2/3 ]
  128 T:2800                                    svnew=4           ; liste der neuen vektor-adressen
  129 T:2800                                    svold=6           ; platz fuer alte vektor-adressen

PRA 2.4 .S50

    1 T:2800                                     .include "BDE 1.4 .S14"

BDE 1.4 .S14


    3 T:2800                                    ;BDE 1.4 .S14 ==0801==
    4 T:2800                                    enok=0
    5 T:2800                                    ennotimp=<-1
    6 T:2800                                    entxrx=<-2
    7 T:2800                                    enslow=<-3
    8 T:2800                                    engcr=<-4
    9 T:2800                                    enprange=<-5
   10 T:2800                                    enclnf=<-6
   11 T:2800                                    endnfnd=<-7
   12 T:2800                                    enactdir=<-8
   13 T:2800                                    ennotfnd=<-9
   14 T:2800                                    enpovr=<-10
   15 T:2800                                    enillnam=<-11
   16 T:2800                                    endskful=<-12
   17 T:2800                                    enfexist=<-13
   18 T:2800                                    ennempty=<-14
   19 T:2800                                    enilldrv=<-15
   20 T:2800                                    endnrdy=<-16
   21 T:2800                                    entmnyf=<-17
   22 T:2800                                    enfopen=<-18
   23 T:2800                                    enfnopen=<-19
   24 T:2800                                    eneof=<-20
   25 T:2800                                    ennbfre=<-21
   26 T:2800                                    enbreak=<-22

PRA 2.4 .S50

    1 T:2800                                     .include "WPK 2.0 .S4 "

WPK 2.0 .S4 


    3 T:2800                                    ;WPK 2.0 .S4  ==0801==
    4 T:2800                                    lzei=$0e
    5 T:2800                                    lmzei=$10
    6 T:2800                                    wzei=$12
    7 T:2800                                    wszei=$1c
    8 T:2800                                    wczei=$22
    9 T:2800                                    oldfpb=$26
   10 T:2800                                    newfpb=$2c
   11 T:2800                                    ;****
   12 T:2800                                    iobuf=$0200

PRA 2.4 .S50

    1 T:2800                                     .include "PR1 2.4 .S63"

PR1 2.4 .S63


    3 T:2800                                    ;PR1 2.4 .S63 ==0801==
    4 T:2800                                    czei=$30
    5 T:2800  85 30                              sta czei
    5 T:2802  84 31                              sty czei+1
    6 T:2804  20 92 3a                           jsr prtinit
    7 T:2807  a9 08                              lda #8
    7 T:2809  8d 33 40                           sta iecunit
    8 T:280c  a9 00                              lda #0
    8 T:280e  8d 34 40                           sta prtdev
    8 T:2811  8d 35 40                           sta prtfl
    9 T:2814                                    ;lda #0
    9 T:2814  a2 0d                              ldx #13

   12 T:2816  8d 70 40                           sta clibcol
   13 T:2819  8e 6f 40                           stx clitcol

   18 T:281c  8d 8f 40                           sta menubcol
   19 T:281f  8e 8e 40                           stx menutcol
   20 T:2822  a9 80                              lda #128
   21 T:2824  8d 91 40                           sta sofl
   22 T:2827  a9 00                              lda #0
   23 T:2829  8d 92 40                           sta sonk

   25 T:282c  20 2b 29                           jsr gbyt
   25 T:282f  b0 0c                              bcs gblfe
   25 T:2831  8a                                 txa 
   25 T:2832  c9 10                              cmp #16
   25 T:2834  90 02                              bcc gbl1
   25 T:2836  e9 06                              sbc #6
   26 T:2838  29 0f                    gbl1      and #15
   26 T:283a  8d 33 40                           sta iecunit
   27 T:283d  20 2b 29                 gblfe     jsr gbyt
   27 T:2840  b0 06                              bcs gbl3b
   28 T:2842  8a                                 txa 
   28 T:2843  29 0f                              and #15
   28 T:2845  8d 34 40                           sta prtdev
   29 T:2848  20 2b 29                 gbl3b     jsr gbyt
   29 T:284b  b0 06                              bcs gbl3a
   30 T:284d  8a                                 txa 
   30 T:284e  29 3f                              and #63
   30 T:2850  8d 35 40                           sta prtfl
   31 T:2853  20 2b 29                 gbl3a     jsr gbyt
   31 T:2856  b0 06                              bcs gbl3

   34 T:2858  8e 6f 40                           stx clitcol

   38 T:285b  8e 8e 40                           stx menutcol

   40 T:285e  20 2b 29                 gbl3      jsr gbyt
   40 T:2861  b0 06                              bcs gbl4

   43 T:2863  8e 70 40                           stx clibcol

   47 T:2866  8e 8f 40                           stx menubcol

   49 T:2869  20 eb 28                 gbl4      jsr gadr
   49 T:286c  90 04                              bcc gblok
   50 T:286e  a2 00                              ldx #<buflen
   50 T:2870  a0 04                              ldy #>buflen
   51 T:2872  8e 00 40                 gblok     stx prblen
   51 T:2875  8c 01 40                           sty prblen+1

   55 T:2878  a9 01                              lda #1
   55 T:287a  8d 54 40                           sta flag
   56 T:287d  a2 05                              ldx #5
   56 T:287f  bd 00 01                 p001      lda $0100,x
   56 T:2882  9d 39 40                           sta dosd0,x
   56 T:2885  ca                                 dex 
   56 T:2886  10 f7                              bpl p001
   57 T:2888  a2 a4                              ldx #<datum
   57 T:288a  a0 57                              ldy #>datum
   57 T:288c  38                                 sec 
   57 T:288d  20 66 a0                           jsr sgdate

   64 T:2890  4c f6 3a                           jmp menuprg

   66 T:2893                                    ;********** c128

   68 T:2893                                    buf=$0200
   69 T:2893  e6 30                    chrget    inc czei
   69 T:2895  d0 02                              bne chrgot
   69 T:2897  e6 31                              inc czei+1
   70 T:2899  a0 00                    chrgot    ldy #0
   70 T:289b  b1 30                              lda (czei),y
   70 T:289d  f0 04                              beq chrg1
   70 T:289f  c9 20                              cmp #" "
   70 T:28a1  f0 f0                              beq chrget
   70 T:28a3  60                       chrg1     rts 

   73 T:28a4                                    ;**********
   74 T:28a4  a2 00                    linein    ldx #0
   74 T:28a6  20 cf ff                 l1        jsr $ffcf
   74 T:28a9  f0 fb                              beq l1
   75 T:28ab  c9 0d                              cmp #13
   75 T:28ad  f0 08                              beq l2
   76 T:28af  9d 00 02                           sta buf,x
   76 T:28b2  e8                                 inx 
   76 T:28b3  e0 50                              cpx #80
   76 T:28b5  90 ef                              bcc l1
   77 T:28b7  a9 00                    l2        lda #0
   77 T:28b9  9d 00 02                           sta buf,x
   78 T:28bc  a9 0d                              lda #13
   78 T:28be  20 b1 a0                           jsr chout
   79 T:28c1  a9 00                              lda #<buf
   79 T:28c3  a0 02                              ldy #>buf
   79 T:28c5  60                                 rts 

   81 T:28c6                                    ;****
   82 T:28c6  20 99 28                 gfnib     jsr chrgot
   82 T:28c9  4c d2 28                           jmp glnib
   83 T:28cc  e6 30                    gnib      inc czei
   83 T:28ce  d0 02                              bne glnib
   83 T:28d0  e6 31                              inc czei+1
   84 T:28d2  a0 00                    glnib     ldy #0
   84 T:28d4  b1 30                              lda (czei),y
   84 T:28d6  f0 11                              beq glend
   84 T:28d8  c9 20                              cmp #" "
   84 T:28da  f0 0d                              beq glend
   85 T:28dc  38                                 sec 
   85 T:28dd  e9 30                              sbc #"0"
   85 T:28df  c9 0a                              cmp #10
   85 T:28e1  90 02                              bcc glok
   85 T:28e3  e9 07                              sbc #7
   85 T:28e5  29 0f                    glok      and #$0f
   85 T:28e7  18                                 clc 
   85 T:28e8  60                                 rts 
   86 T:28e9  38                       glend     sec 
   86 T:28ea  60                                 rts 
   87 T:28eb  a9 00                    gadr      lda #0
   87 T:28ed  8d 31 40                           sta fadr
   87 T:28f0  8d 32 40                           sta fadr+1
   88 T:28f3  20 c6 28                           jsr gfnib
   88 T:28f6  b0 2a                              bcs gadre1
   88 T:28f8  4c fe 28                           jmp gadr1
   89 T:28fb  20 cc 28                 gnnib     jsr gnib
   89 T:28fe  b0 21                    gadr1     bcs gadre
   90 T:2900  0e 31 40                           asl fadr
   90 T:2903  2e 32 40                           rol fadr+1
   90 T:2906  0e 31 40                           asl fadr
   90 T:2909  2e 32 40                           rol fadr+1
   91 T:290c  0e 31 40                           asl fadr
   91 T:290f  2e 32 40                           rol fadr+1
   91 T:2912  0e 31 40                           asl fadr
   91 T:2915  2e 32 40                           rol fadr+1
   92 T:2918  0d 31 40                           ora fadr
   92 T:291b  8d 31 40                           sta fadr
   92 T:291e  4c fb 28                           jmp gnnib
   93 T:2921  18                       gadre     clc 
   93 T:2922  ae 31 40                 gadre1    ldx fadr
   93 T:2925  ac 32 40                           ldy fadr+1
   93 T:2928  a9 00                              lda #0
   93 T:292a  60                                 rts 
   94 T:292b  20 eb 28                 gbyt      jsr gadr
   94 T:292e  98                                 tya 
   94 T:292f  d0 01                              bne gbyte
   94 T:2931  60                                 rts 
   95 T:2932  a9 fb                    gbyte     lda #enprange
   95 T:2934  60                                 rts 

   98 T:2935  20 2b 29                 gdrv      jsr gbyt
   98 T:2938  d0 10                              bne gdrve
   98 T:293a  b0 0f                              bcs gdrvold
   99 T:293c  e0 0a                              cpx #$0a
   99 T:293e  90 08                              bcc gdrve1
  100 T:2940  8a                                 txa 
  100 T:2941  38                                 sec 
  100 T:2942  e9 0a                              sbc #$0a
  100 T:2944  aa                                 tax 
  101 T:2945  a9 00                              lda #0
  101 T:2947  60                                 rts 
  101 T:2948  a9 f1                    gdrve1    lda #enilldrv
  101 T:294a  60                       gdrve     rts 
  102 T:294b  18                       gdrvold   clc 
  102 T:294c  20 1b a0                           jsr sgdrive
  102 T:294f  aa                                 tax 
  102 T:2950  a9 00                              lda #0
  102 T:2952  60                                 rts 
  103 T:2953  a9 20                    spout     lda #" "
  103 T:2955  4c b1 a0                           jmp chout
  104 T:2958                                    ;**********
  105 T:2958  ad 70 40                 cliprg    lda clibcol
  105 T:295b  20 ca 51                           jsr setbck
  105 T:295e  ad 6f 40                           lda clitcol
  105 T:2961  20 cd 51                           jsr settxt
  106 T:2964  a9 88                              lda #<coprt
  106 T:2966  a0 56                              ldy #>coprt
  106 T:2968  20 8f 38                           jsr textout
  106 T:296b  a9 01                              lda #1
  106 T:296d  8d 54 40                           sta flag
  106 T:2970  20 55 2a                           jsr crout
  107 T:2973  20 57 a0                           jsr version
  107 T:2976  8a                                 txa 
  107 T:2977  18                                 clc 
  107 T:2978  69 10                              adc #vetext
  107 T:297a  90 01                              bcc ver1
  107 T:297c  c8                                 iny 
  107 T:297d  20 8f 38                 ver1      jsr textout
  108 T:2980  20 55 2a                           jsr crout
  108 T:2983  20 55 2a                           jsr crout
  109 T:2986  ad 54 40                 prg1      lda flag
  109 T:2989  29 01                              and #1
  109 T:298b  f0 0f                              beq prg1a
  110 T:298d  18                                 clc 
  110 T:298e  20 1b a0                           jsr sgdrive
  110 T:2991  18                                 clc 
  110 T:2992  69 41                              adc #"A"             ;"a"
  110 T:2994  20 b1 a0                           jsr chout
  110 T:2997  a9 3e                              lda #">"
  110 T:2999  20 b1 a0                           jsr chout
  111 T:299c  20 a4 28                 prg1a     jsr linein
  112 T:299f  18                                 clc 
  112 T:29a0  69 ff                              adc #$ff
  112 T:29a2  85 30                              sta czei
  112 T:29a4  98                                 tya 
  112 T:29a5  69 ff                              adc #$ff
  112 T:29a7  85 31                              sta czei+1
  113 T:29a9  20 93 28                 prg3      jsr chrget
  113 T:29ac  c9 3e                              cmp #">"
  113 T:29ae  f0 f9                              beq prg3
  114 T:29b0  a0 01                              ldy #1
  114 T:29b2  b1 30                              lda (czei),y
  114 T:29b4  c9 3e                              cmp #">"
  114 T:29b6  f0 f1                              beq prg3
  115 T:29b8  20 e5 29                           jsr sbef
  116 T:29bb  f0 09                              beq prg2
  116 T:29bd  20 d3 29                           jsr exec
  116 T:29c0  20 38 2a                 prg6      jsr errout
  116 T:29c3  4c 86 29                           jmp prg1

  118 T:29c6                           prg2      

  124 T:29c6  a5 30                    prg4      lda czei
  124 T:29c8  a4 31                              ldy czei+1
  124 T:29ca  20 33 a0                           jsr chdir
  124 T:29cd  20 38 2a                           jsr errout
  125 T:29d0  4c 86 29                           jmp prg1
  126 T:29d3  aa                       exec      tax 
  126 T:29d4  ca                                 dex 
  126 T:29d5  8a                                 txa 
  126 T:29d6  0a                                 asl 
  126 T:29d7  a8                                 tay 
  127 T:29d8  b9 43 56                           lda adr+1,y
  127 T:29db  48                                 pha 
  127 T:29dc  b9 42 56                           lda adr,y
  127 T:29df  48                                 pha 
  128 T:29e0  a5 30                              lda czei
  128 T:29e2  a4 31                              ldy czei+1
  129 T:29e4  60                                 rts 
  130 T:29e5                                    ;**********
  131 T:29e5  a2 01                    sbef      ldx #1
  131 T:29e7  8e 50 40                           stx cnt
  131 T:29ea  ca                                 dex 
  131 T:29eb  a0 00                    sb1       ldy #0
  132 T:29ed  bd d0 55                 sb2       lda bef,x
  132 T:29f0  f0 38                              beq notf
  133 T:29f2  38                                 sec 
  133 T:29f3  f1 30                              sbc (czei),y
  134 T:29f5  f0 06                              beq nexc
  134 T:29f7  c9 80                              cmp #$80
  134 T:29f9  d0 06                              bne nexb
  134 T:29fb  f0 12                              beq fnd
  135 T:29fd  e8                       nexc      inx 
  135 T:29fe  c8                                 iny 
  135 T:29ff  d0 ec                              bne sb2
  136 T:2a01  bd d0 55                 nexb      lda bef,x
  136 T:2a04  10 06                              bpl sb3
  136 T:2a06  e8                                 inx 
  136 T:2a07  ee 50 40                           inc cnt
  136 T:2a0a  d0 df                              bne sb1
  137 T:2a0c  e8                       sb3       inx 
  137 T:2a0d  d0 f2                              bne nexb
  138 T:2a0f  c8                       fnd       iny 
  138 T:2a10  b1 30                              lda (czei),y
  138 T:2a12  f0 08                              beq fnd2
  138 T:2a14  c9 41                              cmp #"A"
  138 T:2a16  90 04                              bcc fnd2
  138 T:2a18  c9 5b                              cmp #"Z"+1
  138 T:2a1a  90 e5                              bcc nexb
  139 T:2a1c  98                       fnd2      tya 
  139 T:2a1d  18                                 clc 
  139 T:2a1e  65 30                              adc czei
  139 T:2a20  85 30                              sta czei
  140 T:2a22  90 02                              bcc fnd1
  140 T:2a24  e6 31                              inc czei+1
  140 T:2a26  ad 50 40                 fnd1      lda cnt
  140 T:2a29  60                                 rts 
  141 T:2a2a  a9 00                    notf      lda #0
  141 T:2a2c  60                                 rts 
  142 T:2a2d  ad 54 40                 pp        lda flag
  142 T:2a30  49 01                              eor #1
  142 T:2a32  8d 54 40                           sta flag                ; prompt
  142 T:2a35  a9 00                              lda #0
  142 T:2a37  60                                 rts 
  143 T:2a38                                    ;*********
  144 T:2a38  aa                       errout    tax 
  144 T:2a39  f0 1a                              beq crout
  144 T:2a3b  20 55 2a                           jsr crout
  144 T:2a3e  8a                                 txa 
  145 T:2a3f  20 5f 2a                           jsr errtxt
  145 T:2a42  85 18                              sta zei
  145 T:2a44  84 19                              sty zei+1
  146 T:2a46  a0 00                              ldy #0
  147 T:2a48  b1 18                    erro1     lda (zei),y
  147 T:2a4a  f0 06                              beq erro2
  147 T:2a4c  20 b1 a0                           jsr chout
  147 T:2a4f  c8                                 iny 
  147 T:2a50  d0 f6                              bne erro1
  148 T:2a52                           erro2     
  149 T:2a52  20 55 2a                           jsr crout
  149 T:2a55  a9 0d                    crout     lda #13
  149 T:2a57  4c b1 a0                           jmp chout
  150 T:2a5a                                    ;**********

  153 T:2a5a  68                       pmenu     pla 
  153 T:2a5b  68                                 pla 
  153 T:2a5c  4c f6 3a                           jmp menuprg

  159 T:2a5f                                    ;**********
  160 T:2a5f  a2 00                    errtxt    ldx #0
  161 T:2a61  dd a7 57                 errt1     cmp errnum,x
  161 T:2a64  f0 1a                              beq errt2
  162 T:2a66  e8                                 inx 
  162 T:2a67  e0 2d                              cpx #erranz
  162 T:2a69  d0 f6                              bne errt1
  163 T:2a6b  a2 00                              ldx #0
  163 T:2a6d  20 57 4e                           jsr hexbuf
  164 T:2a70  bd 03 5b                 errt3     lda errnumt-2,x
  164 T:2a73  9d 00 02                           sta iobuf,x
  164 T:2a76  f0 03                              beq errte
  164 T:2a78  e8                                 inx 
  164 T:2a79  d0 f5                              bne errt3
  165 T:2a7b  a9 00                    errte     lda #<iobuf
  165 T:2a7d  a0 02                              ldy #>iobuf
  165 T:2a7f  60                                 rts 
  166 T:2a80  a9 d4                    errt2     lda #<ert
  166 T:2a82  85 18                              sta zei
  166 T:2a84  a9 57                              lda #>ert
  166 T:2a86  85 19                              sta zei+1
  167 T:2a88  e8                                 inx 
  167 T:2a89  a0 00                    errt4     ldy #0
  168 T:2a8b  ca                                 dex 
  168 T:2a8c  f0 14                              beq errtok
  169 T:2a8e  b1 18                    errt5     lda (zei),y
  169 T:2a90  f0 03                              beq errt6
  169 T:2a92  c8                                 iny 
  169 T:2a93  d0 f9                              bne errt5
  170 T:2a95  c8                       errt6     iny 
  170 T:2a96  98                                 tya 
  170 T:2a97  18                                 clc 
  170 T:2a98  65 18                              adc zei
  170 T:2a9a  85 18                              sta zei
  170 T:2a9c  90 eb                              bcc errt4
  170 T:2a9e  e6 19                              inc zei+1
  170 T:2aa0  d0 e7                              bne errt4
  171 T:2aa2  a5 18                    errtok    lda zei
  171 T:2aa4  a4 19                              ldy zei+1
  171 T:2aa6  60                                 rts 
  172 T:2aa7                                    ;********

PRA 2.4 .S50

    1 T:2aa7                                     .include "PR2 2.4 .S60"

PR2 2.4 .S60


    3 T:2aa7                                    ;PR2 2.4 .S60 ==0801==

    6 T:2aa7  85 18                    lload     sta zei
    6 T:2aa9  84 19                              sty zei+1
    6 T:2aab  a0 00                              ldy #0
    7 T:2aad  b1 18                    lll0      lda (zei),y
    7 T:2aaf  f0 08                              beq lll2
    7 T:2ab1  c9 2f                              cmp #"/"
    7 T:2ab3  f0 03                              beq lll1
    7 T:2ab5  c8                                 iny 
    7 T:2ab6  d0 f5                              bne lll0
    8 T:2ab8  c8                       lll1      iny 
    8 T:2ab9  98                       lll2      tya 
    8 T:2aba  18                                 clc 
    8 T:2abb  65 18                              adc zei
    8 T:2abd  8d 59 40                           sta fad2
    8 T:2ac0  a5 19                              lda zei+1
    8 T:2ac2  69 00                              adc #0
    8 T:2ac4  8d 5a 40                           sta fad2+1
    9 T:2ac7  a5 18                              lda zei
    9 T:2ac9  a4 19                              ldy zei+1
   10 T:2acb  20 28 2c                           jsr rwopen
   11 T:2ace  d0 2e                              bne llor1a
   12 T:2ad0  a0 39                              ldy #fpanz
   12 T:2ad2  a9 02                              lda #2
   12 T:2ad4  91 18                              sta (zei),y
   12 T:2ad6  c8                                 iny 
   12 T:2ad7  a9 00                              lda #0
   12 T:2ad9  91 18                              sta (zei),y
   13 T:2adb  a0 44                              ldy #fpbank
   13 T:2add  a9 0e                              lda #prgbank
   13 T:2adf  91 18                              sta (zei),y
   14 T:2ae1  a0 3b                              ldy #fpadr
   14 T:2ae3  a9 00                              lda #<buffer
   14 T:2ae5  91 18                              sta (zei),y
   14 T:2ae7  c8                                 iny 
   14 T:2ae8  a9 6c                              lda #>buffer
   14 T:2aea  91 18                              sta (zei),y
   15 T:2aec  a5 18                              lda zei
   15 T:2aee  8d 5d 40                           sta fl1
   15 T:2af1  a5 19                              lda zei+1
   15 T:2af3  8d 5e 40                           sta fl1+1
   16 T:2af6  ae 51 40                           ldx handle
   16 T:2af9  20 4e a0                           jsr dread
   16 T:2afc  d0 3b                              bne lloe
   17 T:2afe  d0 58                    llor1a    bne llor
   18 T:2b00  ad 5d 40                           lda fl1
   18 T:2b03  85 18                              sta zei
   18 T:2b05  ad 5e 40                           lda fl1+1
   18 T:2b08  85 19                              sta zei+1
   19 T:2b0a  a0 3b                              ldy #fpadr
   20 T:2b0c  ad 00 6c                           lda buffer
   20 T:2b0f  8d 57 40                           sta nadr
   20 T:2b12  91 18                              sta (zei),y
   21 T:2b14  ad 01 6c                           lda buffer+1
   21 T:2b17  8d 58 40                           sta nadr+1
   21 T:2b1a  c8                                 iny 
   21 T:2b1b  91 18                              sta (zei),y
   22 T:2b1d  a0 1a                              ldy #fpsize
   22 T:2b1f  b1 18                              lda (zei),y
   22 T:2b21  aa                                 tax 
   22 T:2b22  c8                                 iny 
   22 T:2b23  b1 18                              lda (zei),y
   23 T:2b25  a0 3a                              ldy #fpanz+1
   23 T:2b27  91 18                              sta (zei),y
   23 T:2b29  88                                 dey 
   23 T:2b2a  8a                                 txa 
   23 T:2b2b  91 18                              sta (zei),y
   24 T:2b2d  ae 51 40                           ldx handle
   24 T:2b30  20 4e a0                           jsr dread
   24 T:2b33  c9 ec                              cmp #eneof
   24 T:2b35  d0 02                              bne lloe
   24 T:2b37  a9 00                              lda #0
   25 T:2b39  48                       lloe      pha 
   25 T:2b3a  ae 51 40                           ldx handle
   25 T:2b3d  20 4b a0                           jsr dclose
   25 T:2b40  68                                 pla 
   25 T:2b41  d0 15                              bne llor
   26 T:2b43  ad 57 40                           lda nadr
   26 T:2b46  8d 6d 40                           sta llvec
   26 T:2b49  ad 58 40                           lda nadr+1
   26 T:2b4c  8d 6e 40                           sta llvec+1
   27 T:2b4f  ad 59 40                           lda fad2
   27 T:2b52  ac 5a 40                           ldy fad2+1
   28 T:2b55  6c 6d 40                           jmp (llvec)
   28 T:2b58  60                       llor      rts 
   29 T:2b59                                    ;**********
   30 T:2b59  a2 e7                    del       ldx #$e7
   30 T:2b5b  4c 3c a0                           jmp delete
   31 T:2b5e                                    ;**********
   32 T:2b5e  4c 42 a0                 md        jmp mkdir
   33 T:2b61                                    ;**********
   34 T:2b61  4c 45 a0                 rd        jmp rmdir
   35 T:2b64                                    ;**********
   36 T:2b64  a2 20                    cr        ldx #$20
   36 T:2b66  4c 3f a0                           jmp dcreate
   37 T:2b69                                    ;**********

   39 T:2b69  85 30                    pformat   sta czei
   39 T:2b6b  84 31                              sty czei+1
   39 T:2b6d  a9 01                              lda #1
   39 T:2b6f  8d 30 40                           sta fformat
   40 T:2b72  20 99 28                 pff0      jsr chrgot
   40 T:2b75  f0 27                              beq pfo1
   40 T:2b77  c9 2f                              cmp #"/"
   40 T:2b79  d0 0d                              bne pff1
   41 T:2b7b  20 93 28                           jsr chrget
   41 T:2b7e  20 2b 29                           jsr gbyt
   41 T:2b81  d0 ef                              bne pff0
   42 T:2b83  8e 30 40                           stx fformat
   42 T:2b86  f0 ea                              beq pff0
   43 T:2b88  aa                       pff1      tax 
   43 T:2b89  a0 01                              ldy #1
   43 T:2b8b  b1 30                              lda (czei),y
   43 T:2b8d  c9 3a                              cmp #":"
   43 T:2b8f  d0 0d                              bne pfo1
   44 T:2b91  20 93 28                           jsr chrget
   44 T:2b94  20 93 28                           jsr chrget
   45 T:2b97  8a                                 txa 
   45 T:2b98  38                                 sec 
   45 T:2b99  e9 41                              sbc #"A"
   45 T:2b9b  4c a2 2b                           jmp pfo2
   46 T:2b9e  18                       pfo1      clc 
   46 T:2b9f  20 1b a0                           jsr sgdrive
   47 T:2ba2  8d 31 40                 pfo2      sta fadr
   47 T:2ba5  ae 30 40                           ldx fformat
   47 T:2ba8  20 15 a0                           jsr flopfmt
   47 T:2bab  d0 71                              bne pfoe
   48 T:2bad  20 99 28                           jsr chrgot
   48 T:2bb0  f0 6c                              beq pfoe
   49 T:2bb2  ad 31 40                           lda fadr
   49 T:2bb5  38                                 sec 
   49 T:2bb6  20 1b a0                           jsr sgdrive
   49 T:2bb9  d0 63                              bne pfoe
   50 T:2bbb  a9 02                              lda #<ddtp
   50 T:2bbd  a0 40                              ldy #>ddtp
   50 T:2bbf  38                                 sec 
   50 T:2bc0  20 18 a0                           jsr sgdta
   51 T:2bc3  a9 00                              lda #0
   51 T:2bc5  aa                                 tax 
   51 T:2bc6  a0 01                              ldy #1             ; ersten leeren eintrag
   51 T:2bc8  20 2d a0                           jsr sfirso
   51 T:2bcb  d0 51                              bne pfoe
   52 T:2bcd  a0 00                              ldy #0
   52 T:2bcf  a2 00                              ldx #0
   53 T:2bd1  b1 30                    pfo3      lda (czei),y
   53 T:2bd3  f0 18                              beq pfoleer
   54 T:2bd5  c9 2e                              cmp #"."
   54 T:2bd7  f0 15                              beq pfoext
   55 T:2bd9  9d 0e 40                           sta ddtp+dgname,x
   55 T:2bdc  c8                                 iny 
   55 T:2bdd  e8                                 inx 
   55 T:2bde  e0 08                              cpx #8
   55 T:2be0  90 ef                              bcc pfo3
   56 T:2be2  b1 30                    pfo3a     lda (czei),y
   56 T:2be4  f0 07                              beq pfoleer
   57 T:2be6  c9 2e                              cmp #"."
   57 T:2be8  f0 04                              beq pfoext
   58 T:2bea  c8                                 iny 
   58 T:2beb  d0 f5                              bne pfo3a
   58 T:2bed  88                       pfoleer   dey 
   59 T:2bee  a9 20                    pfoext    lda #" "
   59 T:2bf0  e0 08                              cpx #8
   59 T:2bf2  f0 06                              beq pfoex1
   60 T:2bf4  9d 0e 40                           sta ddtp+dgname,x
   60 T:2bf7  e8                                 inx 
   60 T:2bf8  d0 f4                              bne pfoext
   61 T:2bfa  c8                       pfoex1    iny 
   61 T:2bfb  a2 00                              ldx #0
   62 T:2bfd  b1 30                    pfo4      lda (czei),y
   62 T:2bff  f0 09                              beq pfoend
   63 T:2c01  9d 16 40                           sta ddtp+dgext,x
   64 T:2c04  c8                                 iny 
   64 T:2c05  e8                                 inx 
   64 T:2c06  e0 03                              cpx #3
   64 T:2c08  d0 f3                              bne pfo4
   65 T:2c0a  a9 20                    pfoend    lda #" "
   65 T:2c0c  e0 03                              cpx #3
   65 T:2c0e  f0 06                              beq pfoe1
   66 T:2c10  9d 16 40                           sta ddtp+dgext,x
   66 T:2c13  e8                                 inx 
   66 T:2c14  d0 f4                              bne pfoend
   67 T:2c16  a9 08                    pfoe1     lda #$08
   67 T:2c18  8d 19 40                           sta ddtp+dgattr
   68 T:2c1b  4c 39 a0                           jmp wrentry
   68 T:2c1e  60                       pfoe      rts 

   71 T:2c1f                                    ;**********
   72 T:2c1f  4c 33 a0                 cd        jmp chdir
   73 T:2c22                                    ;**********
   74 T:2c22  20 03 a0                 ex        jsr exit
   74 T:2c25  6c fc ff                           jmp ($fffc)
   75 T:2c28                                    ;**********
   76 T:2c28  20 48 a0                 rwopen    jsr dopen
   76 T:2c2b  86 18                              stx zei
   76 T:2c2d  84 19                              sty zei+1
   76 T:2c2f  d0 19                              bne prwe
   77 T:2c31  8e 31 40                           stx fadr
   77 T:2c34  8c 32 40                           sty fadr+1
   78 T:2c37  a0 2e                              ldy #fphandle
   78 T:2c39  b1 18                              lda (zei),y
   78 T:2c3b  8d 51 40                           sta handle
   79 T:2c3e  a0 1a                              ldy #fpsize
   79 T:2c40  b1 18                    flen2     lda (zei),y
   80 T:2c42  99 45 40                           sta laenge-fpsize,y
   80 T:2c45  c8                                 iny 
   80 T:2c46  c0 1e                              cpy #fpsize+4
   80 T:2c48  d0 f6                              bne flen2
   80 T:2c4a  60                       prwe      rts 
   81 T:2c4b                                    ;****
   82 T:2c4b  20 28 2c                 pread     jsr rwopen
   82 T:2c4e  d0 6e                              bne preade
   83 T:2c50  20 32 3a                           jsr prttst
   83 T:2c53  ad 31 40                 read      lda fadr
   83 T:2c56  85 18                              sta zei
   83 T:2c58  ad 32 40                           lda fadr+1
   83 T:2c5b  85 19                              sta zei+1
   84 T:2c5d  a0 39                              ldy #fpanz
   84 T:2c5f  ad 00 40                           lda prblen
   84 T:2c62  91 18                              sta (zei),y
   84 T:2c64  c8                                 iny 
   84 T:2c65  ad 01 40                           lda prblen+1
   84 T:2c68  91 18                              sta (zei),y
   85 T:2c6a  a0 3b                              ldy #fpadr
   85 T:2c6c  a9 00                              lda #<buffer
   85 T:2c6e  91 18                              sta (zei),y
   85 T:2c70  c8                                 iny 
   85 T:2c71  a9 6c                              lda #>buffer
   85 T:2c73  91 18                              sta (zei),y
   86 T:2c75  a0 44                              ldy #fpbank
   86 T:2c77  a9 0e                              lda #prgbank
   86 T:2c79  91 18                              sta (zei),y
   87 T:2c7b  ae 51 40                           ldx handle
   87 T:2c7e  20 4e a0                           jsr dread
   87 T:2c81  d0 2e                              bne pread1
   88 T:2c83  ae 00 40                           ldx prblen
   88 T:2c86  ac 01 40                           ldy prblen+1
   88 T:2c89  20 ca 2c                           jsr rdprint
   88 T:2c8c  b0 23                              bcs pread1
   89 T:2c8e  ad 5f 40                           lda laenge
   89 T:2c91  38                                 sec 
   89 T:2c92  ed 00 40                           sbc prblen
   89 T:2c95  8d 5f 40                           sta laenge
   90 T:2c98  ad 60 40                           lda laenge+1
   90 T:2c9b  ed 01 40                           sbc prblen+1
   90 T:2c9e  8d 60 40                           sta laenge+1
   91 T:2ca1  b0 0b                              bcs rd1
   91 T:2ca3  ad 61 40                           lda laenge+2
   91 T:2ca6  d0 03                              bne rd2
   91 T:2ca8  ce 62 40                           dec laenge+3
   91 T:2cab  ce 61 40                 rd2       dec laenge+2
   92 T:2cae  4c 53 2c                 rd1       jmp read
   93 T:2cb1  c9 ec                    pread1    cmp #eneof
   93 T:2cb3  d0 09                              bne preade
   94 T:2cb5  ae 5f 40                           ldx laenge
   94 T:2cb8  ac 60 40                           ldy laenge+1
   94 T:2cbb  20 ca 2c                           jsr rdprint
   95 T:2cbe  48                       preade    pha 
   95 T:2cbf  ae 51 40                           ldx handle
   95 T:2cc2  20 4b a0                           jsr dclose
   95 T:2cc5  20 49 3a                           jsr prtoff
   95 T:2cc8  68                                 pla 
   95 T:2cc9  60                                 rts 
   96 T:2cca                                    ;****
   97 T:2cca  8e 5b 40                 rdprint   stx tplen
   97 T:2ccd  8c 5c 40                           sty tplen+1
   98 T:2cd0  8a                                 txa 
   98 T:2cd1  0d 5c 40                           ora tplen+1
   98 T:2cd4  f0 33                              beq wrle
   99 T:2cd6  a9 00                              lda #<buffer
   99 T:2cd8  85 18                              sta zei
   99 T:2cda  a9 6c                              lda #>buffer
   99 T:2cdc  85 19                              sta zei+1
  100 T:2cde  a0 00                    rdp1      ldy #0
  100 T:2ce0  b1 18                              lda (zei),y
  100 T:2ce2  20 b1 a0                           jsr chout
  101 T:2ce5  20 9f a0                           jsr bgkey
  101 T:2ce8  c9 03                              cmp #3
  101 T:2cea  d0 04                              bne wrls
  101 T:2cec  a9 ea                              lda #enbreak
  101 T:2cee  38                                 sec 
  101 T:2cef  60                                 rts 
  102 T:2cf0  e6 18                    wrls      inc zei
  102 T:2cf2  d0 02                              bne rdp1a
  102 T:2cf4  e6 19                              inc zei+1
  103 T:2cf6  ad 5b 40                 rdp1a     lda tplen
  103 T:2cf9  d0 03                              bne rdp2
  103 T:2cfb  ce 5c 40                           dec tplen+1
  103 T:2cfe  ce 5b 40                 rdp2      dec tplen
  104 T:2d01  ad 5b 40                           lda tplen
  104 T:2d04  0d 5c 40                           ora tplen+1
  104 T:2d07  d0 d5                              bne rdp1
  105 T:2d09  18                       wrle      clc 
  105 T:2d0a  60                                 rts 
  106 T:2d0b                                    ;**********
  107 T:2d0b  8d 57 40                 pwrite    sta nadr
  107 T:2d0e  8c 58 40                           sty nadr+1
  107 T:2d11  a2 20                              ldx #$20
  107 T:2d13  20 3f a0                           jsr dcreate
  108 T:2d16  d0 f1                              bne wrle
  108 T:2d18  ad 57 40                           lda nadr
  108 T:2d1b  ac 58 40                           ldy nadr+1
  108 T:2d1e  20 28 2c                           jsr rwopen
  108 T:2d21  d0 43                              bne pwritee
  109 T:2d23  20 6f 2d                 wrloop    jsr wrinput
  109 T:2d26  8d 53 40                           sta st1
  110 T:2d29  8e 5b 40                           stx tplen
  110 T:2d2c  8c 5c 40                           sty tplen+1
  111 T:2d2f  ad 31 40                           lda fadr
  111 T:2d32  85 18                              sta zei
  111 T:2d34  ad 32 40                           lda fadr+1
  111 T:2d37  85 19                              sta zei+1
  112 T:2d39  a0 39                              ldy #fpanz
  112 T:2d3b  ad 5b 40                           lda tplen
  112 T:2d3e  91 18                              sta (zei),y
  112 T:2d40  c8                                 iny 
  112 T:2d41  ad 5c 40                           lda tplen+1
  112 T:2d44  91 18                              sta (zei),y
  113 T:2d46  a0 3b                              ldy #fpadr
  113 T:2d48  a9 00                              lda #<buffer
  113 T:2d4a  91 18                              sta (zei),y
  113 T:2d4c  c8                                 iny 
  113 T:2d4d  a9 6c                              lda #>buffer
  113 T:2d4f  91 18                              sta (zei),y
  114 T:2d51  a0 44                              ldy #fpbank
  114 T:2d53  a9 0e                              lda #prgbank
  114 T:2d55  91 18                              sta (zei),y
  115 T:2d57  ae 51 40                           ldx handle
  115 T:2d5a  20 51 a0                           jsr dwrite
  115 T:2d5d  d0 07                              bne pwritee
  116 T:2d5f  ad 53 40                           lda st1
  116 T:2d62  f0 bf                              beq wrloop
  117 T:2d64  a9 00                              lda #0
  117 T:2d66  48                       pwritee   pha 
  117 T:2d67  ae 51 40                           ldx handle
  117 T:2d6a  20 4b a0                           jsr dclose
  117 T:2d6d  68                                 pla 
  117 T:2d6e  60                                 rts 
  118 T:2d6f                                    ;****
  119 T:2d6f  a9 00                    wrinput   lda #<buffer
  119 T:2d71  85 18                              sta zei
  119 T:2d73  a9 6c                              lda #>buffer
  119 T:2d75  85 19                              sta zei+1
  120 T:2d77  a9 00                              lda #0
  120 T:2d79  8d 5b 40                           sta tplen
  120 T:2d7c  8d 5c 40                           sta tplen+1
  121 T:2d7f  20 9f a0                 wril      jsr bgkey
  121 T:2d82  f0 fb                              beq wril
  121 T:2d84  20 b1 a0                           jsr chout
  121 T:2d87  a0 00                              ldy #0
  121 T:2d89  91 18                              sta (zei),y
  121 T:2d8b  48                                 pha 
  122 T:2d8c  e6 18                              inc zei
  122 T:2d8e  d0 02                              bne wri1
  122 T:2d90  e6 19                              inc zei+1
  123 T:2d92  ee 5b 40                 wri1      inc tplen
  123 T:2d95  d0 03                              bne wri2
  123 T:2d97  ee 5c 40                           inc tplen+1
  124 T:2d9a  68                       wri2      pla 
  124 T:2d9b  c9 03                              cmp #3             ;run/stop
  124 T:2d9d  f0 13                              beq wrie
  125 T:2d9f  ad 5c 40                           lda tplen+1
  125 T:2da2  cd 01 40                           cmp prblen+1
  125 T:2da5  d0 d8                              bne wril
  126 T:2da7  ad 5b 40                           lda tplen
  126 T:2daa  cd 00 40                           cmp prblen
  126 T:2dad  d0 d0                              bne wril
  127 T:2daf  a9 00                              lda #0
  127 T:2db1  2c                                 .byt $2c
  127 T:2db2  a9 ec                    wrie      lda #eneof
  128 T:2db4  ae 5b 40                           ldx tplen
  128 T:2db7  ac 5c 40                           ldy tplen+1
  128 T:2dba  60                                 rts 
  129 T:2dbb                                    ;*********
  130 T:2dbb  85 18                    pcopy     sta zei
  130 T:2dbd  84 19                              sty zei+1
  130 T:2dbf  a2 00                              ldx #0
  131 T:2dc1  a0 ff                              ldy #<-1
  131 T:2dc3  c8                       pcc1      iny 
  131 T:2dc4  b1 18                              lda (zei),y
  131 T:2dc6  f0 15                              beq pcce
  131 T:2dc8  c9 20                              cmp #" "
  131 T:2dca  f0 f7                              beq pcc1
  132 T:2dcc  b1 18                    pcc2      lda (zei),y
  133 T:2dce  c9 20                              cmp #" "
  133 T:2dd0  f0 0b                              beq pcc3a
  133 T:2dd2  9d 00 01                           sta dbuf,x
  133 T:2dd5  c9 00                              cmp #0
  133 T:2dd7  f0 04                              beq pcce
  134 T:2dd9  c8                                 iny 
  134 T:2dda  e8                                 inx 
  134 T:2ddb  d0 ef                              bne pcc2
  135 T:2ddd  a9 00                    pcc3a pcce lda #0
  135 T:2ddf  9d 00 01                           sta dbuf,x
  136 T:2de2  88                                 dey 
  136 T:2de3  c8                       pcc4      iny 
  136 T:2de4  b1 18                              lda (zei),y
  136 T:2de6  c9 20                              cmp #" "
  136 T:2de8  f0 f9                              beq pcc4
  137 T:2dea  98                                 tya 
  137 T:2deb  18                                 clc 
  137 T:2dec  65 18                              adc zei
  137 T:2dee  8d 57 40                           sta nadr
  137 T:2df1  a5 19                              lda zei+1
  137 T:2df3  69 00                              adc #0
  137 T:2df5  8d 58 40                           sta nadr+1
  138 T:2df8  20 15 31                           jsr gsoutar
  138 T:2dfb  d0 03                              bne pcc3
  138 T:2dfd  a9 ea                              lda #enbreak
  138 T:2dff  60                                 rts 
  139 T:2e00  a9 00                    pcc3      lda #<dbuf
  139 T:2e02  a0 01                              ldy #>dbuf
  139 T:2e04  20 28 2c                           jsr rwopen
  139 T:2e07  d0 0b                              bne pcerr1a
  140 T:2e09  ad 57 40                           lda nadr
  140 T:2e0c  ac 58 40                           ldy nadr+1
  140 T:2e0f  a2 20                              ldx #$20
  140 T:2e11  20 3f a0                           jsr dcreate
  141 T:2e14  d0 79                    pcerr1a   bne pcerr1b
  142 T:2e16  ad 57 40                           lda nadr
  142 T:2e19  ac 58 40                           ldy nadr+1
  142 T:2e1c  20 48 a0                           jsr dopen
  142 T:2e1f  8e 59 40                           stx fad2
  142 T:2e22  8c 5a 40                           sty fad2+1
  142 T:2e25  08                                 php 
  143 T:2e26  86 18                              stx zei
  143 T:2e28  84 19                              sty zei+1
  143 T:2e2a  a0 2e                              ldy #fphandle
  143 T:2e2c  b1 18                              lda (zei),y
  144 T:2e2e  8d 52 40                           sta handl2
  144 T:2e31  28                                 plp 
  144 T:2e32  d0 5d                              bne pcerr2a
  145 T:2e34  ad 31 40                 pcread    lda fadr
  145 T:2e37  85 18                              sta zei
  145 T:2e39  ad 32 40                           lda fadr+1
  145 T:2e3c  85 19                              sta zei+1
  146 T:2e3e  a0 39                              ldy #fpanz
  146 T:2e40  ad 00 40                           lda prblen
  146 T:2e43  91 18                              sta (zei),y
  146 T:2e45  c8                                 iny 
  146 T:2e46  ad 01 40                           lda prblen+1
  146 T:2e49  91 18                              sta (zei),y
  147 T:2e4b  a0 3b                              ldy #fpadr
  147 T:2e4d  a9 00                              lda #<buffer
  147 T:2e4f  91 18                              sta (zei),y
  147 T:2e51  c8                                 iny 
  147 T:2e52  a9 6c                              lda #>buffer
  147 T:2e54  91 18                              sta (zei),y
  148 T:2e56  a0 44                              ldy #fpbank
  148 T:2e58  a9 0e                              lda #prgbank
  148 T:2e5a  91 18                              sta (zei),y
  149 T:2e5c  ae 51 40                           ldx handle
  149 T:2e5f  20 4e a0                           jsr dread
  149 T:2e62  8d 53 40                           sta st1
  149 T:2e65  c9 ec                              cmp #eneof
  149 T:2e67  f0 35                              beq pcrwa
  150 T:2e69  ad 01 40                           lda prblen+1
  150 T:2e6c  8d 5c 40                           sta tplen+1
  150 T:2e6f  ad 00 40                           lda prblen
  150 T:2e72  8d 5b 40                           sta tplen
  151 T:2e75  ad 5f 40                           lda laenge
  151 T:2e78  38                                 sec 
  151 T:2e79  ed 00 40                           sbc prblen
  151 T:2e7c  8d 5f 40                           sta laenge
  152 T:2e7f  ad 60 40                           lda laenge+1
  152 T:2e82  ed 01 40                           sbc prblen+1
  152 T:2e85  8d 60 40                           sta laenge+1
  152 T:2e88  b0 0f                              bcs pcrw1
  153 T:2e8a  ad 61 40                           lda laenge+2
  153 T:2e8d  d0 07                              bne pcrw2
  154 T:2e8f  d0 5c                    pcerr1b   bne pcerr1
  154 T:2e91  d0 52                    pcerr2a   bne pcerr2
  155 T:2e93  ce 62 40                           dec laenge+3
  155 T:2e96  ce 61 40                 pcrw2     dec laenge+2
  156 T:2e99  4c aa 2e                 pcrw1     jmp pcrw3
  156 T:2e9c  f0 96                    pcreada   beq pcread
  157 T:2e9e  ad 5f 40                 pcrwa     lda laenge
  157 T:2ea1  8d 5b 40                           sta tplen
  158 T:2ea4  ad 60 40                           lda laenge+1
  158 T:2ea7  8d 5c 40                           sta tplen+1
  159 T:2eaa  ad 59 40                 pcrw3     lda fad2
  159 T:2ead  85 18                              sta zei
  159 T:2eaf  ad 5a 40                           lda fad2+1
  159 T:2eb2  85 19                              sta zei+1
  160 T:2eb4  a0 39                              ldy #fpanz
  160 T:2eb6  ad 5b 40                           lda tplen
  160 T:2eb9  91 18                              sta (zei),y
  160 T:2ebb  c8                                 iny 
  160 T:2ebc  ad 5c 40                           lda tplen+1
  160 T:2ebf  91 18                              sta (zei),y
  161 T:2ec1  a0 3b                              ldy #fpadr
  161 T:2ec3  a9 00                              lda #<buffer
  161 T:2ec5  91 18                              sta (zei),y
  161 T:2ec7  c8                                 iny 
  161 T:2ec8  a9 6c                              lda #>buffer
  161 T:2eca  91 18                              sta (zei),y
  162 T:2ecc  a0 44                              ldy #fpbank
  162 T:2ece  a9 0e                              lda #prgbank
  162 T:2ed0  91 18                              sta (zei),y
  163 T:2ed2  ae 52 40                           ldx handl2
  163 T:2ed5  20 51 a0                           jsr dwrite
  163 T:2ed8  d0 0b                              bne pcerr2
  164 T:2eda  ad 53 40                           lda st1
  164 T:2edd  f0 bd                              beq pcreada
  164 T:2edf  c9 ec                              cmp #eneof
  164 T:2ee1  d0 02                              bne pcerr2
  164 T:2ee3  a9 00                              lda #0
  165 T:2ee5  48                       pcerr2    pha 
  165 T:2ee6  ae 52 40                           ldx handl2
  165 T:2ee9  20 4b a0                           jsr dclose
  165 T:2eec  68                                 pla 
  166 T:2eed  48                       pcerr1    pha 
  166 T:2eee  ae 51 40                           ldx handle
  166 T:2ef1  20 4b a0                           jsr dclose
  166 T:2ef4  68                                 pla 
  166 T:2ef5  60                                 rts 
  167 T:2ef6                                    ;**********
  168 T:2ef6  85 18                    psave     sta zei
  168 T:2ef8  84 19                              sty zei+1
  168 T:2efa  a2 00                              ldx #0
  169 T:2efc  a0 ff                              ldy #<-1
  169 T:2efe  c8                       pss1      iny 
  169 T:2eff  b1 18                              lda (zei),y
  169 T:2f01  f0 15                              beq psse
  169 T:2f03  c9 20                              cmp #" "
  169 T:2f05  f0 f7                              beq pss1
  170 T:2f07  b1 18                    pss2      lda (zei),y
  171 T:2f09  c9 20                              cmp #" "
  171 T:2f0b  f0 0b                              beq pss3a
  171 T:2f0d  9d 00 01                           sta dbuf,x
  171 T:2f10  c9 00                              cmp #0
  171 T:2f12  f0 04                              beq psse
  172 T:2f14  c8                                 iny 
  172 T:2f15  e8                                 inx 
  172 T:2f16  d0 ef                              bne pss2
  173 T:2f18  a9 00                    pss3a psse lda #0
  173 T:2f1a  9d 00 01                           sta dbuf,x
  174 T:2f1d  88                                 dey 
  174 T:2f1e  c8                       pss4      iny 
  174 T:2f1f  b1 18                              lda (zei),y
  174 T:2f21  c9 20                              cmp #" "
  174 T:2f23  f0 f9                              beq pss4
  175 T:2f25  98                                 tya 
  175 T:2f26  18                                 clc 
  175 T:2f27  65 18                              adc zei
  175 T:2f29  85 18                              sta zei
  175 T:2f2b  a5 19                              lda zei+1
  175 T:2f2d  69 00                              adc #0
  175 T:2f2f  85 19                              sta zei+1
  176 T:2f31  a0 00                              ldy #0
  176 T:2f33  b1 18                    psa1      lda (zei),y
  176 T:2f35  99 00 02                           sta buf,y
  176 T:2f38  f0 03                              beq psa2
  176 T:2f3a  c8                                 iny 
  176 T:2f3b  d0 f6                              bne psa1
  177 T:2f3d  8c 41 40                 psa2      sty dint1
  177 T:2f40  98                                 tya 
  177 T:2f41  a2 00                              ldx #<buf
  177 T:2f43  a0 02                              ldy #>buf
  177 T:2f45  20 bd ff                           jsr setfnpar
  178 T:2f48  ae 33 40                           ldx iecunit
  178 T:2f4b  a9 01                              lda #1
  178 T:2f4d  a0 01                              ldy #1
  178 T:2f4f  20 ba ff                           jsr setfpar
  179 T:2f52                                    ;****
  180 T:2f52  a0 00                              ldy #0
  180 T:2f54  b9 00 02                 pts1      lda buf,y
  180 T:2f57  c8                                 iny 
  180 T:2f58  c9 20                              cmp #" "
  180 T:2f5a  f0 f8                              beq pts1
  181 T:2f5c  29 0f                              and #$0f
  181 T:2f5e  8d 55 40                           sta dr1
  181 T:2f61  b9 00 02                           lda buf,y
  181 T:2f64  c9 3a                              cmp #":"
  181 T:2f66  f0 05                              beq pts2
  182 T:2f68  a9 00                              lda #0
  182 T:2f6a  8d 55 40                           sta dr1
  183 T:2f6d  a0 00                    pts2      ldy #0
  183 T:2f6f  b9 00 01                 pts3      lda dbuf,y
  183 T:2f72  c8                                 iny 
  183 T:2f73  c9 20                              cmp #" "
  183 T:2f75  f0 f8                              beq pts3
  184 T:2f77  38                                 sec 
  184 T:2f78  e9 41                              sbc #"A"
  184 T:2f7a  8d 56 40                           sta dr2
  184 T:2f7d  b9 00 01                           lda dbuf,y
  184 T:2f80  c9 3a                              cmp #":"
  184 T:2f82  f0 07                              beq pts4
  185 T:2f84  18                                 clc 
  185 T:2f85  20 1b a0                           jsr sgdrive
  186 T:2f88  8d 56 40                           sta dr2
  187 T:2f8b  20 fe 32                 pts4      jsr drvtest
  187 T:2f8e  90 03                              bcc pls1
  188 T:2f90  4c 7b 30                           jmp pss
  189 T:2f93                                    ;****
  190 T:2f93  20 15 31                 pls1      jsr gsoutar
  190 T:2f96  d0 03                              bne pls1a
  190 T:2f98  a9 ea                              lda #enbreak
  190 T:2f9a  60                                 rts 
  191 T:2f9b  a9 00                    pls1a     lda #<dbuf
  191 T:2f9d  a0 01                              ldy #>dbuf
  191 T:2f9f  20 28 2c                           jsr rwopen
  191 T:2fa2  d0 09                              bne psaerr1a
  192 T:2fa4  20 c0 ff                           jsr open
  192 T:2fa7  90 06                              bcc psa3
  192 T:2fa9  a9 ff                              lda #ennotimp
  192 T:2fab  d0 73                              bne psaerr2
  193 T:2fad  d0 78                    psaerr1a  bne psaerr1
  193 T:2faf                           psa3      
  194 T:2faf  ad 31 40                 psread    lda fadr
  194 T:2fb2  85 18                              sta zei
  194 T:2fb4  ad 32 40                           lda fadr+1
  194 T:2fb7  85 19                              sta zei+1
  195 T:2fb9  a0 39                              ldy #fpanz
  195 T:2fbb  ad 00 40                           lda prblen
  195 T:2fbe  91 18                              sta (zei),y
  195 T:2fc0  c8                                 iny 
  195 T:2fc1  ad 01 40                           lda prblen+1
  195 T:2fc4  91 18                              sta (zei),y
  196 T:2fc6  a0 3b                              ldy #fpadr
  196 T:2fc8  a9 00                              lda #<buffer
  196 T:2fca  91 18                              sta (zei),y
  196 T:2fcc  c8                                 iny 
  196 T:2fcd  a9 6c                              lda #>buffer
  196 T:2fcf  91 18                              sta (zei),y
  197 T:2fd1  a0 44                              ldy #fpbank
  197 T:2fd3  a9 0e                              lda #prgbank
  197 T:2fd5  91 18                              sta (zei),y
  198 T:2fd7  ae 51 40                           ldx handle
  198 T:2fda  20 4e a0                           jsr dread
  198 T:2fdd  d0 32                              bne psa4
  199 T:2fdf  ae 00 40                           ldx prblen
  199 T:2fe2  ac 01 40                           ldy prblen+1
  199 T:2fe5  20 30 30                 psa5      jsr ppsave
  199 T:2fe8  f0 04                              beq psa4a
  200 T:2fea  a9 f0                              lda #endnrdy
  200 T:2fec  d0 23                              bne psa4
  201 T:2fee  ad 5f 40                 psa4a     lda laenge
  201 T:2ff1  38                                 sec 
  201 T:2ff2  ed 00 40                           sbc prblen
  201 T:2ff5  8d 5f 40                           sta laenge
  202 T:2ff8  ad 60 40                           lda laenge+1
  202 T:2ffb  ed 01 40                           sbc prblen+1
  202 T:2ffe  8d 60 40                           sta laenge+1
  203 T:3001  b0 0b                              bcs rs1
  203 T:3003  ad 61 40                           lda laenge+2
  203 T:3006  d0 03                              bne rs2
  203 T:3008  ce 62 40                           dec laenge+3
  203 T:300b  ce 61 40                 rs2       dec laenge+2
  204 T:300e  4c af 2f                 rs1       jmp psread
  205 T:3011  c9 ec                    psa4      cmp #eneof
  205 T:3013  d0 0b                              bne psaerr2
  206 T:3015  ae 5f 40                           ldx laenge
  206 T:3018  ac 60 40                           ldy laenge+1
  206 T:301b  20 30 30                           jsr ppsave
  206 T:301e  a9 00                              lda #0
  207 T:3020  48                       psaerr2   pha 
  207 T:3021  a9 01                              lda #1
  207 T:3023  20 c3 ff                           jsr close
  207 T:3026  68                                 pla 
  208 T:3027  48                       psaerr1   pha 
  208 T:3028  ae 51 40                           ldx handle
  208 T:302b  20 4b a0                           jsr dclose
  208 T:302e  68                                 pla 
  208 T:302f  60                                 rts 
  209 T:3030  8e 5b 40                 ppsave    stx tplen
  209 T:3033  8c 5c 40                           sty tplen+1
  210 T:3036  8a                                 txa 
  210 T:3037  0d 5c 40                           ora tplen+1
  210 T:303a  f0 3e                              beq pssx
  211 T:303c  a9 00                              lda #0
  211 T:303e  85 90                              sta status
  211 T:3040  a2 01                              ldx #1
  211 T:3042  20 c9 ff                           jsr ckout
  211 T:3045  90 04                              bcc ppsav1
  211 T:3047  09 40                              ora #64
  211 T:3049  d0 2f                              bne pssx
  212 T:304b  a9 00                    ppsav1    lda #<buffer
  212 T:304d  85 18                              sta zei
  212 T:304f  a9 6c                              lda #>buffer
  212 T:3051  85 19                              sta zei+1
  213 T:3053  a0 00                              ldy #0
  213 T:3055  b1 18                    ppsa1     lda (zei),y
  213 T:3057  20 d2 ff                           jsr bsout
  213 T:305a  e6 18                              inc zei
  213 T:305c  d0 02                              bne pssa2
  213 T:305e  e6 19                              inc zei+1
  214 T:3060  ad 5b 40                 pssa2     lda tplen
  214 T:3063  d0 03                              bne pssa3
  214 T:3065  ce 5c 40                           dec tplen+1
  214 T:3068  ce 5b 40                 pssa3     dec tplen
  215 T:306b  ad 5b 40                           lda tplen
  215 T:306e  0d 5c 40                           ora tplen+1
  215 T:3071  d0 e2                              bne ppsa1
  216 T:3073  20 cc ff                           jsr clrch
  216 T:3076  a5 90                              lda status
  216 T:3078  29 bf                              and #255-64
  216 T:307a  60                       pssx      rts 
  217 T:307b                                    ;****
  218 T:307b  20 f7 30                 pss       jsr gsource
  218 T:307e  f0 71                              beq psse3
  219 T:3080  a9 00                              lda #<dbuf
  219 T:3082  a0 01                              ldy #>dbuf
  219 T:3084  20 28 2c                           jsr rwopen
  219 T:3087  d0 24                              bne pssee1
  220 T:3089  a0 39                              ldy #fpanz
  220 T:308b  ad 00 40                           lda prblen
  220 T:308e  91 18                              sta (zei),y
  220 T:3090  c8                                 iny 
  220 T:3091  ad 01 40                           lda prblen+1
  220 T:3094  91 18                              sta (zei),y
  221 T:3096  a0 3b                              ldy #fpadr
  221 T:3098  a9 00                              lda #<buffer
  221 T:309a  91 18                              sta (zei),y
  221 T:309c  c8                                 iny 
  221 T:309d  a9 6c                              lda #>buffer
  221 T:309f  91 18                              sta (zei),y
  222 T:30a1  a0 44                              ldy #fpbank
  222 T:30a3  a9 0e                              lda #prgbank
  222 T:30a5  91 18                              sta (zei),y
  223 T:30a7  ae 51 40                           ldx handle
  223 T:30aa  20 4e a0                           jsr dread
  224 T:30ad  48                       pssee1    pha 
  224 T:30ae  ae 51 40                           ldx handle
  224 T:30b1  20 4b a0                           jsr dclose
  224 T:30b4  68                                 pla 
  225 T:30b5  f0 37                              beq psse1
  226 T:30b7  c9 ec                              cmp #eneof
  226 T:30b9  d0 3b                              bne pssee
  227 T:30bb  20 06 31                           jsr gtarget
  227 T:30be  f0 31                              beq psse3
  228 T:30c0  ad 41 40                           lda dint1
  228 T:30c3  a2 00                              ldx #<buf
  228 T:30c5  a0 02                              ldy #>buf
  228 T:30c7  20 bd ff                           jsr setfnpar
  229 T:30ca  ae 33 40                           ldx iecunit
  229 T:30cd  a9 01                              lda #1
  229 T:30cf  a0 01                              ldy #1
  229 T:30d1  20 ba ff                           jsr setfpar
  230 T:30d4  20 c0 ff                           jsr open
  230 T:30d7  b0 1b                              bcs psse2
  231 T:30d9  ae 5f 40                           ldx laenge
  231 T:30dc  ac 60 40                           ldy laenge+1
  231 T:30df  20 30 30                           jsr ppsave
  231 T:30e2  f0 02                              beq pssex
  231 T:30e4  a9 f0                              lda #endnrdy
  232 T:30e6  48                       pssex     pha 
  232 T:30e7  a9 01                              lda #1
  232 T:30e9  20 c3 ff                           jsr close
  232 T:30ec  68                                 pla 
  232 T:30ed  60                                 rts 
  233 T:30ee  a9 fb                    psse1     lda #enprange
  233 T:30f0  2c                                 .byt $2c
  234 T:30f1  a9 ea                    psse3     lda #enbreak
  234 T:30f3  2c                                 .byt $2c
  235 T:30f4  a9 ff                    psse2     lda #ennotimp
  236 T:30f6  60                       pssee     rts 
  237 T:30f7                                    ;****
  238 T:30f7  a9 c9                    gsource   lda #<tsource
  238 T:30f9  a0 56                              ldy #>tsource
  238 T:30fb  20 8f 38                           jsr textout
  238 T:30fe  20 9f a0                 pllo7     jsr bgkey
  238 T:3101  f0 fb                              beq pllo7
  239 T:3103  c9 03                              cmp #keystp
  239 T:3105  60                                 rts 
  240 T:3106  a9 09                    gtarget   lda #<ttarget
  240 T:3108  a0 57                              ldy #>ttarget
  240 T:310a  20 8f 38                           jsr textout
  240 T:310d  20 9f a0                 pllo6     jsr bgkey
  240 T:3110  f0 fb                              beq pllo6
  241 T:3112  c9 03                              cmp #keystp
  241 T:3114  60                                 rts 
  242 T:3115  a9 49                    gsoutar   lda #<tsoutar
  242 T:3117  a0 57                              ldy #>tsoutar
  242 T:3119  20 8f 38                           jsr textout
  242 T:311c  20 9f a0                 ptttt     jsr bgkey
  242 T:311f  f0 fb                              beq ptttt
  243 T:3121  c9 03                              cmp #keystp
  243 T:3123  60                                 rts 
  244 T:3124                                    ;**********
  245 T:3124                           pload                      ;
  246 T:3124  85 18                              sta zei
  246 T:3126  84 19                              sty zei+1
  246 T:3128  a2 00                              ldx #0
  247 T:312a  a0 ff                              ldy #<-1
  247 T:312c  c8                       plc1      iny 
  247 T:312d  b1 18                              lda (zei),y
  247 T:312f  f0 15                              beq plce
  247 T:3131  c9 20                              cmp #" "
  247 T:3133  f0 f7                              beq plc1
  248 T:3135  b1 18                    plc2      lda (zei),y
  249 T:3137  c9 20                              cmp #" "
  249 T:3139  f0 0b                              beq plc3a
  249 T:313b  9d 00 01                           sta dbuf,x
  249 T:313e  c9 00                              cmp #0
  249 T:3140  f0 04                              beq plce
  250 T:3142  c8                                 iny 
  250 T:3143  e8                                 inx 
  250 T:3144  d0 ef                              bne plc2
  251 T:3146  a9 00                    plc3a plce lda #0
  251 T:3148  9d 00 01                           sta dbuf,x
  251 T:314b  8e 53 40                           stx st1
  252 T:314e  88                                 dey 
  252 T:314f  c8                       plc4      iny 
  252 T:3150  b1 18                              lda (zei),y
  252 T:3152  c9 20                              cmp #" "
  252 T:3154  f0 f9                              beq plc4
  253 T:3156  98                                 tya 
  253 T:3157  18                                 clc 
  253 T:3158  65 18                              adc zei
  253 T:315a  8d 57 40                           sta nadr
  253 T:315d  a5 19                              lda zei+1
  253 T:315f  69 00                              adc #0
  253 T:3161  8d 58 40                           sta nadr+1
  254 T:3164  a0 00                              ldy #0
  254 T:3166  b9 00 01                 ptl1      lda dbuf,y
  254 T:3169  c8                                 iny 
  254 T:316a  c9 20                              cmp #" "
  254 T:316c  f0 f8                              beq ptl1
  255 T:316e  29 0f                              and #$0f
  255 T:3170  8d 55 40                           sta dr1
  255 T:3173  b9 00 01                           lda dbuf,y
  255 T:3176  c9 3a                              cmp #":"
  255 T:3178  f0 05                              beq ptl2
  256 T:317a  a9 00                              lda #0
  256 T:317c  8d 55 40                           sta dr1
  257 T:317f  a0 00                    ptl2      ldy #0
  257 T:3181  b9 00 02                 ptl3      lda buf,y
  257 T:3184  c8                                 iny 
  257 T:3185  c9 20                              cmp #" "
  257 T:3187  f0 f8                              beq ptl3
  258 T:3189  38                                 sec 
  258 T:318a  e9 41                              sbc #"A"
  258 T:318c  8d 56 40                           sta dr2
  258 T:318f  b9 00 02                           lda buf,y
  258 T:3192  c9 3a                              cmp #":"
  258 T:3194  f0 07                              beq ptl4
  259 T:3196  18                                 clc 
  259 T:3197  20 1b a0                           jsr sgdrive
  260 T:319a  8d 56 40                           sta dr2
  261 T:319d  ad 53 40                 ptl4      lda st1
  261 T:31a0  a2 00                              ldx #<dbuf
  261 T:31a2  a0 01                              ldy #>dbuf
  261 T:31a4  20 bd ff                           jsr setfnpar
  262 T:31a7  ae 33 40                           ldx iecunit
  262 T:31aa  a9 01                              lda #1
  262 T:31ac  a0 00                              ldy #0
  262 T:31ae  20 ba ff                           jsr setfpar
  263 T:31b1  20 fe 32                           jsr drvtest
  263 T:31b4  b0 7c                              bcs pll1
  264 T:31b6                                    ;****
  265 T:31b6  20 15 31                 pll1y     jsr gsoutar
  265 T:31b9  d0 03                              bne pll1a
  265 T:31bb  a9 ea                              lda #enbreak
  265 T:31bd  60                                 rts 
  266 T:31be  20 c0 ff                 pll1a     jsr open
  266 T:31c1  90 04                              bcc plo3
  266 T:31c3  a9 ff                              lda #ennotimp
  266 T:31c5  d0 63                              bne plerr2
  267 T:31c7  ad 57 40                 plo3      lda nadr
  267 T:31ca  ac 58 40                           ldy nadr+1
  267 T:31cd  a2 20                              ldx #$20
  267 T:31cf  20 3f a0                           jsr dcreate
  268 T:31d2  d0 56                              bne plerr2
  268 T:31d4  ad 57 40                           lda nadr
  268 T:31d7  ac 58 40                           ldy nadr+1
  268 T:31da  20 28 2c                           jsr rwopen
  268 T:31dd  d0 4b                              bne plerr2
  269 T:31df  20 b0 32                 plloop    jsr plinput
  269 T:31e2  8d 53 40                           sta st1
  270 T:31e5  8e 5b 40                           stx tplen
  270 T:31e8  8c 5c 40                           sty tplen+1
  271 T:31eb  ad 31 40                           lda fadr
  271 T:31ee  85 18                              sta zei
  271 T:31f0  ad 32 40                           lda fadr+1
  271 T:31f3  85 19                              sta zei+1
  272 T:31f5  a0 39                              ldy #fpanz
  272 T:31f7  ad 5b 40                           lda tplen
  272 T:31fa  91 18                              sta (zei),y
  272 T:31fc  c8                                 iny 
  272 T:31fd  ad 5c 40                           lda tplen+1
  272 T:3200  91 18                              sta (zei),y
  273 T:3202  a0 3b                              ldy #fpadr
  273 T:3204  a9 00                              lda #<buffer
  273 T:3206  91 18                              sta (zei),y
  273 T:3208  c8                                 iny 
  273 T:3209  a9 6c                              lda #>buffer
  273 T:320b  91 18                              sta (zei),y
  274 T:320d  a0 44                              ldy #fpbank
  274 T:320f  a9 0e                              lda #prgbank
  274 T:3211  91 18                              sta (zei),y
  275 T:3213  ae 51 40                           ldx handle
  275 T:3216  20 51 a0                           jsr dwrite
  275 T:3219  d0 0f                              bne plerr2
  276 T:321b  ad 53 40                           lda st1
  276 T:321e  f0 bf                              beq plloop
  276 T:3220  a9 00                              lda #0
  277 T:3222  48                       plerr1    pha 
  277 T:3223  ae 51 40                           ldx handle
  277 T:3226  20 4b a0                           jsr dclose
  277 T:3229  68                                 pla 
  278 T:322a  48                       plerr2    pha 
  278 T:322b  a9 01                              lda #1
  278 T:322d  20 c3 ff                           jsr close
  278 T:3230  68                                 pla 
  278 T:3231  60                       plerr1a   rts 
  279 T:3232                                    ;****
  280 T:3232  20 f7 30                 pll1      jsr gsource
  281 T:3235  f0 20                              beq pllo4c
  282 T:3237  20 c0 ff                           jsr open
  282 T:323a  90 04                              bcc pllo3
  282 T:323c  a9 ff                              lda #ennotimp
  282 T:323e  d0 22                              bne plloerr
  283 T:3240  20 b0 32                 pllo3     jsr plinput
  283 T:3243  8d 53 40                           sta st1
  283 T:3246  29 bf                              and #255-64
  283 T:3248  d0 10                              bne pllo4b
  284 T:324a  ad 53 40                           lda st1
  284 T:324d  29 40                              and #64
  284 T:324f  d0 03                              bne pllo4a
  285 T:3251  a9 fb                    pllo4     lda #enprange
  285 T:3253  2c                                 .byt $2c
  286 T:3254  a9 00                    pllo4a    lda #enok
  286 T:3256  2c                                 .byt $2c
  287 T:3257  a9 ea                    pllo4c    lda #enbreak
  287 T:3259  2c                                 .byt $2c
  288 T:325a  a9 f0                    pllo4b    lda #endnrdy
  289 T:325c  8e 5b 40                           stx tplen
  289 T:325f  8c 5c 40                           sty tplen+1
  290 T:3262  48                       plloerr   pha 
  290 T:3263  a9 01                              lda #1
  290 T:3265  20 c3 ff                           jsr close
  290 T:3268  68                                 pla 
  290 T:3269  f0 01                              beq pllo5
  290 T:326b  60                                 rts 
  291 T:326c  20 06 31                 pllo5     jsr gtarget
  292 T:326f  f0 e6                              beq pllo4c
  293 T:3271  ad 57 40                           lda nadr
  293 T:3274  ac 58 40                           ldy nadr+1
  293 T:3277  a2 20                              ldx #$20
  293 T:3279  20 3f a0                           jsr dcreate
  294 T:327c  d0 b3                              bne plerr1a
  294 T:327e  ad 57 40                           lda nadr
  294 T:3281  ac 58 40                           ldy nadr+1
  294 T:3284  20 28 2c                           jsr rwopen
  294 T:3287  d0 99                              bne plerr1
  295 T:3289  a0 39                              ldy #fpanz
  295 T:328b  ad 5b 40                           lda tplen
  295 T:328e  91 18                              sta (zei),y
  295 T:3290  c8                                 iny 
  295 T:3291  ad 5c 40                           lda tplen+1
  295 T:3294  91 18                              sta (zei),y
  296 T:3296  a0 3b                              ldy #fpadr
  296 T:3298  a9 00                              lda #<buffer
  296 T:329a  91 18                              sta (zei),y
  296 T:329c  c8                                 iny 
  296 T:329d  a9 6c                              lda #>buffer
  296 T:329f  91 18                              sta (zei),y
  297 T:32a1  a0 44                              ldy #fpbank
  297 T:32a3  a9 0e                              lda #prgbank
  297 T:32a5  91 18                              sta (zei),y
  298 T:32a7  ae 51 40                           ldx handle
  298 T:32aa  20 51 a0                           jsr dwrite
  298 T:32ad  4c 22 32                           jmp plerr1
  299 T:32b0                                    ;****
  300 T:32b0  a9 00                    plinput   lda #0
  300 T:32b2  8d 5b 40                           sta tplen
  300 T:32b5  8d 5c 40                           sta tplen+1
  301 T:32b8  85 90                              sta status
  301 T:32ba  a2 01                              ldx #1
  301 T:32bc  20 c6 ff                           jsr chkin
  302 T:32bf  a9 00                              lda #<buffer
  302 T:32c1  85 18                              sta zei
  302 T:32c3  a9 6c                              lda #>buffer
  302 T:32c5  85 19                              sta zei+1
  303 T:32c7  20 cf ff                 pliloop   jsr basin
  303 T:32ca  a0 00                              ldy #0
  303 T:32cc  91 18                              sta (zei),y
  304 T:32ce  e6 18                              inc zei
  304 T:32d0  d0 02                              bne pli1
  304 T:32d2  e6 19                              inc zei+1
  305 T:32d4  ee 5b 40                 pli1      inc tplen
  305 T:32d7  d0 03                              bne pli2
  305 T:32d9  ee 5c 40                           inc tplen+1
  306 T:32dc  a5 90                    pli2      lda status
  306 T:32de  d0 12                              bne plie
  307 T:32e0  ad 5b 40                           lda tplen
  307 T:32e3  cd 00 40                           cmp prblen
  307 T:32e6  d0 df                              bne pliloop
  307 T:32e8  ad 5c 40                           lda tplen+1
  307 T:32eb  cd 01 40                           cmp prblen+1
  307 T:32ee  d0 d7                              bne pliloop
  308 T:32f0  a9 00                              lda #0
  308 T:32f2  48                       plie      pha 
  308 T:32f3  20 cc ff                           jsr clrch
  308 T:32f6  ae 5b 40                           ldx tplen
  308 T:32f9  ac 5c 40                           ldy tplen+1
  308 T:32fc  68                                 pla 
  308 T:32fd  60                                 rts 
  309 T:32fe                                    ;**********
  310 T:32fe  ad 56 40                 drvtest   lda dr2
  310 T:3301  a2 00                              ldx #0
  310 T:3303  dd 39 40                           cmp dosd0,x
  310 T:3306  f0 06                              beq drt1
  311 T:3308  e8                                 inx 
  311 T:3309  dd 39 40                           cmp dosd0,x
  311 T:330c  d0 12                              bne drte
  312 T:330e  ad 33 40                 drt1      lda iecunit
  312 T:3311  dd 3b 40                           cmp iecd0,x
  312 T:3314  d0 0a                              bne drte
  313 T:3316  ad 55 40                           lda dr1
  313 T:3319  dd 3d 40                           cmp drvd0,x
  313 T:331c  d0 02                              bne drte
  314 T:331e  38                                 sec 
  314 T:331f  60                                 rts 
  314 T:3320  18                       drte      clc 
  314 T:3321  60                                 rts 
  315 T:3322                                    ;**********
  316 T:3322  8d 31 40                 copycon   sta fadr
  316 T:3325  8c 32 40                           sty fadr+1
  317 T:3328  a2 20                              ldx #$20
  317 T:332a  20 3f a0                           jsr dcreate
  317 T:332d  d0 6d                              bne cpcend
  318 T:332f  ad 31 40                           lda fadr
  318 T:3332  ac 32 40                           ldy fadr+1
  319 T:3335  20 28 2c                           jsr rwopen
  319 T:3338  d0 62                              bne cpcend
  320 T:333a  20 a4 28                 cpcl      jsr linein
  321 T:333d  85 18                              sta zei
  321 T:333f  84 19                              sty zei+1
  322 T:3341  a0 00                              ldy #0
  322 T:3343  b1 18                    cpca      lda (zei),y
  322 T:3345  99 00 02                           sta buf,y
  322 T:3348  f0 03                              beq cpcb
  322 T:334a  c8                                 iny 
  322 T:334b  d0 f6                              bne cpca
  323 T:334d  ad 31 40                 cpcb      lda fadr
  323 T:3350  85 18                              sta zei
  323 T:3352  ad 32 40                           lda fadr+1
  323 T:3355  85 19                              sta zei+1
  324 T:3357  a0 ff                              ldy #<-1
  324 T:3359  c8                       cpc0      iny 
  324 T:335a  b9 00 02                           lda buf,y
  324 T:335d  f0 35                              beq cpcen
  324 T:335f  c9 20                              cmp #" "
  324 T:3361  f0 f6                              beq cpc0
  325 T:3363  c8                       cpc1      iny 
  325 T:3364  b9 00 02                           lda buf,y
  325 T:3367  c9 00                              cmp #0
  325 T:3369  d0 f8                              bne cpc1
  326 T:336b  a9 0d                              lda #13
  326 T:336d  99 00 02                           sta buf,y
  326 T:3370  c8                                 iny 
  326 T:3371  98                                 tya 
  326 T:3372  a0 39                              ldy #fpanz
  327 T:3374  91 18                              sta (zei),y
  327 T:3376  c8                                 iny 
  327 T:3377  a9 00                              lda #0
  327 T:3379  91 18                              sta (zei),y
  328 T:337b  a9 00                              lda #<buf
  328 T:337d  a0 3b                              ldy #fpadr
  329 T:337f  91 18                              sta (zei),y
  329 T:3381  c8                                 iny 
  329 T:3382  a9 02                              lda #>buf
  329 T:3384  91 18                              sta (zei),y
  330 T:3386  a0 44                              ldy #fpbank
  330 T:3388  a9 0e                              lda #prgbank
  330 T:338a  91 18                              sta (zei),y
  331 T:338c  ae 51 40                           ldx handle
  331 T:338f  20 51 a0                           jsr dwrite
  331 T:3392  f0 a6                              beq cpcl
  332 T:3394  48                       cpcen     pha 
  332 T:3395  ae 51 40                           ldx handle
  332 T:3398  20 4b a0                           jsr dclose
  333 T:339b  68                                 pla 
  333 T:339c  60                       cpcend    rts 

  335 T:339d                                     .end 

PRA 2.4 .S50

    1 T:339d                                     .include "PR3 2.4 .S26"

PR3 2.4 .S26


    3 T:339d                                    ;PR3 2.4 .S26 ==0801==

    6 T:339d  20 2b 29                 pu        jsr gbyt
    6 T:33a0  d0 0e                              bne pue
    6 T:33a2  8a                                 txa 
    6 T:33a3  c9 10                              cmp #16
    6 T:33a5  90 02                              bcc pu1
    6 T:33a7  e9 06                              sbc #6
    7 T:33a9  29 0f                    pu1       and #15
    7 T:33ab  8d 33 40                           sta iecunit
    7 T:33ae  a9 00                              lda #0
    7 T:33b0  60                       pue       rts 
    8 T:33b1  20 35 29                 pq        jsr gdrv
    8 T:33b4  d0 1f                              bne perr
    8 T:33b6  8a                                 txa 
    8 T:33b7  20 06 a0                           jsr query
    9 T:33ba  48                                 pha 
    9 T:33bb  86 18                              stx zei
    9 T:33bd  84 19                              sty zei+1
   10 T:33bf  20 55 2a                           jsr crout
   11 T:33c2  a0 00                              ldy #0
   11 T:33c4  b1 18                    pq1       lda (zei),y
   11 T:33c6  20 a5 38                           jsr hexout
   11 T:33c9  20 53 29                           jsr spout
   11 T:33cc  c8                                 iny 
   11 T:33cd  c0 06                              cpy #6
   11 T:33cf  d0 f3                              bne pq1
   12 T:33d1  20 55 2a                           jsr crout
   12 T:33d4  68                                 pla 
   12 T:33d5  60                       perr      rts 
   13 T:33d6  20 35 29                 pc        jsr gdrv
   13 T:33d9  d0 fa                              bne perr
   13 T:33db  8a                                 txa 
   13 T:33dc  4c 09 a0                           jmp mediach
   14 T:33df  20 35 29                 pb        jsr gdrv
   14 T:33e2  d0 f1                              bne perr
   14 T:33e4  8a                                 txa 
   14 T:33e5  20 0c a0                           jsr getbpb
   15 T:33e8  48                                 pha 
   15 T:33e9  86 18                              stx zei
   15 T:33eb  84 19                              sty zei+1
   16 T:33ed  a0 00                              ldy #0
   16 T:33ef  b1 18                    pb1       lda (zei),y
   16 T:33f1  99 00 6c                           sta buffer,y
   16 T:33f4  c8                                 iny 
   16 T:33f5  c0 64                              cpy #bpplen
   16 T:33f7  d0 f6                              bne pb1
   17 T:33f9  68                                 pla 
   17 T:33fa  60                       prwea     rts 
   18 T:33fb  a9 00                    pr        lda #0
   18 T:33fd  2c                                 .byt $2c
   19 T:33fe  a9 01                    pw        lda #1
   20 T:3400  8d 63 40                           sta pblock+pbrwflag
   21 T:3403  20 35 29                           jsr gdrv
   21 T:3406  f0 11                              beq prw1
   21 T:3408  c9 f1                              cmp #enilldrv
   21 T:340a  d0 ee                              bne prwea
   22 T:340c  8e 65 40                           stx pblock+pbside
   23 T:340f  18                                 clc 
   23 T:3410  20 1b a0                           jsr sgdrive
   23 T:3413  8d 64 40                           sta pblock+pbdrive
   23 T:3416  4c 24 34                           jmp prw2
   24 T:3419  8e 64 40                 prw1      stx pblock+pbdrive
   24 T:341c  20 2b 29                           jsr gbyt
   24 T:341f  d0 d9                              bne prwea
   24 T:3421  8e 65 40                           stx pblock+pbside
   25 T:3424  20 2b 29                 prw2      jsr gbyt
   25 T:3427  d0 d1                              bne prwea
   25 T:3429  8e 66 40                           stx pblock+pbtrack
   26 T:342c  20 2b 29                           jsr gbyt
   26 T:342f  d0 c9                              bne prwea
   26 T:3431  b0 c7                              bcs prwea
   26 T:3433  8e 67 40                           stx pblock+pbsector
   27 T:3436  a9 00                              lda #<buffer
   27 T:3438  8d 68 40                           sta pblock+pbbuffer
   28 T:343b  a9 6c                              lda #>buffer
   28 T:343d  8d 69 40                           sta pblock+pbbuffer+1
   29 T:3440  a9 0e                              lda #prgbank
   29 T:3442  8d 6a 40                           sta pblock+pbbank
   30 T:3445  a9 63                              lda #<pblock
   30 T:3447  a0 40                              ldy #>pblock
   30 T:3449  4c 0f a0                           jmp floprw
   31 T:344c  a9 00                    pra       lda #0
   31 T:344e  2c                                 .byt $2c
   32 T:344f  a9 01                    pwa       lda #1
   33 T:3451  8d 63 40                           sta pblock+aprwflag
   34 T:3454  20 eb 28                           jsr gadr
   34 T:3457  f0 01                              beq prwa1
   34 T:3459  60                                 rts 
   35 T:345a  8e 65 40                 prwa1     stx pblock+aprecord
   35 T:345d  8c 66 40                           sty pblock+aprecord+1
   36 T:3460  18                                 clc 
   36 T:3461  20 1b a0                           jsr sgdrive
   36 T:3464  8d 64 40                           sta pblock+apdrive
   37 T:3467  a0 00                              ldy #0
   37 T:3469  8c 68 40                           sty pblock+apanz+1
   37 T:346c  c8                                 iny 
   37 T:346d  8c 67 40                           sty pblock+apanz
   38 T:3470  a9 00                              lda #<buffer
   38 T:3472  8d 69 40                           sta pblock+apbuffer
   39 T:3475  a9 6c                              lda #>buffer
   39 T:3477  8d 6a 40                           sta pblock+apbuffer+1
   40 T:347a  a9 0e                              lda #prgbank
   40 T:347c  8d 6b 40                           sta pblock+apbank
   41 T:347f  a9 63                              lda #<pblock
   41 T:3481  a0 40                              ldy #>pblock
   41 T:3483  4c 12 a0                           jmp rwabs
   42 T:3486  20 eb 28                 pm        jsr gadr
   42 T:3489  8e 59 40                           stx fad2
   42 T:348c  8c 5a 40                           sty fad2+1
   43 T:348f  8a                                 txa 
   43 T:3490  18                                 clc 
   43 T:3491  69 00                              adc #<buffer
   43 T:3493  85 18                              sta zei
   44 T:3495  98                                 tya 
   44 T:3496  69 6c                              adc #>buffer
   44 T:3498  85 19                              sta zei+1
   45 T:349a  20 eb 28                           jsr gadr
   45 T:349d  b0 7c                              bcs pme
   45 T:349f                                    
   46 T:349f  8a                                 txa 
   46 T:34a0  18                                 clc 
   46 T:34a1  69 00                              adc #<buffer
   46 T:34a3  8d 31 40                           sta fadr
   47 T:34a6  98                                 tya 
   47 T:34a7  69 6c                              adc #>buffer
   47 T:34a9  8d 32 40                           sta fadr+1
   48 T:34ac  20 32 3a                           jsr prttst
   48 T:34af  a9 3e                    pmout     lda #">"
   48 T:34b1  20 b1 a0                           jsr chout
   48 T:34b4  a9 3b                              lda #";"
   48 T:34b6  20 b1 a0                           jsr chout
   49 T:34b9  ad 5a 40                           lda fad2+1
   49 T:34bc  20 a5 38                           jsr hexout
   49 T:34bf  ad 59 40                           lda fad2
   49 T:34c2  20 a5 38                           jsr hexout
   49 T:34c5  20 53 29                           jsr spout
   50 T:34c8  a0 00                              ldy #0
   50 T:34ca  b1 18                    pm1       lda (zei),y
   50 T:34cc  20 a5 38                           jsr hexout
   51 T:34cf  20 53 29                           jsr spout
   51 T:34d2  c8                                 iny 
   51 T:34d3  c0 08                              cpy #8
   51 T:34d5  90 f3                              bcc pm1
   52 T:34d7  a0 00                              ldy #0
   52 T:34d9  b1 18                    pm2       lda (zei),y
   52 T:34db  aa                                 tax 
   53 T:34dc  29 7f                              and #127
   53 T:34de  c9 20                              cmp #32
   53 T:34e0  b0 02                              bcs pm3
   53 T:34e2  a2 2e                              ldx #"."
   54 T:34e4  8a                       pm3       txa 
   54 T:34e5  20 b1 a0                           jsr chout
   55 T:34e8  c8                                 iny 
   55 T:34e9  c0 08                              cpy #8
   55 T:34eb  90 ec                              bcc pm2
   56 T:34ed  20 55 2a                           jsr crout
   57 T:34f0  a9 08                              lda #8
   57 T:34f2  18                                 clc 
   57 T:34f3  6d 59 40                           adc fad2
   57 T:34f6  8d 59 40                           sta fad2
   57 T:34f9  90 03                              bcc pm4
   57 T:34fb  ee 5a 40                           inc fad2+1
   58 T:34fe  a9 08                    pm4       lda #8
   58 T:3500  18                                 clc 
   58 T:3501  65 18                              adc zei
   58 T:3503  85 18                              sta zei
   58 T:3505  90 02                              bcc pm5
   58 T:3507  e6 19                              inc zei+1
   59 T:3509  a5 19                    pm5       lda zei+1
   59 T:350b  cd 32 40                           cmp fadr+1
   59 T:350e  90 9f                              bcc pmout
   60 T:3510  d0 07                              bne pmend
   60 T:3512  a5 18                              lda zei
   60 T:3514  cd 31 40                           cmp fadr
   60 T:3517  90 96                              bcc pmout
   61 T:3519  a9 00                    pmend     lda #0
   61 T:351b  48                       pme       pha 
   61 T:351c  20 49 3a                           jsr prtoff
   61 T:351f  68                                 pla 
   61 T:3520  60                                 rts 
   62 T:3521  20 eb 28                 pg        jsr gadr
   62 T:3524  d0 23                              bne pge
   63 T:3526  8a                                 txa 
   63 T:3527  18                                 clc 
   63 T:3528  69 00                              adc #<buffer
   63 T:352a  85 18                              sta zei
   64 T:352c  98                                 tya 
   64 T:352d  69 6c                              adc #>buffer
   64 T:352f  85 19                              sta zei+1
   65 T:3531  a9 00                              lda #0
   65 T:3533  8d 59 40                           sta fad2
   66 T:3536  20 2b 29                 pg1       jsr gbyt
   66 T:3539  d0 0e                              bne pge
   67 T:353b  8a                                 txa 
   67 T:353c  ac 59 40                           ldy fad2
   67 T:353f  91 18                              sta (zei),y
   68 T:3541  c8                                 iny 
   68 T:3542  8c 59 40                           sty fad2
   68 T:3545  c0 08                              cpy #8
   68 T:3547  d0 ed                              bne pg1
   69 T:3549  a9 00                    pge       lda #0
   69 T:354b  60                                 rts 
   70 T:354c  20 2b 29                 pcol      jsr gbyt
   70 T:354f  8e 70 40                           stx clibcol
   70 T:3552  20 2b 29                           jsr gbyt
   70 T:3555  b0 03                              bcs pcol1
   70 T:3557  8e 6f 40                           stx clitcol
   71 T:355a  ad 70 40                 pcol1     lda clibcol
   71 T:355d  20 ca 51                           jsr setbck
   71 T:3560  ad 6f 40                           lda clitcol
   71 T:3563  20 cd 51                           jsr settxt
   72 T:3566  a9 00                              lda #0
   72 T:3568  60                                 rts 
   73 T:3569  20 99 28                 gdati     jsr chrgot
   73 T:356c  d0 02                              bne pda1
   74 T:356e  18                                 clc 
   74 T:356f  60                                 rts 
   75 T:3570  a9 ff                    pda1      lda #$ff
   75 T:3572  18                                 clc 
   75 T:3573  65 30                              adc czei
   75 T:3575  85 30                              sta czei
   76 T:3577  a9 ff                              lda #$ff
   76 T:3579  65 31                              adc czei+1
   76 T:357b  85 31                              sta czei+1
   77 T:357d  a9 00                              lda #0
   77 T:357f  8d 5f 40                           sta laenge
   77 T:3582  8d 60 40                           sta laenge+1
   77 T:3585  8d 61 40                           sta laenge+2
   78 T:3588  20 db 35                           jsr dezbyt
   78 T:358b  8d 5f 40                           sta laenge
   78 T:358e  b0 1a                              bcs pda2
   79 T:3590  20 99 28                           jsr chrgot
   79 T:3593  f0 15                              beq pda2
   80 T:3595  20 db 35                           jsr dezbyt
   80 T:3598  8d 60 40                           sta laenge+1
   80 T:359b  b0 0d                              bcs pda2
   81 T:359d  20 99 28                           jsr chrgot
   81 T:35a0  f0 08                              beq pda2
   82 T:35a2  20 db 35                           jsr dezbyt
   82 T:35a5  8d 61 40                           sta laenge+2
   82 T:35a8  b0 00                              bcs pda2
   83 T:35aa  38                       pda2      sec 
   83 T:35ab  a2 5f                              ldx #<laenge
   83 T:35ad  a0 40                              ldy #>laenge
   83 T:35af  60                                 rts 
   84 T:35b0  20 69 35                 ptime     jsr gdati
   84 T:35b3  90 23                              bcc ptime1
   85 T:35b5  ad 5f 40                           lda laenge
   85 T:35b8  48                                 pha 
   85 T:35b9  ad 61 40                           lda laenge+2
   85 T:35bc  8d 5f 40                           sta laenge
   85 T:35bf  68                                 pla 
   85 T:35c0  8d 61 40                           sta laenge+2
   86 T:35c3  4c 63 a0                           jmp sgtime
   87 T:35c6  20 69 35                 pdate     jsr gdati
   87 T:35c9  90 0d                              bcc ptime1
   88 T:35cb  ad 61 40                           lda laenge+2
   88 T:35ce  38                                 sec 
   88 T:35cf  e9 50                              sbc #80
   88 T:35d1  8d 61 40                           sta laenge+2
   88 T:35d4  38                                 sec 
   89 T:35d5  4c 66 a0                           jmp sgdate
   90 T:35d8  a9 00                    ptime1    lda #0
   90 T:35da  60                                 rts 
   91 T:35db  a9 00                    dezbyt    lda #0
   91 T:35dd  8d 31 40                           sta fadr
   91 T:35e0  20 1d 36                           jsr numget
   91 T:35e3  b0 20                              bcs dezbe
   91 T:35e5  8d 31 40                           sta fadr
   92 T:35e8  20 1d 36                           jsr numget
   92 T:35eb  b0 18                              bcs dezbe
   92 T:35ed  48                                 pha 
   93 T:35ee  0e 31 40                           asl fadr
   93 T:35f1  ad 31 40                           lda fadr
   93 T:35f4  0a                                 asl 
   93 T:35f5  0a                                 asl 
   93 T:35f6  18                                 clc 
   93 T:35f7  6d 31 40                           adc fadr
   93 T:35fa  8d 31 40                           sta fadr
   93 T:35fd  68                                 pla 
   93 T:35fe  18                                 clc 
   93 T:35ff  6d 31 40                           adc fadr
   93 T:3602  18                                 clc 
   94 T:3603  90 0e                              bcc dezbn
   95 T:3605  c9 00                    dezbe     cmp #0
   95 T:3607  d0 05                              bne dezbe1
   95 T:3609  ad 31 40                           lda fadr
   95 T:360c  38                                 sec 
   95 T:360d  60                                 rts 
   96 T:360e  ad 31 40                 dezbe1    lda fadr
   96 T:3611  18                                 clc 
   96 T:3612  60                                 rts 
   97 T:3613  08                       dezbn     php 
   97 T:3614  48                                 pha 
   98 T:3615  20 1d 36                 dezbm     jsr numget
   98 T:3618  90 fb                              bcc dezbm
   99 T:361a  68                                 pla 
   99 T:361b  28                                 plp 
   99 T:361c  60                                 rts 
  100 T:361d  20 93 28                 numget    jsr chrget
  100 T:3620  f0 0c                              beq numge
  101 T:3622  c9 30                              cmp #"0"
  101 T:3624  90 08                              bcc numge
  101 T:3626  c9 3a                              cmp #$3a
  101 T:3628  b0 04                              bcs numge
  102 T:362a  29 0f                              and #$0f
  102 T:362c  18                                 clc 
  102 T:362d  60                                 rts 
  103 T:362e  38                       numge     sec 
  103 T:362f  60                                 rts 
  104 T:3630  85 18                    prename   sta zei
  104 T:3632  84 19                              sty zei+1
  105 T:3634  a0 ff                              ldy #<-1
  105 T:3636  c8                       prn0      iny 
  105 T:3637  b1 18                              lda (zei),y
  105 T:3639  f0 13                              beq prne1
  105 T:363b  c9 20                              cmp #" "
  105 T:363d  f0 f7                              beq prn0
  106 T:363f  a2 00                              ldx #0
  106 T:3641  b1 18                    prn1      lda (zei),y
  106 T:3643  9d 00 01                           sta dbuf,x
  107 T:3646  f0 06                              beq prne1
  108 T:3648  c9 5c                              cmp #$5c             ;"\"
  108 T:364a  f0 02                              beq prne1
  109 T:364c  c9 3a                              cmp #":"
  109 T:364e  f0 71                    prne1     beq prne
  110 T:3650  c9 20                              cmp #" "
  110 T:3652  f0 04                              beq prn1a
  111 T:3654  c8                                 iny 
  111 T:3655  e8                                 inx 
  111 T:3656  d0 e9                              bne prn1
  112 T:3658  a9 00                    prn1a     lda #0
  112 T:365a  9d 00 01                           sta dbuf,x
  113 T:365d  98                                 tya 
  113 T:365e  18                                 clc 
  113 T:365f  65 18                              adc zei
  113 T:3661  85 18                              sta zei
  114 T:3663  90 02                              bcc mrnx
  114 T:3665  e6 19                              inc zei+1

  116 T:3667  a0 ff                    mrnx      ldy #<-1
  117 T:3669  c8                       prn2      iny 
  117 T:366a  b1 18                              lda (zei),y
  117 T:366c  f0 53                              beq prne
  118 T:366e  c9 20                              cmp #" "
  118 T:3670  f0 f7                              beq prn2
  119 T:3672  b1 18                    prn3      lda (zei),y
  119 T:3674  f0 0b                              beq prn4
  120 T:3676  c9 5c                              cmp #$5c             ;"\"
  120 T:3678  f0 47                              beq prne
  121 T:367a  c9 3a                              cmp #":"
  121 T:367c  f0 43                              beq prne
  122 T:367e  c8                                 iny 
  122 T:367f  d0 f1                              bne prn3
  123 T:3681  a5 18                    prn4      lda zei
  123 T:3683  a4 19                              ldy zei+1
  124 T:3685  a2 ff                              ldx #$ff
  124 T:3687  20 36 a0                           jsr namedtp
  124 T:368a  f0 38                              beq prne2
  125 T:368c  c9 f7                              cmp #ennotfnd
  125 T:368e  d0 36                              bne prnex
  126 T:3690  18                                 clc 
  126 T:3691  20 18 a0                           jsr sgdta
  126 T:3694  85 2e                              sta rwbzei
  126 T:3696  84 2f                              sty rwbzei+1
  127 T:3698  a0 00                              ldy #dsname
  127 T:369a  b1 2e                    prnx1     lda (rwbzei),y
  127 T:369c  99 02 40                           sta ddtp,y
  127 T:369f  c8                                 iny 
  127 T:36a0  c0 0c                              cpy #dsname+12
  127 T:36a2  90 f6                              bcc prnx1
  128 T:36a4  a9 00                              lda #<dbuf
  128 T:36a6  a0 01                              ldy #>dbuf
  128 T:36a8  a2 ff                              ldx #$ff
  129 T:36aa  20 36 a0                           jsr namedtp
  129 T:36ad  d0 17                              bne prnex
  130 T:36af  a2 00                              ldx #dsname
  130 T:36b1  a0 0c                              ldy #dgname
  131 T:36b3  bd 02 40                 prnx2     lda ddtp,x
  131 T:36b6  91 2e                              sta (rwbzei),y
  132 T:36b8  e8                                 inx 
  132 T:36b9  c8                                 iny 
  132 T:36ba  c0 17                              cpy #dgname+11
  132 T:36bc  90 f5                              bcc prnx2
  133 T:36be  4c 39 a0                           jmp wrentry
  134 T:36c1  a9 f5                    prne      lda #enillnam
  134 T:36c3  2c                                 .byt $2c
  134 T:36c4  a9 f3                    prne2     lda #enfexist
  134 T:36c6  60                       prnex     rts 

  137 T:36c7  a9 40                    mrename   lda #64
  137 T:36c9  a2 06                              ldx #6
  137 T:36cb  20 d6 49                           jsr mdirpin
  138 T:36ce  f0 01                              beq mrn1
  138 T:36d0  60                       mrnr      rts 
  138 T:36d1                           mrn1      
  139 T:36d1  ad 87 40                           lda lanz
  139 T:36d4  f0 fa                              beq mrnr
  140 T:36d6  20 b7 4d                           jsr lzeibuf
  140 T:36d9  85 18                              sta zei
  140 T:36db  84 19                              sty zei+1
  141 T:36dd  a0 00                              ldy #0
  142 T:36df  b1 18                    mrn2      lda (zei),y
  142 T:36e1  99 00 01                           sta dbuf,y
  143 T:36e4  f0 03                              beq mrn3
  143 T:36e6  c8                                 iny 
  143 T:36e7  d0 f6                              bne mrn2
  143 T:36e9                           mrn3      
  144 T:36e9  a9 0e                              lda #14
  144 T:36eb  20 d0 48                           jsr prntcmd
  145 T:36ee  a9 a4                              lda #<isnpt
  145 T:36f0  a0 61                              ldy #>isnpt
  145 T:36f2  20 be 51                           jsr winput
  146 T:36f5  b0 d9                              bcs mrnr
  147 T:36f7  86 18                              stx zei
  147 T:36f9  84 19                              sty zei+1
  147 T:36fb  4c 67 36                           jmp mrnx

  149 T:36fe                                     .end 

PRA 2.4 .S50

    1 T:36fe                                     .include "PR4 2.4 .S22"

PR4 2.4 .S22


    3 T:36fe                                    ;PR4 2.4 .S22 ==0801==

    6 T:36fe                                    ;zei =$1c
    7 T:36fe  a2 10                    dir       ldx #$10
    7 T:3700  20 36 a0                           jsr namedtp
    7 T:3703  f0 01                              beq dirok
    8 T:3705  60                                 rts 
    9 T:3706  86 18                    dirok     stx zei
    9 T:3708  84 19                              sty zei+1
   10 T:370a  20 2a 3a                           jsr prtbtst
   10 T:370d  f0 03                              beq diroo1
   10 T:370f  4c fe 37                           jmp direx
   11 T:3712  a0 04                    diroo1    ldy #gnfile
   11 T:3714  b1 18                              lda (zei),y
   11 T:3716  8d 4c 40                           sta dcl
   12 T:3719  c8                                 iny 
   12 T:371a  b1 18                              lda (zei),y
   12 T:371c  8d 4d 40                           sta dcl+1
   13 T:371f  a5 18                              lda zei
   13 T:3721  18                                 clc 
   13 T:3722  69 06                              adc #gnpath
   13 T:3724  8d 4e 40                           sta dpa
   14 T:3727  a5 19                              lda zei+1
   14 T:3729  69 00                              adc #0
   14 T:372b  8d 4f 40                           sta dpa+1
   15 T:372e  18                                 clc 
   15 T:372f  20 18 a0                           jsr sgdta
   15 T:3732  85 18                              sta zei
   15 T:3734  84 19                              sty zei+1
   16 T:3736  a9 00                              lda #0
   16 T:3738  8d 3f 40                           sta dircount
   16 T:373b  8d 40 40                           sta dircount+1
   17 T:373e  a9 72                              lda #<dirstext
   17 T:3740  a0 55                              ldy #>dirstext
   17 T:3742  20 8f 38                           jsr textout
   18 T:3745  18                                 clc 
   18 T:3746  20 1b a0                           jsr sgdrive
   18 T:3749  18                                 clc 
   18 T:374a  69 41                              adc #"A"             ; "a"
   18 T:374c  20 b1 a0                           jsr chout
   18 T:374f  a9 3a                              lda #":"
   18 T:3751  20 b1 a0                           jsr chout
   19 T:3754  a9 89                              lda #<dirntext
   19 T:3756  a0 55                              ldy #>dirntext
   19 T:3758  20 8f 38                           jsr textout
   20 T:375b  a9 02                              lda #<ddtp
   20 T:375d  a0 40                              ldy #>ddtp
   20 T:375f  38                                 sec 
   20 T:3760  20 18 a0                           jsr sgdta
   21 T:3763  a9 2a                              lda #"*"
   21 T:3765  8d 02 40                           sta ddtp+dsname
   21 T:3768  8d 0a 40                           sta ddtp+dsext
   22 T:376b  a9 08                              lda #%00001000             ;disk-name
   22 T:376d  8d 0d 40                           sta ddtp+dsattr
   23 T:3770  ad 4c 40                           lda dcl
   23 T:3773  ae 4d 40                           ldx dcl+1
   23 T:3776  a0 00                              ldy #0
   23 T:3778  20 2d a0                           jsr sfirso
   23 T:377b  d0 03                              bne dirnonam
   24 T:377d  20 04 38                           jsr dirnout
   25 T:3780  a9 0d                    dirnonam  lda #13
   25 T:3782  20 b1 a0                           jsr chout
   26 T:3785  ad 4e 40                           lda dpa
   26 T:3788  ac 4f 40                           ldy dpa+1
   26 T:378b  85 18                              sta zei
   26 T:378d  84 19                              sty zei+1
   27 T:378f  a0 00                              ldy #0
   27 T:3791  b1 18                    dirnn2    lda (zei),y
   27 T:3793  f0 06                              beq dirnn1
   28 T:3795  20 b1 a0                           jsr chout
   28 T:3798  c8                                 iny 
   28 T:3799  d0 f6                              bne dirnn2
   29 T:379b  a9 f7                    dirnn1    lda #%11110111
   29 T:379d  8d 0d 40                           sta ddtp+dsattr
   30 T:37a0  ad 4c 40                           lda dcl
   30 T:37a3  ae 4d 40                           ldx dcl+1
   30 T:37a6  a0 00                              ldy #0
   30 T:37a8  20 2d a0                           jsr sfirso
   30 T:37ab  4c b1 37                           jmp pnexte
   31 T:37ae  20 30 a0                 pnext     jsr snext
   32 T:37b1  d0 14                    pnexte    bne dirend
   33 T:37b3  ee 3f 40                           inc dircount
   33 T:37b6  d0 03                              bne dira1
   33 T:37b8  ee 40 40                           inc dircount+1
   34 T:37bb  20 55 2a                 dira1     jsr crout
   35 T:37be  20 04 38                           jsr dirnout
   35 T:37c1  20 22 38                           jsr dirpout
   35 T:37c4  4c ae 37                           jmp pnext
   36 T:37c7  c9 f7                    dirend    cmp #ennotfnd
   36 T:37c9  d0 33                              bne direx
   37 T:37cb  20 55 2a                 dirend1   jsr crout
   38 T:37ce  ad 40 40                           lda dircount+1
   38 T:37d1  20 a5 38                           jsr hexout
   38 T:37d4  ad 3f 40                           lda dircount
   38 T:37d7  20 a5 38                           jsr hexout
   39 T:37da  a9 9e                              lda #<dirftext
   39 T:37dc  a0 55                              ldy #>dirftext
   39 T:37de  20 8f 38                           jsr textout
   40 T:37e1  a9 48                              lda #<dword
   40 T:37e3  a0 40                              ldy #>dword
   40 T:37e5  20 27 a0                           jsr gtdskfr                ;anzahl freie bytes auf diskette
   41 T:37e8  d0 14                              bne direx
   41 T:37ea  a0 03                              ldy #3
   42 T:37ec  b9 48 40                 ddfspo    lda dword,y
   42 T:37ef  20 a5 38                           jsr hexout
   42 T:37f2  88                                 dey 
   42 T:37f3  10 f7                              bpl ddfspo
   43 T:37f5  a9 b9                              lda #<dirbtext
   43 T:37f7  a0 55                              ldy #>dirbtext
   43 T:37f9  20 8f 38                           jsr textout
   44 T:37fc  a9 00                              lda #0
   44 T:37fe  48                       direx     pha 
   44 T:37ff  20 49 3a                           jsr prtoff
   44 T:3802  68                                 pla 
   44 T:3803  60                                 rts 
   45 T:3804  a0 00                    dirnout   ldy #0
   45 T:3806  b9 0e 40                 dir1      lda ddtp+dgname,y
   45 T:3809  20 b1 a0                           jsr chout
   46 T:380c  c8                                 iny 
   46 T:380d  c0 08                              cpy #8
   46 T:380f  d0 f5                              bne dir1
   47 T:3811  20 53 29                           jsr spout
   48 T:3814  a0 00                              ldy #0
   48 T:3816  b9 16 40                 dir2      lda ddtp+dgext,y
   48 T:3819  20 b1 a0                           jsr chout
   49 T:381c  c8                                 iny 
   49 T:381d  c0 03                              cpy #3
   49 T:381f  d0 f5                              bne dir2
   49 T:3821  60                                 rts 
   50 T:3822  ad 19 40                 dirpout   lda ddtp+dgattr
   50 T:3825  29 10                              and #%00010000
   50 T:3827  f0 0a                              beq dirsize
   51 T:3829  a0 55                              ldy #>dirdtext
   51 T:382b  a9 68                              lda #<dirdtext
   51 T:382d  20 8f 38                           jsr textout
   51 T:3830  4c 4e 38                           jmp dirdate
   52 T:3833  20 53 29                 dirsize   jsr spout
   53 T:3836  ad 1f 40                           lda ddtp+dgsize+3
   53 T:3839  20 a5 38                           jsr hexout
   54 T:383c  ad 1e 40                           lda ddtp+dgsize+2
   54 T:383f  20 a5 38                           jsr hexout
   55 T:3842  ad 1d 40                           lda ddtp+dgsize+1
   55 T:3845  20 a5 38                           jsr hexout
   56 T:3848  ad 1c 40                           lda ddtp+dgsize+0
   56 T:384b  20 a5 38                           jsr hexout
   57 T:384e  20 53 29                 dirdate   jsr spout
   58 T:3851  ad 22 40                           lda ddtp+dghour
   58 T:3854  20 bc 38                           jsr dezbout
   59 T:3857  a9 3a                              lda #":"
   59 T:3859  20 b1 a0                           jsr chout
   60 T:385c  ad 21 40                           lda ddtp+dgmin
   60 T:385f  20 bc 38                           jsr dezbout
   61 T:3862  a9 3a                              lda #":"
   61 T:3864  20 b1 a0                           jsr chout
   62 T:3867  ad 20 40                           lda ddtp+dgsec
   62 T:386a  20 bc 38                           jsr dezbout
   63 T:386d  20 53 29                           jsr spout
   64 T:3870  ad 23 40                           lda ddtp+dgday
   64 T:3873  20 bc 38                           jsr dezbout
   65 T:3876  a9 2e                              lda #"."
   65 T:3878  20 b1 a0                           jsr chout
   66 T:387b  ad 24 40                           lda ddtp+dgmonth
   66 T:387e  20 bc 38                           jsr dezbout
   67 T:3881  a9 2e                              lda #"."
   67 T:3883  20 b1 a0                           jsr chout
   68 T:3886  ad 25 40                           lda ddtp+dgyear
   68 T:3889  18                                 clc 
   68 T:388a  69 50                              adc #80
   68 T:388c  4c bc 38                           jmp dezbout

   70 T:388f  85 18                    textout   sta zei
   70 T:3891  84 19                              sty zei+1
   70 T:3893  a0 00                              ldy #0
   71 T:3895  b1 18                    texto1    lda (zei),y
   71 T:3897  f0 0b                              beq textor
   72 T:3899  20 b1 a0                           jsr chout
   72 T:389c  e6 18                              inc zei
   72 T:389e  d0 f5                              bne texto1
   73 T:38a0  e6 19                              inc zei+1
   73 T:38a2  d0 f1                              bne texto1
   74 T:38a4  60                       textor    rts 

   77 T:38a5  48                       hexout    pha 
   77 T:38a6  4a                                 lsr 
   77 T:38a7  4a                                 lsr 
   77 T:38a8  4a                                 lsr 
   77 T:38a9  4a                                 lsr 
   77 T:38aa  20 b0 38                           jsr binout
   78 T:38ad  68                                 pla 
   78 T:38ae  29 0f                              and #$0f
   79 T:38b0  18                       binout    clc 
   79 T:38b1  69 30                              adc #"0"
   79 T:38b3  c9 3a                              cmp #"9"+1
   79 T:38b5  90 02                              bcc bino1
   80 T:38b7  69 06                              adc #6
   80 T:38b9  4c b1 a0                 bino1     jmp chout
   81 T:38bc  8d 41 40                 dezbout   sta dint1
   81 T:38bf  a9 00                              lda #0
   81 T:38c1  8d 42 40                           sta dint1+1
   82 T:38c4  a9 0a                              lda #10
   82 T:38c6  a2 00                              ldx #0
   82 T:38c8  20 da 38                           jsr ddiv
   82 T:38cb  18                                 clc 
   82 T:38cc  69 30                              adc #"0"
   82 T:38ce  20 b1 a0                           jsr chout
   83 T:38d1  ad 41 40                           lda dint1
   83 T:38d4  18                                 clc 
   83 T:38d5  69 30                              adc #"0"
   83 T:38d7  4c b1 a0                           jmp chout
   84 T:38da                                    ;**** dint1 / a/x = a/x rest dint1
   85 T:38da  8e 44 40                 ddiv      stx dint2+1
   85 T:38dd  8d 43 40                           sta dint2
   85 T:38e0  8c 47 40                           sty dabuf
   85 T:38e3  a2 01                              ldx #1
   85 T:38e5  a9 00                              lda #0
   85 T:38e7  8d 45 40                           sta dint3
   85 T:38ea  8d 46 40                           sta dint3+1
   86 T:38ed  ad 43 40                 ddiv1     lda dint2
   86 T:38f0  0a                                 asl 
   86 T:38f1  a8                                 tay 
   86 T:38f2  ad 44 40                           lda dint2+1
   86 T:38f5  2a                                 rol 
   86 T:38f6  b0 17                              bcs ddiv3
   87 T:38f8  cd 42 40                           cmp dint1+1
   87 T:38fb  90 09                              bcc ddiv2
   87 T:38fd  d0 10                              bne ddiv3
   88 T:38ff  cc 41 40                           cpy dint1
   88 T:3902  90 02                              bcc ddiv2
   88 T:3904  d0 09                              bne ddiv3
   89 T:3906  8d 44 40                 ddiv2     sta dint2+1
   89 T:3909  8c 43 40                           sty dint2
   89 T:390c  e8                                 inx 
   89 T:390d  d0 de                              bne ddiv1
   90 T:390f  ca                       ddiv3     dex 
   90 T:3910  10 0a                              bpl ddiv6
   90 T:3912  ac 47 40                           ldy dabuf
   90 T:3915  ad 45 40                           lda dint3
   90 T:3918  ae 46 40                           ldx dint3+1
   90 T:391b  60                                 rts 
   91 T:391c  ad 42 40                 ddiv6     lda dint1+1
   91 T:391f  cd 44 40                           cmp dint2+1
   91 T:3922  90 1f                              bcc ddiv4
   91 T:3924  d0 08                              bne ddiv5
   92 T:3926  ad 41 40                           lda dint1
   92 T:3929  cd 43 40                           cmp dint2
   92 T:392c  90 15                              bcc ddiv4
   93 T:392e  ad 41 40                 ddiv5     lda dint1
   93 T:3931  38                                 sec 
   93 T:3932  ed 43 40                           sbc dint2
   93 T:3935  8d 41 40                           sta dint1
   94 T:3938  ad 42 40                           lda dint1+1
   94 T:393b  ed 44 40                           sbc dint2+1
   94 T:393e  8d 42 40                           sta dint1+1
   95 T:3941  38                                 sec 
   95 T:3942  24                                 .byt $24
   95 T:3943  18                       ddiv4     clc 
   95 T:3944  2e 45 40                           rol dint3
   95 T:3947  2e 46 40                           rol dint3+1
   96 T:394a  4e 44 40                           lsr dint2+1
   96 T:394d  6e 43 40                           ror dint2
   96 T:3950  4c 0f 39                           jmp ddiv3
   97 T:3953                                    ;****
   98 T:3953                                    ;****
   99 T:3953                           pcat                       ;
  100 T:3953  20 2a 3a                           jsr prtbtst
  100 T:3956  38                                 sec 
  100 T:3957  d0 22                              bne dce1
  100 T:3959  a9 0d                              lda #13
  100 T:395b  20 b1 a0                           jsr chout
  101 T:395e  a9 24                              lda #"$"
  101 T:3960  8d 00 02                           sta buf
  102 T:3963  a9 01                              lda #1
  102 T:3965  a2 00                              ldx #<buf
  102 T:3967  a0 02                              ldy #>buf
  102 T:3969  20 bd ff                           jsr setfnpar
  103 T:396c  ae 33 40                           ldx iecunit
  103 T:396f  a9 01                              lda #1
  103 T:3971  a0 00                              ldy #0
  103 T:3973  20 ba ff                           jsr setfpar
  104 T:3976  20 c0 ff                           jsr open
  104 T:3979  09 40                              ora #64
  104 T:397b  b0 4e                    dce1      bcs dce
  105 T:397d  a9 00                              lda #0
  105 T:397f  85 90                              sta status
  105 T:3981  a2 01                              ldx #1
  105 T:3983  20 c6 ff                           jsr chkin
  106 T:3986  09 40                              ora #64
  106 T:3988  b0 41                              bcs dce
  107 T:398a  20 cf ff                           jsr basin
  107 T:398d  20 cf ff                           jsr basin
  108 T:3990  a9 00                    dcloop    lda #0
  108 T:3992  85 90                              sta status
  108 T:3994  20 cf ff                           jsr basin
  108 T:3997  20 cf ff                           jsr basin
  109 T:399a  a5 90                              lda status
  109 T:399c  d0 2b                              bne dcok
  110 T:399e  20 cf ff                           jsr basin
  110 T:39a1  8d 41 40                           sta dint1
  110 T:39a4  20 cf ff                           jsr basin
  110 T:39a7  8d 42 40                           sta dint1+1
  111 T:39aa  20 d9 39                           jsr dezout
  112 T:39ad  20 cf ff                 dcl1      jsr basin
  112 T:39b0  20 b1 a0                           jsr chout
  112 T:39b3  c9 00                              cmp #0
  112 T:39b5  d0 f6                              bne dcl1
  113 T:39b7  20 cc ff                           jsr clrch
  113 T:39ba  20 55 2a                           jsr crout
  113 T:39bd  a2 01                              ldx #1
  113 T:39bf  20 c6 ff                           jsr chkin
  113 T:39c2  09 40                              ora #64
  113 T:39c4  b0 05                              bcs dce
  113 T:39c6  4c 90 39                           jmp dcloop
  114 T:39c9  a9 00                    dcok      lda #0
  114 T:39cb  48                       dce       pha 
  115 T:39cc  20 49 3a                           jsr prtoff
  116 T:39cf  20 cc ff                           jsr clrch
  116 T:39d2  a9 01                              lda #1
  116 T:39d4  20 c3 ff                           jsr close
  117 T:39d7  68                                 pla 
  117 T:39d8  60                                 rts 
  118 T:39d9                                    ;****
  119 T:39d9  a0 00                    dezout    ldy #0
  120 T:39db  b9 c6 55                 do1       lda dhi,y
  120 T:39de  aa                                 tax 
  120 T:39df  b9 cb 55                           lda dlo,y
  120 T:39e2  20 da 38                           jsr ddiv
  121 T:39e5  c8                                 iny 
  121 T:39e6  c9 00                              cmp #0
  121 T:39e8  d0 06                              bne do2
  121 T:39ea  c0 04                              cpy #4
  121 T:39ec  d0 ed                              bne do1
  121 T:39ee  f0 06                              beq do3
  122 T:39f0  18                       do2       clc 
  122 T:39f1  69 30                              adc #"0"
  122 T:39f3  20 b1 a0                           jsr chout
  123 T:39f6  b9 c6 55                 do3       lda dhi,y
  123 T:39f9  aa                                 tax 
  123 T:39fa  b9 cb 55                           lda dlo,y
  123 T:39fd  20 da 38                           jsr ddiv
  124 T:3a00  18                                 clc 
  124 T:3a01  69 30                              adc #"0"
  124 T:3a03  20 b1 a0                           jsr chout
  125 T:3a06  c8                                 iny 
  125 T:3a07  c0 05                              cpy #5
  125 T:3a09  90 eb                              bcc do3
  125 T:3a0b  60                                 rts 
  126 T:3a0c                                    ;********
  127 T:3a0c  ad 35 40                 pprint    lda prtfl
  127 T:3a0f  49 80                              eor #128
  127 T:3a11  8d 35 40                           sta prtfl
  127 T:3a14  10 0a                              bpl pprt1
  128 T:3a16  a9 b2                              lda #<tpon
  128 T:3a18  a0 56                              ldy #>tpon
  128 T:3a1a  20 8f 38                           jsr textout
  128 T:3a1d  a9 00                              lda #0
  128 T:3a1f  60                                 rts 
  129 T:3a20                           pprt1     
  130 T:3a20  a9 bd                              lda #<tpoff
  130 T:3a22  a0 56                              ldy #>tpoff
  130 T:3a24  20 8f 38                           jsr textout
  130 T:3a27  a9 00                              lda #0
  130 T:3a29  60                       pca1      rts 

  132 T:3a2a                                    ;****
  133 T:3a2a  ad 34 40                 prtbtst   lda prtdev
  133 T:3a2d  09 80                              ora #$80
  133 T:3a2f  aa                                 tax 
  134 T:3a30  d0 03                              bne prttst1
  135 T:3a32  ae 34 40                 prttst    ldx prtdev
  136 T:3a35  ad 35 40                 prttst1   lda prtfl
  136 T:3a38  10 0c                              bpl pttr
  137 T:3a3a  ad 35 40                           lda prtfl
  137 T:3a3d  09 40                              ora #64
  137 T:3a3f  8d 35 40                           sta prtfl
  138 T:3a42  8a                                 txa 
  138 T:3a43  4c b4 a0                           jmp chodev
  139 T:3a46  a9 00                    pttr      lda #0
  139 T:3a48  60                                 rts 
  140 T:3a49                                    ;****
  141 T:3a49  ad 35 40                 prtoff    lda prtfl
  141 T:3a4c  29 bf                              and #191
  141 T:3a4e  8d 35 40                           sta prtfl
  142 T:3a51  a9 00                              lda #0
  142 T:3a53  4c b4 a0                           jmp chodev

  145 T:3a56                                    ;********
  146 T:3a56  85 30                    pecho     sta czei
  146 T:3a58  84 31                              sty czei+1
  147 T:3a5a  20 32 3a                           jsr prttst
  147 T:3a5d  d0 0c                              bne pecr
  148 T:3a5f  a5 30                              lda czei
  148 T:3a61  a4 31                              ldy czei+1
  149 T:3a63  20 8f 38                           jsr textout
  149 T:3a66  20 55 2a                           jsr crout
  150 T:3a69  a9 00                              lda #0
  150 T:3a6b  48                       pecr      pha 
  151 T:3a6c  20 49 3a                           jsr prtoff
  151 T:3a6f  68                                 pla 
  151 T:3a70  60                                 rts 
  152 T:3a71                                    ;********
  153 T:3a71  85 30                    pprtdev   sta czei
  153 T:3a73  84 31                              sty czei+1
  154 T:3a75  20 2b 29                           jsr gbyt
  154 T:3a78  b0 af                              bcs pca1
  155 T:3a7a  8e 34 40                           stx prtdev
  156 T:3a7d  20 2b 29                           jsr gbyt
  156 T:3a80  b0 a7                              bcs pca1
  156 T:3a82  8a                                 txa 
  157 T:3a83  29 3f                              and #63
  157 T:3a85  2c 35 40                           bit prtfl
  157 T:3a88  10 02                              bpl ppd1
  158 T:3a8a  09 80                              ora #128
  158 T:3a8c  8d 35 40                 ppd1      sta prtfl
  159 T:3a8f  a9 00                              lda #0
  159 T:3a91  60                                 rts 
  160 T:3a92                                    ;********

  162 T:3a92  a9 00                    prtinit   lda #0
  162 T:3a94  8d 35 40                           sta prtfl
  163 T:3a97  a2 5c                              ldx #<svtab
  163 T:3a99  a0 55                              ldy #>svtab
  163 T:3a9b  20 ae a0                           jsr setvec
  164 T:3a9e  60                                 rts 
  165 T:3a9f                                    ;********
  166 T:3a9f  2c 35 40                 pchout    bit prtfl
  166 T:3aa2  50 4f                              bvc pcor
  167 T:3aa4  48                                 pha 
  167 T:3aa5  ad 35 40                           lda prtfl
  168 T:3aa8  4a                                 lsr 
  168 T:3aa9  90 07                              bcc pco1
  169 T:3aab  68                                 pla 
  169 T:3aac  20 90 50                           jsr bcbmasc
  169 T:3aaf  4c bd 3a                           jmp pco3
  170 T:3ab2  4a                       pco1      lsr 
  170 T:3ab3  90 07                              bcc pco2
  171 T:3ab5  68                                 pla 
  171 T:3ab6  20 7a 50                           jsr basccbm
  171 T:3ab9  4c bd 3a                           jmp pco3
  172 T:3abc  68                       pco2      pla 
  172 T:3abd                           pco3      
  173 T:3abd  c9 0a                              cmp #10
  173 T:3abf  d0 0c                              bne pco4
  174 T:3ac1  ad 35 40                           lda prtfl
  174 T:3ac4  29 30                              and #%00110000
  175 T:3ac6  49 10                              eor #%00010000
  175 T:3ac8  4a                                 lsr 
  175 T:3ac9  4a                                 lsr 
  176 T:3aca  4c d6 3a                           jmp pco4a
  177 T:3acd  c9 0d                    pco4      cmp #13
  177 T:3acf  d0 22                              bne pcor
  178 T:3ad1  ad 35 40                           lda prtfl
  178 T:3ad4  29 0c                              and #%00001100
  178 T:3ad6                           pco4a     
  179 T:3ad6  4a                                 lsr 
  179 T:3ad7  4a                                 lsr 
  179 T:3ad8  8d 36 40                           sta prtdiv
  180 T:3adb  c9 02                              cmp #2
  180 T:3add  90 0a                              bcc pco7
  181 T:3adf  4a                                 lsr 
  181 T:3ae0  a9 0a                              lda #10
  181 T:3ae2  90 02                              bcc pco6
  181 T:3ae4  a9 0d                              lda #13
  181 T:3ae6                           pco6      
  182 T:3ae6  20 f3 3a                           jsr pcor
  183 T:3ae9  ad 36 40                 pco7      lda prtdiv
  184 T:3aec  4a                                 lsr 
  184 T:3aed  a9 0d                              lda #13
  184 T:3aef  90 02                              bcc pco8
  184 T:3af1  a9 0a                              lda #10
  184 T:3af3                           pco8      
  185 T:3af3  6c 37 40                 pcor      jmp (vchout)
  186 T:3af6                                     .end 

PRA 2.4 .S50

    1 T:3af6                                     .include "WP1 2.4 .S96"

WP1 2.4 .S96


    3 T:3af6                                    ;../WP1 2.4 .S96 ==0801==
    4 T:3af6  a9 00                    menuprg   lda #0
    4 T:3af8  85 9d                              sta $9d              ; error meldung unterbinden
    5 T:3afa  20 9a 4e                           jsr sortinit
    6 T:3afd  20 17 50                           jsr convinit
    7 T:3b00  20 c3 50                           jsr mprtinit
    8 T:3b03  a9 30                              lda #"0"
    8 T:3b05  8d 8c 40                           sta iecdrive
    9 T:3b08  ad 8f 40                           lda menubcol
    9 T:3b0b  20 ca 51                           jsr setbck
    9 T:3b0e  ad 8e 40                           lda menutcol
    9 T:3b11  20 cd 51                           jsr settxt
   10 T:3b14  a9 08                              lda #8             ;"{dish}"
   10 T:3b16  20 97 51                           jsr wout
   10 T:3b19  a9 8e                              lda #142
   10 T:3b1b  20 97 51                           jsr wout
   11 T:3b1e                                    ;********
   12 T:3b1e  a9 70                    mprg      lda #<mainmenu
   12 T:3b20  a0 5b                              ldy #>mainmenu
   13 T:3b22  20 8b 51                           jsr wminit
   14 T:3b25  20 57 a0                           jsr version
   14 T:3b28  8a                                 txa 
   14 T:3b29  18                                 clc 
   14 T:3b2a  69 10                              adc #vetext
   14 T:3b2c  90 01                              bcc mver1
   14 T:3b2e  c8                                 iny 
   14 T:3b2f  20 b2 51                 mver1     jsr wprnterr
   15 T:3b32  20 3b 41                 mp3       jsr stline
   15 T:3b35  20 af 51                           jsr wclrcmd
   15 T:3b38  a9 07                              lda #7
   15 T:3b3a  20 97 51                           jsr wout
   15 T:3b3d  20 8e 51                           jsr wmenloop
   16 T:3b40  8a                       mp2       txa 
   16 T:3b41  48                                 pha 
   16 T:3b42  98                                 tya 
   16 T:3b43  48                                 pha 
   16 T:3b44  20 b5 51                           jsr wclrerr
   16 T:3b47  68                                 pla 
   16 T:3b48  a8                                 tay 
   16 T:3b49  68                                 pla 
   17 T:3b4a  0a                                 asl 
   17 T:3b4b  aa                                 tax 
   17 T:3b4c  20 64 3b                           jsr mp1
   18 T:3b4f  c9 00                              cmp #0
   18 T:3b51  f0 df                              beq mp3
   18 T:3b53  20 59 3b                           jsr fehlout
   18 T:3b56  4c 32 3b                           jmp mp3
   19 T:3b59  48                       fehlout   pha 
   19 T:3b5a  20 b5 51                           jsr wclrerr
   19 T:3b5d  68                                 pla 
   19 T:3b5e  20 5f 2a                           jsr errtxt
   19 T:3b61  4c b2 51                           jmp wprnterr
   20 T:3b64  bd 0f 5b                 mp1       lda mpma+1,x
   20 T:3b67  48                                 pha 
   20 T:3b68  bd 0e 5b                           lda mpma,x
   20 T:3b6b  48                                 pha 
   20 T:3b6c  60                                 rts 
   21 T:3b6d  98                       mpm1      tya 
   21 T:3b6e  0a                                 asl 
   21 T:3b6f  aa                                 tax 
   22 T:3b70  bd 19 5b                           lda mpm1a+1,x
   22 T:3b73  48                                 pha 
   22 T:3b74  bd 18 5b                           lda mpm1a,x
   22 T:3b77  48                                 pha 
   22 T:3b78  60                                 rts 
   23 T:3b79  98                       mpm2      tya 
   23 T:3b7a  0a                                 asl 
   23 T:3b7b  aa                                 tax 
   24 T:3b7c  bd 2d 5b                           lda mpm2a+1,x
   24 T:3b7f  48                                 pha 
   24 T:3b80  bd 2c 5b                           lda mpm2a,x
   24 T:3b83  48                                 pha 
   24 T:3b84  60                                 rts 
   25 T:3b85  98                       mpm3      tya 
   25 T:3b86  0a                                 asl 
   25 T:3b87  aa                                 tax 
   26 T:3b88  bd 43 5b                           lda mpm3a+1,x
   26 T:3b8b  48                                 pha 
   26 T:3b8c  bd 42 5b                           lda mpm3a,x
   26 T:3b8f  48                                 pha 
   26 T:3b90  60                                 rts 
   27 T:3b91  98                       mpm4      tya 
   27 T:3b92  0a                                 asl 
   27 T:3b93  aa                                 tax 
   28 T:3b94  bd 4f 5b                           lda mpm4a+1,x
   28 T:3b97  48                                 pha 
   28 T:3b98  bd 4e 5b                           lda mpm4a,x
   28 T:3b9b  48                                 pha 
   28 T:3b9c  60                                 rts 
   29 T:3b9d  98                       mpm5      tya 
   29 T:3b9e  0a                                 asl 
   29 T:3b9f  aa                                 tax 
   30 T:3ba0  bd 5d 5b                           lda mpm5a+1,x
   30 T:3ba3  48                                 pha 
   30 T:3ba4  bd 5c 5b                           lda mpm5a,x
   30 T:3ba7  48                                 pha 
   30 T:3ba8  60                                 rts 
   31 T:3ba9  18                       mpr       clc 
   31 T:3baa  60                                 rts 
   32 T:3bab                                    ;**** copyrights
   33 T:3bab  20 57 a0                 mpm11     jsr version
   33 T:3bae  8a                                 txa 
   33 T:3baf  18                                 clc 
   33 T:3bb0  69 10                              adc #vetext
   33 T:3bb2  90 01                              bcc mver2
   33 T:3bb4  c8                                 iny 
   33 T:3bb5  20 b2 51                 mver2     jsr wprnterr
   34 T:3bb8  a9 cb                              lda #<coptxt
   34 T:3bba  a0 5d                              ldy #>coptxt
   34 T:3bbc  20 b8 51                           jsr wopenmsg
   35 T:3bbf  20 9d 51                 mpm11a    jsr wgetkey
   35 T:3bc2  c9 0d                              cmp #13
   35 T:3bc4  d0 f9                              bne mpm11a
   36 T:3bc6  20 94 51                           jsr wclose
   36 T:3bc9  a9 00                              lda #0
   36 T:3bcb  60                                 rts 
   37 T:3bcc                                    ;**** colours
   38 T:3bcc  a9 20                    mpm12     lda #<coltxt
   38 T:3bce  a0 5e                              ldy #>coltxt
   39 T:3bd0  20 b8 51                           jsr wopenmsg
   40 T:3bd3  ad 8f 40                 mpm12d    lda menubcol
   40 T:3bd6  20 ca 51                           jsr setbck
   40 T:3bd9  ad 8e 40                           lda menutcol
   40 T:3bdc  20 cd 51                           jsr settxt
   41 T:3bdf  20 9d 51                 mpm12a    jsr wgetkey
   41 T:3be2  f0 fb                              beq mpm12a
   42 T:3be4  c9 1d                              cmp #29             ; "{rght}"
   42 T:3be6  d0 06                              bne mpm12b
   43 T:3be8  ee 8f 40                           inc menubcol
   43 T:3beb  4c d3 3b                           jmp mpm12d
   44 T:3bee  c9 9d                    mpm12b    cmp #29+128    ;"{left}"
   44 T:3bf0  d0 06                              bne mpm12c
   45 T:3bf2  ce 8f 40                           dec menubcol
   45 T:3bf5  4c d3 3b                           jmp mpm12d
   46 T:3bf8  c9 11                    mpm12c    cmp #17          ;"{down}"
   46 T:3bfa  d0 06                              bne mpm12e
   47 T:3bfc  ee 8e 40                           inc menutcol
   47 T:3bff  4c d3 3b                           jmp mpm12d
   48 T:3c02  c9 91                    mpm12e    cmp #17+128    ;"{up}"
   48 T:3c04  d0 06                              bne mpm12f
   49 T:3c06  ce 8e 40                           dec menutcol
   49 T:3c09  4c d3 3b                           jmp mpm12d
   50 T:3c0c  c9 0d                    mpm12f    cmp #13
   50 T:3c0e  d0 cf                              bne mpm12a
   51 T:3c10  20 94 51                           jsr wclose
   51 T:3c13  a9 00                              lda #0
   51 T:3c15  60                       m14a      rts 
   52 T:3c16                                    ;********
   53 T:3c16  20 d0 40                 mpm14     jsr asksure
   53 T:3c19  b0 fa                              bcs m14a
   53 T:3c1b  20 03 a0                           jsr exit
   53 T:3c1e  6c fc ff                           jmp ($fffc)
   54 T:3c21                                    ;********
   55 T:3c21                           mpm13     

   61 T:3c21  68                                 pla 
   61 T:3c22  68                                 pla 
   61 T:3c23  20 94 51                           jsr wclose
   61 T:3c26  20 04 52                           jsr wclr
   62 T:3c29  4c 58 29                           jmp cliprg
   63 T:3c2c                                    ;********

   66 T:3c2c                           mpm28     

   71 T:3c2c  a9 09                              lda #9
   71 T:3c2e  20 d0 48                           jsr prntcmd
   72 T:3c31  a9 9d                              lda #<mbeft
   72 T:3c33  a0 62                              ldy #>mbeft
   72 T:3c35  20 be 51                           jsr winput
   73 T:3c38  90 01                              bcc m27nff
   73 T:3c3a  60                                 rts 
   74 T:3c3b  86 30                    m27nff    stx czei
   74 T:3c3d  84 31                              sty czei+1
   75 T:3c3f  20 e5 29                           jsr sbef
   75 T:3c42  f0 08                              beq m27nf
   75 T:3c44  c9 0a                              cmp #maxmenu+1
   75 T:3c46  b0 04                              bcs m27nf
   76 T:3c48  20 d3 29                           jsr exec
   76 T:3c4b  60                                 rts 
   76 T:3c4c  a9 ff                    m27nf     lda #ennotimp
   76 T:3c4e  60                                 rts 
   77 T:3c4f                                    ;******** cbmunit

   79 T:3c4f  a9 0b                    mpm32     lda #11
   79 T:3c51  20 d0 48                           jsr prntcmd
   80 T:3c54  a2 00                              ldx #0
   80 T:3c56  a9 f4                              lda #<m32mt
   80 T:3c58  a0 61                              ldy #>m32mt
   80 T:3c5a  20 a0 51                           jsr wsubmenu
   81 T:3c5d  20 a6 51                 m32b      jsr wsubloop
   82 T:3c60  c9 0d                    m32a      cmp #13
   82 T:3c62  d0 f9                              bne m32b
   83 T:3c64  98                                 tya 
   83 T:3c65  18                                 clc 
   83 T:3c66  69 08                              adc #8
   83 T:3c68  c9 0c                              cmp #12
   83 T:3c6a  90 09                              bcc m32c
   84 T:3c6c  18                                 clc 
   84 T:3c6d  69 23                              adc #"0"-13
   84 T:3c6f  8d 8c 40                           sta iecdrive
   84 T:3c72  4c 78 3c                           jmp m32d
   85 T:3c75  8d 33 40                 m32c      sta iecunit
   85 T:3c78  20 94 51                 m32d      jsr wclose
   85 T:3c7b  a9 00                              lda #0
   85 T:3c7d  60                                 rts 
   86 T:3c7e                                    ;**** cbmcommand
   87 T:3c7e  a9 09                    mpm34     lda #9
   87 T:3c80  20 d0 48                           jsr prntcmd
   88 T:3c83  a9 3e                              lda #<m34t
   88 T:3c85  a0 62                              ldy #>m34t
   88 T:3c87  20 be 51                           jsr winput
   88 T:3c8a  90 01                              bcc mpm34x
   88 T:3c8c  60                                 rts 
   89 T:3c8d  20 bd ff                 mpm34x    jsr setfnpar
   90 T:3c90  a9 01                              lda #1
   90 T:3c92  ae 33 40                           ldx iecunit
   90 T:3c95  a0 0f                              ldy #15
   90 T:3c97  20 ba ff                           jsr setfpar
   91 T:3c9a  20 c0 ff                           jsr open
   91 T:3c9d  09 40                              ora #64
   91 T:3c9f  b0 05                              bcs m34c
   92 T:3ca1  20 b1 3c                           jsr m34b
   92 T:3ca4  a9 00                              lda #0
   93 T:3ca6  48                       m34c      pha 
   93 T:3ca7  20 cc ff                           jsr clrch
   93 T:3caa  a9 01                    m34c1     lda #1
   93 T:3cac  20 c3 ff                           jsr close
   93 T:3caf  68                                 pla 
   93 T:3cb0  60                                 rts 
   94 T:3cb1  a2 01                    m34b      ldx #1
   94 T:3cb3  20 c6 ff                           jsr chkin
   94 T:3cb6  09 40                              ora #64
   94 T:3cb8  b0 ec                              bcs m34c
   94 T:3cba  a0 00                              ldy #0
   94 T:3cbc  84 90                              sty status
   95 T:3cbe  20 cf ff                 m34a      jsr basin
   95 T:3cc1  c9 0d                              cmp #13
   95 T:3cc3  f0 04                              beq m34aa
   95 T:3cc5  99 00 02                           sta iobuf,y
   96 T:3cc8  c8                                 iny 
   96 T:3cc9  a5 90                    m34aa     lda status
   96 T:3ccb  f0 f1                              beq m34a
   97 T:3ccd  a9 00                              lda #0
   97 T:3ccf  99 00 02                           sta iobuf,y
   97 T:3cd2  20 cc ff                           jsr clrch
   98 T:3cd5  20 b5 51                           jsr wclrerr
   99 T:3cd8  a9 00                              lda #<iobuf
   99 T:3cda  a0 02                              ldy #>iobuf
   99 T:3cdc  20 b2 51                           jsr wprnterr
  100 T:3cdf  ad 00 02                           lda iobuf
  100 T:3ce2  c9 30                              cmp #"0"
  100 T:3ce4  d0 03                              bne m34y
  101 T:3ce6  a9 00                              lda #0
  101 T:3ce8  60                                 rts 
  101 T:3ce9  a9 ec                    m34y      lda #eneof
  101 T:3ceb  60                                 rts 
  102 T:3cec                                    ;******** (cbmcatalog)
  103 T:3cec  a9 01                    ismcbm    lda #1
  103 T:3cee  20 d0 48                           jsr prntcmd
  104 T:3cf1  a9 4c                              lda #<ismct
  104 T:3cf3  a0 62                              ldy #>ismct
  104 T:3cf5  20 be 51                           jsr winput
  104 T:3cf8  90 01                              bcc ismcx
  104 T:3cfa  60                                 rts 
  105 T:3cfb  48                       ismcx     pha 
  105 T:3cfc  c9 00                              cmp #0
  105 T:3cfe  d0 02                              bne ismc3
  105 T:3d00  a9 01                              lda #1
  106 T:3d02  18                       ismc3     clc 
  106 T:3d03  69 03                              adc #3
  106 T:3d05  20 bd ff                           jsr setfnpar
  106 T:3d08  a8                                 tay 
  106 T:3d09  68                                 pla 
  106 T:3d0a  48                                 pha 
  106 T:3d0b  aa                                 tax 
  107 T:3d0c  bd 00 02                 ismc1     lda iobuf,x
  107 T:3d0f  99 00 02                           sta iobuf,y
  108 T:3d12  88                                 dey 
  108 T:3d13  ca                                 dex 
  108 T:3d14  10 f6                              bpl ismc1
  109 T:3d16  68                                 pla 
  109 T:3d17  d0 08                              bne ismc2
  109 T:3d19  8d 04 02                           sta iobuf+4
  110 T:3d1c  a9 2a                              lda #"*"
  110 T:3d1e  8d 03 02                           sta iobuf+3
  111 T:3d21  a9 24                    ismc2     lda #"$"
  111 T:3d23  8d 00 02                           sta iobuf
  112 T:3d26  ad 8c 40                           lda iecdrive
  112 T:3d29  8d 01 02                           sta iobuf+1
  112 T:3d2c  a9 3a                              lda #":"
  112 T:3d2e  8d 02 02                           sta iobuf+2
  112 T:3d31  18                                 clc 
  112 T:3d32  60                                 rts 
  113 T:3d33                                    ;****
  114 T:3d33  4c f7 3d                 m31err    jmp m31i1
  115 T:3d36                                    ;****
  116 T:3d36  20 ec 3c                 gtcbmdir  jsr ismcbm
  116 T:3d39  90 01                              bcc gtcbm1
  116 T:3d3b  60                                 rts 
  117 T:3d3c  a9 13                    gtcbm1    lda #19          ;"{home}"
  117 T:3d3e  20 97 51                           jsr wout
  118 T:3d41  a9 01                              lda #1
  118 T:3d43  ae 33 40                           ldx iecunit
  118 T:3d46  a0 00                              ldy #0
  118 T:3d48  20 ba ff                           jsr setfpar
  119 T:3d4b  20 c0 ff                           jsr open
  119 T:3d4e  09 40                              ora #64
  119 T:3d50  b0 e1                              bcs m31err
  120 T:3d52  a2 01                              ldx #1
  120 T:3d54  20 c6 ff                           jsr chkin
  120 T:3d57  09 40                              ora #64
  120 T:3d59  b0 d8                              bcs m31err
  121 T:3d5b  20 cf ff                           jsr basin
  121 T:3d5e  20 cf ff                           jsr basin
  121 T:3d61  20 cf ff                           jsr basin
  121 T:3d64  20 cf ff                           jsr basin
  122 T:3d67  20 cf ff                           jsr basin
  122 T:3d6a  48                                 pha 
  122 T:3d6b  20 cf ff                           jsr basin
  122 T:3d6e  68                                 pla 
  123 T:3d6f  29 0f                              and #15
  123 T:3d71  18                                 clc 
  123 T:3d72  69 30                              adc #"0"
  123 T:3d74  8d 00 02                           sta iobuf
  124 T:3d77  a9 20                              lda #" "
  124 T:3d79  8d 01 02                           sta iobuf+1
  125 T:3d7c  a0 02                              ldy #2
  126 T:3d7e  20 cf ff                 m31a      jsr basin
  126 T:3d81  c9 20                              cmp #" "
  126 T:3d83  90 04                              bcc m31b
  127 T:3d85  99 00 02                           sta iobuf,y
  127 T:3d88  c8                                 iny 
  128 T:3d89                           m31b      
  129 T:3d89  a6 90                              ldx status
  129 T:3d8b  f0 09                              beq m31aa
  130 T:3d8d  a9 00                              lda #0
  130 T:3d8f  99 00 02                           sta iobuf,y
  130 T:3d92  a9 f0                              lda #endnrdy
  130 T:3d94  d0 9d                              bne m31err
  131 T:3d96  c9 00                    m31aa     cmp #0
  131 T:3d98  d0 e4                              bne m31a
  132 T:3d9a  99 00 02                           sta iobuf,y
  133 T:3d9d  a9 be                              lda #<liste
  133 T:3d9f  85 0e                              sta lzei
  134 T:3da1  a9 42                              lda #>liste
  134 T:3da3  85 0f                              sta lzei+1
  135 T:3da5  a9 00                              lda #0
  135 T:3da7  8d 87 40                           sta lanz
  136 T:3daa  20 13 3e                 m31e      jsr getencbm
  137 T:3dad  b0 18                              bcs m31c
  138 T:3daf  a9 14                              lda #20
  138 T:3db1  18                                 clc 
  138 T:3db2  65 0e                              adc lzei
  138 T:3db4  85 0e                              sta lzei
  138 T:3db6  90 02                              bcc m31d
  139 T:3db8  e6 0f                              inc lzei+1
  139 T:3dba  ee 87 40                 m31d      inc lanz
  140 T:3dbd  20 70 4e                           jsr testlist
  140 T:3dc0  90 e8                              bcc m31e
  140 T:3dc2  a9 20                              lda #32
  140 T:3dc4  4c f7 3d                           jmp m31i1
  141 T:3dc7  a0 00                    m31c      ldy #0
  141 T:3dc9  b1 0e                              lda (lzei),y
  141 T:3dcb  8d 41 40                           sta int1
  142 T:3dce  c8                                 iny 
  142 T:3dcf  b1 0e                              lda (lzei),y
  142 T:3dd1  8d 42 40                           sta int1+1
  143 T:3dd4  a2 00                              ldx #0
  143 T:3dd6  bd 00 02                 m31f      lda iobuf,x
  143 T:3dd9  f0 03                              beq m31g
  143 T:3ddb  e8                                 inx 
  143 T:3ddc  d0 f8                              bne m31f
  144 T:3dde  a9 2c                    m31g      lda #","
  144 T:3de0  9d 00 02                           sta iobuf,x
  144 T:3de3  e8                                 inx 
  145 T:3de4  20 f6 40                           jsr getdez
  145 T:3de7  a0 00                              ldy #0
  146 T:3de9  b9 54 62                 m31h      lda m31bft,y
  146 T:3dec  9d 00 02                           sta iobuf,x
  146 T:3def  f0 04                              beq m31i
  147 T:3df1  c8                                 iny 
  147 T:3df2  e8                                 inx 
  147 T:3df3  d0 f4                              bne m31h
  148 T:3df5  a9 00                    m31i      lda #0
  149 T:3df7                           m31i1     
  150 T:3df7  48                                 pha 
  150 T:3df8  20 cc ff                           jsr clrch
  150 T:3dfb  a9 01                              lda #1
  150 T:3dfd  20 c3 ff                           jsr close
  150 T:3e00  68                                 pla 
  151 T:3e01  d0 0f                              bne m31sor
  152 T:3e03  a2 00                              ldx #0
  152 T:3e05  ac 87 40                           ldy lanz
  152 T:3e08  f0 06                              beq m31sor0
  152 T:3e0a  88                                 dey 
  153 T:3e0b  a9 00                              lda #0
  153 T:3e0d  20 ff 4e                           jsr sort
  154 T:3e10  a9 00                    m31sor0   lda #0
  154 T:3e12  60                       m31sor    rts 
  155 T:3e13                                    ;****
  156 T:3e13  20 cf ff                 getencbm  jsr basin
  156 T:3e16  20 cf ff                           jsr basin                ; kettenadresse
  157 T:3e19  a0 00                              ldy #0
  157 T:3e1b  20 cf ff                           jsr basin
  157 T:3e1e  91 0e                              sta (lzei),y
  157 T:3e20  c8                                 iny 
  158 T:3e21  20 cf ff                           jsr basin
  158 T:3e24  91 0e                              sta (lzei),y
  158 T:3e26  c8                                 iny 
  159 T:3e27  20 cf ff                 gec1      jsr basin
  159 T:3e2a  c9 22                              cmp #34
  159 T:3e2c  f0 06                              beq gec2
  160 T:3e2e  a5 90                              lda status
  160 T:3e30  f0 f5                              beq gec1
  160 T:3e32  d0 3b                              bne gecr
  161 T:3e34  20 cf ff                 gec2      jsr basin
  161 T:3e37  c9 22                              cmp #34
  161 T:3e39  f0 0f                              beq gec4a
  162 T:3e3b  c9 20                              cmp #" "
  162 T:3e3d  b0 02                              bcs gec3
  163 T:3e3f  69 40                              adc #"@"
  163 T:3e41  91 0e                    gec3      sta (lzei),y
  163 T:3e43  c8                                 iny 
  164 T:3e44  a5 90                              lda status
  164 T:3e46  f0 ec                              beq gec2
  164 T:3e48  d0 25                              bne gecr
  165 T:3e4a  a9 00                    gec4a     lda #0
  165 T:3e4c  91 0e                              sta (lzei),y
  166 T:3e4e  20 cf ff                 gec4      jsr basin
  166 T:3e51  c9 20                              cmp #" "
  166 T:3e53  d0 06                              bne gec5
  167 T:3e55  a5 90                              lda status
  167 T:3e57  f0 f5                              beq gec4
  167 T:3e59  d0 14                              bne gecr
  168 T:3e5b  a0 13                    gec5      ldy #19
  168 T:3e5d  91 0e                              sta (lzei),y
  169 T:3e5f  a9 00                              lda #0
  169 T:3e61  88                                 dey 
  169 T:3e62  91 0e                              sta (lzei),y
  170 T:3e64  20 cf ff                 gec6      jsr basin
  170 T:3e67  c9 00                              cmp #0
  170 T:3e69  f0 06                              beq gec7
  171 T:3e6b  a5 90                              lda status
  171 T:3e6d  f0 f5                              beq gec6
  172 T:3e6f  38                       gecr      sec 
  172 T:3e70  60                                 rts 
  172 T:3e71  18                       gec7      clc 
  172 T:3e72  60                                 rts 
  173 T:3e73                                    ;****
  174 T:3e73  ad 8a 40                 inimlist  lda lseit
  174 T:3e76  8d 41 40                           sta int1
  174 T:3e79  a9 00                              lda #0
  174 T:3e7b  8d 42 40                           sta int1+1
  175 T:3e7e  a9 13                              lda #mdiranz
  175 T:3e80  a2 00                              ldx #0
  175 T:3e82  20 6f 49                           jsr mult
  176 T:3e85  8d 41 40                           sta int1
  176 T:3e88  ad 87 40                           lda lanz
  176 T:3e8b  38                                 sec 
  176 T:3e8c  ed 41 40                           sbc int1
  177 T:3e8f  c9 13                              cmp #mdiranz
  177 T:3e91  90 04                              bcc iml1
  177 T:3e93  f0 02                              beq iml1
  178 T:3e95  a9 13                              lda #mdiranz
  179 T:3e97  8d 9b 40                 iml1      sta dirmenu
  179 T:3e9a  8d 88 40                           sta lmanz
  179 T:3e9d  a9 1b                              lda #mdirtbrt
  179 T:3e9f  8d 9c 40                           sta dirmenu+1
  180 T:3ea2  a9 03                              lda #3
  180 T:3ea4  8d 9d 40                           sta dirmenu+2
  180 T:3ea7  a9 06                              lda #6
  180 T:3ea9  8d 9e 40                           sta dirmenu+3
  181 T:3eac  a9 00                              lda #0
  181 T:3eae  8d 42 40                           sta int1+1
  181 T:3eb1  a9 14                              lda #20
  181 T:3eb3  a2 00                              ldx #0
  181 T:3eb5  20 6f 49                           jsr mult
  182 T:3eb8  18                                 clc 
  182 T:3eb9  69 be                              adc #<liste
  182 T:3ebb  85 0e                              sta lzei
  182 T:3ebd  8a                                 txa 
  182 T:3ebe  69 42                              adc #>liste
  182 T:3ec0  85 0f                              sta lzei+1
  183 T:3ec2  a9 9f                              lda #<dirmenu+4
  183 T:3ec4  85 10                              sta lmzei
  183 T:3ec6  a9 40                              lda #>dirmenu+4
  183 T:3ec8  85 11                              sta lmzei+1
  184 T:3eca  a9 20                    iml2      lda #" "
  184 T:3ecc  8d 00 02                           sta iobuf
  184 T:3ecf  8d 01 02                           sta iobuf+1
  184 T:3ed2  8d 02 02                           sta iobuf+2
  185 T:3ed5  a0 02                              ldy #2
  185 T:3ed7  b1 0e                    iml3      lda (lzei),y
  185 T:3ed9  f0 08                              beq iml4
  186 T:3edb  99 01 02                           sta iobuf+1,y
  186 T:3ede  c8                                 iny 
  186 T:3edf  c0 12                              cpy #18
  186 T:3ee1  d0 f4                              bne iml3
  187 T:3ee3  a9 20                    iml4      lda #" "
  188 T:3ee5  c0 13                    iml5      cpy #19
  188 T:3ee7  f0 06                              beq iml6
  188 T:3ee9  99 01 02                           sta iobuf+1,y
  188 T:3eec  c8                                 iny 
  188 T:3eed  d0 f6                              bne iml5
  189 T:3eef  8d 15 02                 iml6      sta iobuf+21
  189 T:3ef2  b1 0e                              lda (lzei),y
  189 T:3ef4  99 01 02                           sta iobuf+1,y
  190 T:3ef7  a0 12                              ldy #18
  190 T:3ef9  b1 0e                              lda (lzei),y
  190 T:3efb  10 05                              bpl iml6a
  190 T:3efd  a9 3e                              lda #">"
  190 T:3eff  8d 01 02                           sta iobuf+1
  191 T:3f02  a0 00                    iml6a     ldy #0
  191 T:3f04  b1 0e                              lda (lzei),y
  191 T:3f06  8d 41 40                           sta int1
  191 T:3f09  c8                                 iny 
  191 T:3f0a  b1 0e                              lda (lzei),y
  191 T:3f0c  8d 42 40                           sta int1+1
  192 T:3f0f  a2 16                              ldx #22
  192 T:3f11  20 f6 40                           jsr getdez
  193 T:3f14  a9 20                              lda #" "
  193 T:3f16  9d 00 02                 iml7      sta iobuf,x
  193 T:3f19  e0 1a                              cpx #26
  193 T:3f1b  f0 03                              beq iml8
  193 T:3f1d  e8                                 inx 
  193 T:3f1e  d0 f6                              bne iml7
  194 T:3f20  a0 1b                    iml8      ldy #mdirtbrt
  194 T:3f22  b9 ff 01                 iml9      lda iobuf-1,y
  194 T:3f25  91 10                              sta (lmzei),y
  194 T:3f27  88                                 dey 
  194 T:3f28  d0 f8                              bne iml9
  195 T:3f2a  a9 80                              lda #128
  195 T:3f2c  91 10                              sta (lmzei),y
  196 T:3f2e  a5 0e                              lda lzei
  196 T:3f30  18                                 clc 
  196 T:3f31  69 14                              adc #20
  196 T:3f33  85 0e                              sta lzei
  196 T:3f35  90 02                              bcc iml10
  197 T:3f37  e6 0f                              inc lzei+1
  197 T:3f39                           iml10     
  198 T:3f39  a5 10                              lda lmzei
  198 T:3f3b  18                                 clc 
  198 T:3f3c  69 1c                              adc #mdirtbrt+1
  198 T:3f3e  85 10                              sta lmzei
  198 T:3f40  90 02                              bcc iml11
  199 T:3f42  e6 11                              inc lmzei+1
  199 T:3f44  ce 88 40                 iml11     dec lmanz
  199 T:3f47  d0 81                              bne iml2
  199 T:3f49  60                                 rts 
  200 T:3f4a                                    ;********
  201 T:3f4a  20 36 3d                 mpm31     jsr gtcbmdir
  201 T:3f4d  f0 01                              beq mpm31x
  201 T:3f4f  60                                 rts 
  202 T:3f50  a9 00                    mpm31x    lda #<iobuf
  202 T:3f52  a0 02                              ldy #>iobuf
  202 T:3f54  20 b2 51                           jsr wprnterr
  203 T:3f57  ad 87 40                           lda lanz
  203 T:3f5a  d0 01                              bne mpm31y
  204 T:3f5c  60                                 rts 
  205 T:3f5d  a9 0a                    mpm31y    lda #10
  205 T:3f5f  20 d0 48                           jsr prntcmd
  205 T:3f62  a9 00                              lda #0
  206 T:3f64  8d 89 40                 mpdirin   sta mpdf
  206 T:3f67  a9 00                              lda #0
  206 T:3f69  8d 8a 40                           sta lseit
  206 T:3f6c  2c                                 .byt $2c
  206 T:3f6d  a9 80                    mp31a1    lda #128
  207 T:3f6f  48                                 pha 
  207 T:3f70  20 73 3e                           jsr inimlist
  207 T:3f73  68                                 pla 
  207 T:3f74  09 20                              ora #32
  207 T:3f76  aa                                 tax 
  208 T:3f77  a9 9b                              lda #<dirmenu
  208 T:3f79  a0 40                              ldy #>dirmenu
  208 T:3f7b  20 a0 51                           jsr wsubmenu
  209 T:3f7e  20 a6 51                 mp31a     jsr wsubloop
  210 T:3f81  c9 1d                    mp31al    cmp #29          ;"{rght}"
  210 T:3f83  f0 04                              beq mp31aa
  210 T:3f85  c9 11                              cmp #17             ;"{down}"
  210 T:3f87  d0 23                              bne mp31b
  211 T:3f89  ad 8a 40                 mp31aa    lda lseit
  211 T:3f8c  8d 41 40                           sta int1
  211 T:3f8f  ee 41 40                           inc int1
  211 T:3f92  a9 00                              lda #0
  211 T:3f94  8d 42 40                           sta int1+1
  212 T:3f97  a9 13                              lda #mdiranz
  212 T:3f99  a2 00                              ldx #0
  212 T:3f9b  20 6f 49                           jsr mult
  212 T:3f9e  e0 00                              cpx #0
  212 T:3fa0  d0 dc                              bne mp31a
  213 T:3fa2  cd 87 40                           cmp lanz
  213 T:3fa5  b0 d7                              bcs mp31a
  214 T:3fa7  ee 8a 40                           inc lseit
  214 T:3faa  d0 c1                              bne mp31a1
  215 T:3fac  c9 9d                    mp31b     cmp #29+128    ;"{left}"
  215 T:3fae  f0 04                              beq mp31ba
  215 T:3fb0  c9 91                              cmp #17+128       ;"{up}"
  215 T:3fb2  d0 0b                              bne mp31c
  216 T:3fb4  ad 8a 40                 mp31ba    lda lseit
  216 T:3fb7  f0 c5                              beq mp31a
  217 T:3fb9  ce 8a 40                           dec lseit
  217 T:3fbc  4c 6d 3f                           jmp mp31a1
  218 T:3fbf  c9 3d                    mp31c     cmp #"="
  218 T:3fc1  f0 23                              beq mp31d
  218 T:3fc3  c9 23                              cmp #"#"
  218 T:3fc5  f0 1f                              beq mp31d
  219 T:3fc7  c9 03                              cmp #3
  219 T:3fc9  f0 09                              beq mp31e
  219 T:3fcb  c9 0d                              cmp #13
  219 T:3fcd  d0 af                              bne mp31a
  220 T:3fcf  2c 89 40                           bit mpdf
  220 T:3fd2  70 63                              bvs mp31xx
  221 T:3fd4  48                       mp31e     pha 
  221 T:3fd5  20 94 51                           jsr wclose
  221 T:3fd8  20 b5 51                           jsr wclrerr
  222 T:3fdb  68                                 pla 
  222 T:3fdc  c9 03                              cmp #3
  222 T:3fde  f0 03                              beq mp31ea
  222 T:3fe0  a9 00                              lda #0
  222 T:3fe2  60                                 rts 
  223 T:3fe3  a9 ea                    mp31ea    lda #enbreak
  223 T:3fe5  60                                 rts 
  224 T:3fe6  ad 89 40                 mp31d     lda mpdf
  224 T:3fe9  10 e9                              bpl mp31e
  224 T:3feb  8c 73 40                           sty sma
  225 T:3fee  ad 8a 40                           lda lseit
  225 T:3ff1  8d 41 40                           sta int1
  225 T:3ff4  a9 00                              lda #0
  225 T:3ff6  8d 42 40                           sta int1+1
  226 T:3ff9  a9 13                              lda #mdiranz
  226 T:3ffb  a2 00                              ldx #0
  226 T:3ffd  20 6f 49                           jsr mult
  227 T:4000  18                                 clc 
  227 T:4001  6d 73 40                           adc sma
  227 T:4004  8d 41 40                           sta int1
  227 T:4007  90 01                              bcc mp31f
  227 T:4009  e8                                 inx 
  228 T:400a  8e 42 40                 mp31f     stx int1+1
  228 T:400d  a9 14                              lda #20
  228 T:400f  a2 00                              ldx #0
  229 T:4011  20 6f 49                           jsr mult
  229 T:4014  18                                 clc 
  229 T:4015  69 be                              adc #<liste
  229 T:4017  85 0e                              sta lzei
  230 T:4019  8a                                 txa 
  230 T:401a  69 42                              adc #>liste
  230 T:401c  85 0f                              sta lzei+1
  231 T:401e  a0 12                              ldy #18
  231 T:4020  b1 0e                              lda (lzei),y
  231 T:4022  49 80                              eor #$80
  231 T:4024  91 0e                              sta (lzei),y
  232 T:4026  a0 02                              ldy #2
  232 T:4028  b1 10                              lda (lmzei),y
  232 T:402a  49 1e                              eor #$1e
  232 T:402c  91 10                              sta (lmzei),y
  233 T:402e  2c 89 40                           bit mpdf
  233 T:4031  50 04                              bvc mp31xx
  233 T:4033  a9 00                              lda #0
  233 T:4035  f0 9d                              beq mp31e
  233 T:4037                           mp31xx    
  234 T:4037  a9 11                              lda #17             ;"{down}"
  234 T:4039  20 a9 51                           jsr wexloop
  234 T:403c  4c 81 3f                           jmp mp31al
  235 T:403f                                    ;********
  236 T:403f  20 36 3d                 mpm33     jsr gtcbmdir
  236 T:4042  f0 01                              beq mpm33x
  236 T:4044  60                                 rts 
  237 T:4045  a9 00                    mpm33x    lda #<iobuf
  237 T:4047  a0 02                              ldy #>iobuf
  237 T:4049  20 b2 51                           jsr wprnterr
  238 T:404c  ad 87 40                           lda lanz
  238 T:404f  d0 01                              bne mpm33y
  239 T:4051  60                                 rts 
  240 T:4052  a9 07                    mpm33y    lda #7
  240 T:4054  20 d0 48                           jsr prntcmd
  240 T:4057  a9 80                              lda #128
  240 T:4059  20 64 3f                           jsr mpdirin
  240 T:405c  f0 01                              beq mpm33ya
  240 T:405e  60                                 rts 
  241 T:405f  a9 be                    mpm33ya   lda #<liste
  241 T:4061  85 0e                              sta lzei
  241 T:4063  a9 42                              lda #>liste
  241 T:4065  85 0f                              sta lzei+1
  242 T:4067  20 d0 40                           jsr asksure
  242 T:406a  90 01                              bcc mp33a
  242 T:406c  60                                 rts 
  243 T:406d  a9 53                    mp33a     lda #"S"
  243 T:406f  8d 00 02                           sta iobuf
  243 T:4072  ad 8c 40                           lda iecdrive
  244 T:4075  8d 01 02                           sta iobuf+1
  244 T:4078  a9 3a                              lda #":"
  244 T:407a  8d 02 02                           sta iobuf+2
  245 T:407d  a0 12                              ldy #18
  245 T:407f  b1 0e                              lda (lzei),y
  245 T:4081  10 3a                              bpl mp33c
  246 T:4083  a0 02                              ldy #2
  246 T:4085  b1 0e                    mp33d     lda (lzei),y
  246 T:4087  99 01 02                           sta iobuf+1,y
  247 T:408a  f0 0a                              beq mp33b
  247 T:408c  c8                                 iny 
  247 T:408d  c0 12                              cpy #18
  247 T:408f  d0 f4                              bne mp33d
  248 T:4091  a9 00                              lda #0
  248 T:4093  99 01 02                           sta iobuf+1,y
  249 T:4096  c8                       mp33b     iny 
  249 T:4097  98                                 tya 
  249 T:4098  a2 00                              ldx #<iobuf
  249 T:409a  a0 02                              ldy #>iobuf
  249 T:409c  20 bd ff                           jsr setfnpar
  250 T:409f  a9 01                              lda #1
  250 T:40a1  ae 33 40                           ldx iecunit
  250 T:40a4  a0 0f                              ldy #15
  250 T:40a6  20 ba ff                           jsr setfpar
  251 T:40a9  20 c0 ff                           jsr open
  251 T:40ac  20 b1 3c                           jsr m34b
  251 T:40af  48                                 pha 
  251 T:40b0  a9 01                              lda #1
  251 T:40b2  20 c3 ff                           jsr close
  251 T:40b5  68                                 pla 
  251 T:40b6  f0 05                              beq mp33c
  252 T:40b8  20 39 4e                           jsr errorq
  252 T:40bb  b0 10                              bcs mp33ee
  253 T:40bd  a5 0e                    mp33c     lda lzei
  253 T:40bf  18                                 clc 
  253 T:40c0  69 14                              adc #20
  253 T:40c2  85 0e                              sta lzei
  253 T:40c4  90 02                              bcc mp33e
  254 T:40c6  e6 0f                              inc lzei+1
  254 T:40c8  ce 87 40                 mp33e     dec lanz
  254 T:40cb  d0 a0                              bne mp33a
  255 T:40cd  a9 00                    mp33ee    lda #0
  255 T:40cf  60                                 rts 
  256 T:40d0                                    ;********
  257 T:40d0  a9 5d                    asksure   lda #<ast
  257 T:40d2  a0 62                              ldy #>ast
  257 T:40d4  20 b8 51                           jsr wopenmsg
  258 T:40d7  20 9d 51                 as1       jsr wgetkey
  258 T:40da  f0 fb                              beq as1
  259 T:40dc  c9 0d                              cmp #13
  259 T:40de  f0 0b                              beq as2
  259 T:40e0  c9 03                              cmp #3
  259 T:40e2  d0 f3                              bne as1
  260 T:40e4  20 94 51                           jsr wclose
  260 T:40e7  38                                 sec 
  260 T:40e8  a9 ea                              lda #enbreak
  260 T:40ea  60                                 rts 
  261 T:40eb  20 94 51                 as2       jsr wclose
  261 T:40ee  18                                 clc 
  261 T:40ef  60                                 rts 
  262 T:40f0                                    ;********
  263 T:40f0  a9 fe                    ertxrx    lda #entxrx
  263 T:40f2  2c                                 .byt $2c
  264 T:40f3  a9 ff                    ernotimp  lda #ennotimp
  265 T:40f5  60                                 rts 
  266 T:40f6                                    ;****
  267 T:40f6  a0 00                    getdez    ldy #0
  267 T:40f8  8e 86 40                           stx gdb
  268 T:40fb  b9 c6 55                 go1       lda dhi,y
  268 T:40fe  aa                                 tax 
  268 T:40ff  b9 cb 55                           lda dlo,y
  268 T:4102  20 da 38                           jsr ddiv
  269 T:4105  c8                                 iny 
  269 T:4106  c9 00                              cmp #0
  269 T:4108  d0 06                              bne go2
  269 T:410a  c0 04                              cpy #4
  269 T:410c  d0 ed                              bne go1
  269 T:410e  f0 0c                              beq go3
  270 T:4110  18                       go2       clc 
  270 T:4111  69 30                              adc #"0"
  270 T:4113  ae 86 40                           ldx gdb
  270 T:4116  9d 00 02                           sta iobuf,x
  270 T:4119  ee 86 40                           inc gdb
  271 T:411c  b9 c6 55                 go3       lda dhi,y
  271 T:411f  aa                                 tax 
  271 T:4120  b9 cb 55                           lda dlo,y
  271 T:4123  20 da 38                           jsr ddiv
  272 T:4126  18                                 clc 
  272 T:4127  69 30                              adc #"0"
  272 T:4129  ae 86 40                           ldx gdb
  272 T:412c  9d 00 02                           sta iobuf,x
  272 T:412f  ee 86 40                           inc gdb
  273 T:4132  c8                                 iny 
  273 T:4133  c0 05                              cpy #5
  273 T:4135  90 e5                              bcc go3
  273 T:4137  ae 86 40                           ldx gdb
  273 T:413a  60                                 rts 
  274 T:413b                                    ;********
  275 T:413b  a2 17                    stline    ldx #23
  275 T:413d  a0 00                              ldy #0
  275 T:413f  18                                 clc 
  275 T:4140  20 9a 51                           jsr wcursor
  276 T:4143  a0 27                              ldy #39
  276 T:4145  a9 20                              lda #" "
  276 T:4147  20 97 51                 stl0      jsr wout
  276 T:414a  88                                 dey 
  276 T:414b  d0 fa                              bne stl0
  277 T:414d  a2 17                              ldx #23
  277 T:414f  a0 00                              ldy #0
  277 T:4151  18                                 clc 
  277 T:4152  20 9a 51                           jsr wcursor
  278 T:4155  a9 a6                              lda #<stlt1
  278 T:4157  a0 62                              ldy #>stlt1
  278 T:4159  20 8f 38                           jsr textout
  279 T:415c  ad 8c 40                           lda iecdrive
  279 T:415f  20 97 51                           jsr wout
  279 T:4162  a9 2c                              lda #","
  279 T:4164  20 97 51                           jsr wout
  280 T:4167  a9 55                              lda #"U"
  280 T:4169  20 97 51                           jsr wout
  281 T:416c  ae 33 40                           ldx iecunit
  281 T:416f  e0 0a                              cpx #10
  281 T:4171  90 08                              bcc stl1
  282 T:4173  8a                                 txa 
  282 T:4174  38                                 sec 
  282 T:4175  e9 0a                              sbc #10
  282 T:4177  aa                                 tax 
  282 T:4178  a9 31                              lda #"1"
  282 T:417a  2c                                 .byt $2c
  283 T:417b  a9 20                    stl1      lda #" "
  283 T:417d  20 97 51                           jsr wout
  283 T:4180  8a                                 txa 
  283 T:4181  18                                 clc 
  283 T:4182  69 30                              adc #"0"
  283 T:4184  20 97 51                           jsr wout
  284 T:4187  a9 ac                              lda #<stlt2
  284 T:4189  a0 62                              ldy #>stlt2
  284 T:418b  20 8f 38                           jsr textout
  285 T:418e  18                                 clc 
  285 T:418f  20 1b a0                           jsr sgdrive
  285 T:4192  18                                 clc 
  285 T:4193  69 41                              adc #"A"             ;"a"
  285 T:4195  20 97 51                           jsr wout
  286 T:4198  a9 3a                              lda #":"
  286 T:419a  20 97 51                           jsr wout
  287 T:419d  20 1e a0                           jsr gtpath
  287 T:41a0  85 10                              sta lmzei
  287 T:41a2  84 11                              sty lmzei+1
  288 T:41a4  a0 02                              ldy #2
  289 T:41a6  b1 10                    stl3      lda (lmzei),y
  289 T:41a8  f0 08                              beq stl4
  289 T:41aa  20 97 51                           jsr wout
  289 T:41ad  c8                                 iny 
  289 T:41ae  c0 19                              cpy #stlend
  289 T:41b0  d0 f4                              bne stl3
  290 T:41b2  60                       stl4      rts 
  291 T:41b3                                    ;********

PRA 2.4 .S50

    1 T:41b3                                     .include "WP4 2.4 .S47"

WP4 2.4 .S47


    3 T:41b3                                    ;WP4 2.4 .S47 ==0801==
    4 T:41b3                                    ;****
    5 T:41b3                           mpm41                      ; pc->pc
    6 T:41b3  a9 80                              lda #128
    6 T:41b5  a2 07                              ldx #7
    7 T:41b7  20 d6 49                           jsr mdirpin
    8 T:41ba  d0 05                              bne m41aa
    9 T:41bc  ad 87 40                           lda lanz
    9 T:41bf  d0 01                              bne m41a
    9 T:41c1  60                       m41aa     rts 
   10 T:41c2  18                       m41a      clc 
   10 T:41c3  20 1b a0                           jsr sgdrive
   10 T:41c6  8d 7d 40                           sta olddrv
   11 T:41c9  a9 0c                              lda #12
   11 T:41cb  20 d0 48                           jsr prntcmd
   12 T:41ce  a9 ee                              lda #<cppt1
   12 T:41d0  a0 5e                              ldy #>cppt1
   12 T:41d2  20 be 51                           jsr winput
   12 T:41d5  b0 ea                              bcs m41aa
   13 T:41d7  8a                                 txa 
   13 T:41d8  48                                 pha 
   13 T:41d9  98                                 tya 
   13 T:41da  48                                 pha 
   13 T:41db  20 92 43                           jsr askdisks
   13 T:41de  f0 05                              beq m41xx
   13 T:41e0  a8                                 tay 
   13 T:41e1  68                                 pla 
   13 T:41e2  68                                 pla 
   13 T:41e3  98                                 tya 
   13 T:41e4  60                                 rts 
   14 T:41e5  68                       m41xx     pla 
   14 T:41e6  a8                                 tay 
   14 T:41e7  68                                 pla 
   14 T:41e8  20 33 a0                           jsr chdir
   14 T:41eb  d0 d4                              bne m41aa
   15 T:41ed  18                                 clc 
   15 T:41ee  20 1b a0                           jsr sgdrive
   15 T:41f1  8d 7e 40                           sta newdrv
   16 T:41f4  a9 be                              lda #<liste
   16 T:41f6  85 0e                              sta lzei
   16 T:41f8  a9 42                              lda #>liste
   16 T:41fa  85 0f                              sta lzei+1
   17 T:41fc                                    ;****
   18 T:41fc  a0 10                    m41loop   ldy #16
   18 T:41fe  b1 0e                              lda (lzei),y
   18 T:4200  30 03                              bmi m41a0
   18 T:4202  4c 33 43                           jmp m41next
   19 T:4205  20 b7 4d                 m41a0     jsr lzeibuf
   20 T:4208  ad 7e 40                           lda newdrv
   20 T:420b  38                                 sec 
   20 T:420c  20 1b a0                           jsr sgdrive
   21 T:420f  20 af 51                           jsr wclrcmd
   21 T:4212  a9 00                              lda #<iobuf
   21 T:4214  a0 02                              ldy #>iobuf
   21 T:4216  20 ac 51                           jsr wprntcmd
   22 T:4219  a9 00                    m41a3     lda #<iobuf
   22 T:421b  a0 02                              ldy #>iobuf
   22 T:421d  a2 20                              ldx #$20
   22 T:421f  20 3f a0                           jsr dcreate
   23 T:4222  f0 0d                              beq m41b
   23 T:4224  c9 f3                              cmp #enfexist
   23 T:4226  d0 12                              bne m41a1
   24 T:4228  20 49 43                           jsr gtnname
   24 T:422b  90 ec                              bcc m41a3
   24 T:422d  d0 10                              bne m41a2
   24 T:422f  f0 13                              beq m41b1
   25 T:4231  a9 00                    m41b      lda #<iobuf
   25 T:4233  a0 02                              ldy #>iobuf
   25 T:4235  20 48 a0                           jsr dopen
   26 T:4238  f0 0d                              beq m41c
   26 T:423a  20 2c 4e                 m41a1     jsr error
   26 T:423d  90 05                              bcc m41b1
   26 T:423f  a9 01                    m41a2     lda #1
   26 T:4241  8d 87 40                           sta lanz
   26 T:4244  4c 33 43                 m41b1     jmp m41next
   27 T:4247  86 2c                    m41c      stx newfpb
   27 T:4249  84 2d                              sty newfpb+1
   28 T:424b  a0 2e                              ldy #fphandle
   28 T:424d  b1 2c                              lda (newfpb),y
   28 T:424f  8d 7c 40                           sta newhdl
   29 T:4252                                    ;****
   30 T:4252  ad 7d 40                           lda olddrv
   30 T:4255  38                                 sec 
   30 T:4256  20 1b a0                           jsr sgdrive
   31 T:4259  20 b7 4d                           jsr lzeibuf
   31 T:425c  20 48 a0                           jsr dopen
   32 T:425f  f0 0d                              beq m41d
   32 T:4261  20 2c 4e                           jsr error
   32 T:4264  90 05                              bcc m41b2
   32 T:4266  a9 01                              lda #1
   32 T:4268  8d 87 40                           sta lanz
   32 T:426b  4c 2d 43                 m41b2     jmp m41l
   33 T:426e  86 26                    m41d      stx oldfpb
   33 T:4270  84 27                              sty oldfpb+1
   34 T:4272  a0 2e                              ldy #fphandle
   34 T:4274  b1 26                              lda (oldfpb),y
   34 T:4276  8d 7a 40                           sta oldhdl
   35 T:4279  a0 1a                              ldy #fpsize
   35 T:427b  b1 26                    m41d1     lda (oldfpb),y
   35 T:427d  99 5c 40                           sta oldsize-fpsize,y
   36 T:4280  c8                                 iny 
   36 T:4281  c0 1e                              cpy #fpsize+4
   36 T:4283  d0 f6                              bne m41d1
   37 T:4285                                    ;****
   38 T:4285  a9 0e                    cppl2     lda #prgbank
   38 T:4287  a0 44                              ldy #fpbank
   38 T:4289  91 26                              sta (oldfpb),y
   39 T:428b  a0 3b                              ldy #fpadr
   39 T:428d  a9 00                              lda #<buffer
   39 T:428f  91 26                              sta (oldfpb),y
   40 T:4291  c8                                 iny 
   40 T:4292  a9 6c                              lda #>buffer
   40 T:4294  91 26                              sta (oldfpb),y
   41 T:4296  a0 39                              ldy #fpanz
   41 T:4298  ad 00 40                           lda prblen
   41 T:429b  91 26                              sta (oldfpb),y
   42 T:429d  c8                                 iny 
   42 T:429e  ad 01 40                           lda prblen+1
   42 T:42a1  91 26                              sta (oldfpb),y
   43 T:42a3  ae 7a 40                           ldx oldhdl
   43 T:42a6  20 4e a0                           jsr dread
   43 T:42a9  8d 7b 40                           sta olderr
   44 T:42ac  f0 11                              beq m41e
   44 T:42ae  c9 ec                              cmp #eneof
   44 T:42b0  f0 36                              beq m41f
   45 T:42b2  20 2c 4e                           jsr error
   45 T:42b5  90 05                              bcc m41b3
   45 T:42b7  a9 01                              lda #1
   45 T:42b9  8d 87 40                           sta lanz
   45 T:42bc  4c 27 43                 m41b3     jmp m41i
   46 T:42bf  ad 76 40                 m41e      lda oldsize
   46 T:42c2  38                                 sec 
   46 T:42c3  ed 00 40                           sbc prblen
   46 T:42c6  8d 76 40                           sta oldsize
   47 T:42c9  ad 77 40                           lda oldsize+1
   47 T:42cc  ed 01 40                           sbc prblen+1
   47 T:42cf  8d 77 40                           sta oldsize+1
   48 T:42d2  b0 0b                              bcs m41e1
   48 T:42d4  ad 78 40                           lda oldsize+2
   48 T:42d7  d0 03                              bne m41e2
   49 T:42d9  ce 79 40                           dec oldsize+3
   49 T:42dc  ce 78 40                 m41e2     dec oldsize+2
   50 T:42df  ad 00 40                 m41e1     lda prblen
   50 T:42e2  ae 01 40                           ldx prblen+1
   51 T:42e5  4c ee 42                           jmp m41g
   52 T:42e8  ad 76 40                 m41f      lda oldsize
   52 T:42eb  ae 77 40                           ldx oldsize+1
   53 T:42ee  20 31 50                 m41g      jsr conv
   53 T:42f1  a0 39                              ldy #fpanz
   53 T:42f3  91 2c                              sta (newfpb),y
   54 T:42f5  c8                                 iny 
   54 T:42f6  8a                                 txa 
   54 T:42f7  91 2c                              sta (newfpb),y
   55 T:42f9  a0 3b                              ldy #fpadr
   55 T:42fb  a9 00                              lda #<buffer
   55 T:42fd  91 2c                              sta (newfpb),y
   56 T:42ff  c8                                 iny 
   56 T:4300  a9 6c                              lda #>buffer
   56 T:4302  91 2c                              sta (newfpb),y
   57 T:4304  a0 44                              ldy #fpbank
   57 T:4306  a9 0e                              lda #prgbank
   57 T:4308  91 2c                              sta (newfpb),y
   58 T:430a  ae 7c 40                           ldx newhdl
   58 T:430d  20 51 a0                           jsr dwrite
   59 T:4310  f0 0d                              beq m41h
   60 T:4312  20 2c 4e                           jsr error
   60 T:4315  90 05                              bcc m41b4
   60 T:4317  a9 01                              lda #1
   60 T:4319  8d 87 40                           sta lanz
   60 T:431c  4c 27 43                 m41b4     jmp m41i
   61 T:431f  ad 7b 40                 m41h      lda olderr
   61 T:4322  d0 03                              bne m41i
   61 T:4324  4c 85 42                           jmp cppl2
   62 T:4327                                    ;****
   63 T:4327  ae 7a 40                 m41i      ldx oldhdl
   63 T:432a  20 4b a0                           jsr dclose
   64 T:432d  ae 7c 40                 m41l      ldx newhdl
   64 T:4330  20 4b a0                           jsr dclose
   65 T:4333  a5 0e                    m41next   lda lzei
   65 T:4335  18                                 clc 
   65 T:4336  69 13                              adc #19
   65 T:4338  85 0e                              sta lzei
   66 T:433a  90 02                              bcc m41j
   66 T:433c  e6 0f                              inc lzei+1
   67 T:433e  ce 87 40                 m41j      dec lanz
   67 T:4341  f0 03                              beq m41k
   67 T:4343  4c fc 41                           jmp m41loop
   68 T:4346  a9 00                    m41k      lda #0
   68 T:4348  60                                 rts 
   69 T:4349                                    ;********
   70 T:4349                           gtnname   
   71 T:4349  a9 00                              lda #<iobuf
   71 T:434b  a0 02                              ldy #>iobuf
   71 T:434d  20 b2 51                           jsr wprnterr
   72 T:4350  a9 8f                              lda #<gtnnt3
   72 T:4352  a0 5f                              ldy #>gtnnt3
   72 T:4354  20 8f 38                           jsr textout
   73 T:4357  a9 f5                    gtnname1  lda #<gtnnt
   73 T:4359  a0 5e                              ldy #>gtnnt
   73 T:435b  20 b8 51                           jsr wopenmsg
   74 T:435e  20 9d 51                 gtn1      jsr wgetkey
   74 T:4361  f0 fb                              beq gtn1
   75 T:4363  c9 0d                              cmp #13
   75 T:4365  f0 0f                              beq gtnret
   76 T:4367  c9 3d                              cmp #"="
   76 T:4369  f0 12                              beq gtnnam
   77 T:436b  c9 03                              cmp #3
   77 T:436d  d0 ef                              bne gtn1
   78 T:436f  20 94 51                           jsr wclose
   78 T:4372  a9 ea                    gtn1x     lda #enbreak
   78 T:4374  38                                 sec 
   78 T:4375  60                                 rts 
   79 T:4376  20 94 51                 gtnret    jsr wclose
   79 T:4379  a9 00                              lda #0
   79 T:437b  38                                 sec 
   79 T:437c  60                                 rts 
   80 T:437d  20 94 51                 gtnnam    jsr wclose
   81 T:4380  a9 05                              lda #5
   81 T:4382  20 d0 48                           jsr prntcmd
   82 T:4385  a9 a4                              lda #<isnpt
   82 T:4387  a0 61                              ldy #>isnpt
   82 T:4389  20 be 51                           jsr winput
   82 T:438c  b0 e4                              bcs gtn1x
   83 T:438e  18                                 clc 
   83 T:438f  a9 00                              lda #0
   83 T:4391  60                                 rts 
   84 T:4392                                    ;****
   85 T:4392  a9 4a                    askdisks  lda #<adt
   85 T:4394  a0 5f                              ldy #>adt
   85 T:4396  20 b8 51                           jsr wopenmsg
   86 T:4399  20 9d 51                 adl1      jsr wgetkey
   86 T:439c  f0 fb                              beq adl1
   87 T:439e  c9 0d                              cmp #13
   87 T:43a0  f0 07                              beq adl2
   87 T:43a2  c9 03                              cmp #3
   87 T:43a4  d0 f3                              bne adl1
   88 T:43a6  a9 ea                              lda #enbreak
   88 T:43a8  2c                                 .byt $2c
   89 T:43a9  a9 00                    adl2      lda #0
   89 T:43ab  48                                 pha 
   89 T:43ac  20 94 51                           jsr wclose
   89 T:43af  68                                 pla 
   89 T:43b0  60                                 rts 
   90 T:43b1                                    ;********
   91 T:43b1                           mpm42                      ; pc->cbm
   92 T:43b1  a9 80                              lda #128
   92 T:43b3  a2 07                              ldx #7
   93 T:43b5  20 d6 49                           jsr mdirpin
   94 T:43b8  d0 05                              bne m42aa
   95 T:43ba  ad 87 40                           lda lanz
   95 T:43bd  d0 01                              bne m42a
   95 T:43bf  60                       m42aa     rts 
   96 T:43c0  18                       m42a      clc 
   96 T:43c1  20 1b a0                           jsr sgdrive
   96 T:43c4  8d 7d 40                           sta olddrv
   97 T:43c7  20 92 43                           jsr askdisks
   97 T:43ca  d0 f3                              bne m42aa
   98 T:43cc  a9 be                              lda #<liste
   98 T:43ce  85 0e                              sta lzei
   98 T:43d0  a9 42                              lda #>liste
   98 T:43d2  85 0f                              sta lzei+1
   99 T:43d4  a9 00                              lda #0
   99 T:43d6  20 bd ff                           jsr setfnpar
   99 T:43d9  a9 01                              lda #1
   99 T:43db  ae 33 40                           ldx iecunit
   99 T:43de  a0 0f                              ldy #15
   99 T:43e0  20 ba ff                           jsr setfpar
  100 T:43e3  20 c0 ff                           jsr open
  100 T:43e6  09 40                              ora #64
  100 T:43e8  b0 d5                              bcs m42aa
  101 T:43ea                                    ;****
  102 T:43ea  a0 10                    m42loop   ldy #16
  102 T:43ec  b1 0e                              lda (lzei),y
  102 T:43ee  30 03                              bmi m42a0
  102 T:43f0  4c 3c 45                           jmp m42next
  103 T:43f3  ad 8c 40                 m42a0     lda iecdrive
  103 T:43f6  8d 00 02                           sta iobuf
  103 T:43f9  a9 3a                              lda #":"
  103 T:43fb  8d 01 02                           sta iobuf+1
  104 T:43fe  a0 00                              ldy #0
  104 T:4400  b1 0e                    m42a3     lda (lzei),y
  104 T:4402  99 02 02                           sta iobuf+2,y
  104 T:4405  c8                                 iny 
  104 T:4406  c0 08                              cpy #8
  104 T:4408  d0 f6                              bne m42a3
  105 T:440a  b1 0e                    m42a4     lda (lzei),y
  105 T:440c  99 03 02                           sta iobuf+3,y
  105 T:440f  c8                                 iny 
  105 T:4410  c0 0b                              cpy #11
  105 T:4412  d0 f6                              bne m42a4
  106 T:4414  a9 2e                              lda #"."
  106 T:4416  8d 0a 02                           sta iobuf+2+8
  106 T:4419  a9 00                              lda #0
  106 T:441b  8d 0e 02                           sta iobuf+3+11
  107 T:441e  a9 0e                              lda #14
  107 T:4420  a2 00                    m42newnam ldx #<iobuf
  107 T:4422  a0 02                              ldy #>iobuf
  108 T:4424  20 bd ff                           jsr setfnpar
  108 T:4427  a9 02                              lda #2
  108 T:4429  ae 33 40                           ldx iecunit
  108 T:442c  a0 01                              ldy #1
  108 T:442e  20 ba ff                           jsr setfpar
  109 T:4431  20 af 51                           jsr wclrcmd
  109 T:4434  a9 00                              lda #<iobuf
  109 T:4436  a0 02                              ldy #>iobuf
  109 T:4438  20 ac 51                           jsr wprntcmd
  110 T:443b  20 c0 ff                           jsr open
  110 T:443e  09 40                              ora #64
  110 T:4440  b0 45                              bcs m42c
  111 T:4442  20 b1 3c                           jsr m34b
  111 T:4445  f0 31                              beq m42cc
  111 T:4447  a9 02                              lda #2
  111 T:4449  20 c3 ff                           jsr close
  112 T:444c  ad 00 02                           lda iobuf
  112 T:444f  c9 36                              cmp #"6"
  112 T:4451  d0 07                              bne m42xa
  112 T:4453  ad 01 02                           lda iobuf+1
  112 T:4456  c9 33                              cmp #"3"
  112 T:4458  f0 08                              beq m42xb
  113 T:445a  20 39 4e                 m42xa     jsr errorq
  113 T:445d  b0 0a                              bcs m42xkk
  113 T:445f  4c 3c 45                 m42ce     jmp m42next
  114 T:4462  20 57 43                 m42xb     jsr gtnname1
  114 T:4465  90 05                              bcc m42cd
  115 T:4467  f0 f6                              beq m42ce
  115 T:4469  4c 51 45                 m42xkk    jmp m42kk
  116 T:446c  a0 ff                    m42cd     ldy #<-1
  116 T:446e  c8                       m42cf     iny 
  116 T:446f  b9 00 02                           lda iobuf,y
  116 T:4472  d0 fa                              bne m42cf
  117 T:4474  98                                 tya 
  117 T:4475  4c 20 44                           jmp m42newnam
  118 T:4478                                    ;****
  119 T:4478  ad 7d 40                 m42cc     lda olddrv
  119 T:447b  38                                 sec 
  119 T:447c  20 1b a0                           jsr sgdrive
  120 T:447f  20 b7 4d                           jsr lzeibuf
  120 T:4482  20 48 a0                           jsr dopen
  121 T:4485  f0 0d                              beq m42d
  121 T:4487  20 2c 4e                 m42c      jsr error
  121 T:448a  90 05                              bcc m42b2
  121 T:448c  a9 01                              lda #1
  121 T:448e  8d 87 40                           sta lanz
  121 T:4491  4c 37 45                 m42b2     jmp m42l
  122 T:4494  86 26                    m42d      stx oldfpb
  122 T:4496  84 27                              sty oldfpb+1
  123 T:4498  a0 2e                              ldy #fphandle
  123 T:449a  b1 26                              lda (oldfpb),y
  123 T:449c  8d 7a 40                           sta oldhdl
  124 T:449f  a0 1a                              ldy #fpsize
  124 T:44a1  b1 26                    m42d1     lda (oldfpb),y
  124 T:44a3  99 5c 40                           sta oldsize-fpsize,y
  125 T:44a6  c8                                 iny 
  125 T:44a7  c0 1e                              cpy #fpsize+4
  125 T:44a9  d0 f6                              bne m42d1
  126 T:44ab                                    ;****
  127 T:44ab  a9 0e                    cpcl2     lda #prgbank
  127 T:44ad  a0 44                              ldy #fpbank
  127 T:44af  91 26                              sta (oldfpb),y
  128 T:44b1  a0 3b                              ldy #fpadr
  128 T:44b3  a9 00                              lda #<buffer
  128 T:44b5  91 26                              sta (oldfpb),y
  129 T:44b7  c8                                 iny 
  129 T:44b8  a9 6c                              lda #>buffer
  129 T:44ba  91 26                              sta (oldfpb),y
  130 T:44bc  a0 39                              ldy #fpanz
  130 T:44be  ad 00 40                           lda prblen
  130 T:44c1  91 26                              sta (oldfpb),y
  131 T:44c3  c8                                 iny 
  131 T:44c4  ad 01 40                           lda prblen+1
  131 T:44c7  91 26                              sta (oldfpb),y
  132 T:44c9  ae 7a 40                           ldx oldhdl
  132 T:44cc  20 4e a0                           jsr dread
  132 T:44cf  8d 7b 40                           sta olderr
  133 T:44d2  f0 11                              beq m42e
  133 T:44d4  c9 ec                              cmp #eneof
  133 T:44d6  f0 36                              beq m42f
  134 T:44d8  20 2c 4e                           jsr error
  134 T:44db  90 05                              bcc m42b3
  134 T:44dd  a9 01                              lda #1
  134 T:44df  8d 87 40                           sta lanz
  134 T:44e2  4c 31 45                 m42b3     jmp m42i
  135 T:44e5  ad 76 40                 m42e      lda oldsize
  135 T:44e8  38                                 sec 
  135 T:44e9  ed 00 40                           sbc prblen
  135 T:44ec  8d 76 40                           sta oldsize
  136 T:44ef  ad 77 40                           lda oldsize+1
  136 T:44f2  ed 01 40                           sbc prblen+1
  136 T:44f5  8d 77 40                           sta oldsize+1
  137 T:44f8  b0 0b                              bcs m42e1
  137 T:44fa  ad 78 40                           lda oldsize+2
  137 T:44fd  d0 03                              bne m42e2
  138 T:44ff  ce 79 40                           dec oldsize+3
  138 T:4502  ce 78 40                 m42e2     dec oldsize+2
  139 T:4505  ad 00 40                 m42e1     lda prblen
  139 T:4508  ae 01 40                           ldx prblen+1
  140 T:450b  4c 14 45                           jmp m42g
  141 T:450e  ad 76 40                 m42f      lda oldsize
  141 T:4511  ae 77 40                           ldx oldsize+1
  142 T:4514  20 31 50                 m42g      jsr conv
  142 T:4517  20 59 45                           jsr cwrite
  143 T:451a  f0 0d                              beq m42h
  144 T:451c  20 2c 4e                           jsr error
  144 T:451f  90 05                              bcc m42b4
  144 T:4521  a9 01                              lda #1
  144 T:4523  8d 87 40                           sta lanz
  144 T:4526  4c 31 45                 m42b4     jmp m42i
  145 T:4529  ad 7b 40                 m42h      lda olderr
  145 T:452c  d0 03                              bne m42i
  145 T:452e  4c ab 44                           jmp cpcl2
  146 T:4531                                    ;****
  147 T:4531  ae 7a 40                 m42i      ldx oldhdl
  147 T:4534  20 4b a0                           jsr dclose
  148 T:4537  a9 02                    m42l      lda #2
  148 T:4539  20 c3 ff                           jsr close
  149 T:453c  a5 0e                    m42next   lda lzei
  149 T:453e  18                                 clc 
  149 T:453f  69 13                              adc #19
  149 T:4541  85 0e                              sta lzei
  150 T:4543  90 02                              bcc m42j
  150 T:4545  e6 0f                              inc lzei+1
  151 T:4547  ce 87 40                 m42j      dec lanz
  151 T:454a  f0 03                              beq m42k
  151 T:454c  4c ea 43                           jmp m42loop
  152 T:454f  a9 00                    m42k      lda #0
  152 T:4551  48                       m42kk     pha 
  152 T:4552  a9 01                              lda #1
  152 T:4554  20 c3 ff                           jsr close
  152 T:4557  68                                 pla 
  152 T:4558  60                                 rts 
  153 T:4559                                    ;****
  154 T:4559  8d 7f 40                 cwrite    sta ccnt
  154 T:455c  8e 80 40                           stx ccnt+1
  155 T:455f  a9 00                              lda #<buffer
  155 T:4561  85 2c                              sta newfpb
  155 T:4563  a9 6c                              lda #>buffer
  155 T:4565  85 2d                              sta newfpb+1
  156 T:4567  a2 02                              ldx #2
  156 T:4569  20 c9 ff                           jsr ckout
  156 T:456c  09 40                              ora #64
  156 T:456e  b0 24                              bcs cwre
  157 T:4570  a0 00                              ldy #0
  158 T:4572  b1 2c                    cwrl      lda (newfpb),y
  158 T:4574  20 d2 ff                           jsr bsout
  159 T:4577  e6 2c                              inc newfpb
  159 T:4579  d0 02                              bne cwr1
  159 T:457b  e6 2d                              inc newfpb+1
  160 T:457d  ad 7f 40                 cwr1      lda ccnt
  160 T:4580  d0 03                              bne cwr2
  161 T:4582  ce 80 40                           dec ccnt+1
  161 T:4585  ce 7f 40                 cwr2      dec ccnt
  162 T:4588  ad 7f 40                           lda ccnt
  162 T:458b  d0 e5                              bne cwrl
  162 T:458d  0d 80 40                           ora ccnt+1
  162 T:4590  d0 e0                              bne cwrl
  163 T:4592  a9 00                              lda #0
  163 T:4594  48                       cwre      pha 
  163 T:4595  20 cc ff                           jsr clrch
  163 T:4598  68                                 pla 
  163 T:4599  60                                 rts 
  164 T:459a                                    ;********
  165 T:459a                           mpm43                      ; cbm->pc
  166 T:459a  20 36 3d                           jsr gtcbmdir
  166 T:459d  f0 01                              beq m43x1
  166 T:459f  60                       m43x2     rts 
  167 T:45a0  a9 00                    m43x1     lda #<iobuf
  167 T:45a2  a0 02                              ldy #>iobuf
  167 T:45a4  20 b2 51                           jsr wprnterr
  168 T:45a7  a9 07                              lda #7
  168 T:45a9  20 d0 48                           jsr prntcmd
  169 T:45ac  ad 87 40                           lda lanz
  169 T:45af  f0 ee                              beq m43x2
  170 T:45b1  a9 80                              lda #128
  170 T:45b3  20 64 3f                           jsr mpdirin
  170 T:45b6  d0 e7                              bne m43x2
  171 T:45b8  a9 0c                              lda #12
  171 T:45ba  20 d0 48                           jsr prntcmd
  172 T:45bd  a9 ee                              lda #<cppt1
  172 T:45bf  a0 5e                              ldy #>cppt1
  172 T:45c1  20 be 51                           jsr winput
  172 T:45c4  b0 d9                              bcs m43x2
  173 T:45c6  8a                                 txa 
  173 T:45c7  48                                 pha 
  173 T:45c8  98                                 tya 
  173 T:45c9  48                                 pha 
  173 T:45ca  20 92 43                           jsr askdisks
  173 T:45cd  f0 05                              beq m43xx
  173 T:45cf  a8                                 tay 
  173 T:45d0  68                                 pla 
  173 T:45d1  68                                 pla 
  173 T:45d2  98                                 tya 
  173 T:45d3  60                                 rts 
  174 T:45d4  68                       m43xx     pla 
  174 T:45d5  a8                                 tay 
  174 T:45d6  68                                 pla 
  175 T:45d7  20 33 a0                           jsr chdir
  175 T:45da  d0 c3                              bne m43x2
  176 T:45dc  18                                 clc 
  176 T:45dd  20 1b a0                           jsr sgdrive
  176 T:45e0  8d 7e 40                           sta newdrv
  177 T:45e3  a9 be                              lda #<liste
  177 T:45e5  85 0e                              sta lzei
  177 T:45e7  a9 42                              lda #>liste
  177 T:45e9  85 0f                              sta lzei+1
  178 T:45eb                                    ;****
  179 T:45eb  a0 12                    m43loop   ldy #18
  179 T:45ed  b1 0e                              lda (lzei),y
  179 T:45ef  30 03                              bmi m43a0
  179 T:45f1  4c c8 46                           jmp m43next
  180 T:45f4  20 13 47                 m43a0     jsr lcpzeibuf
  180 T:45f7  ad 7e 40                           lda newdrv
  180 T:45fa  38                                 sec 
  180 T:45fb  20 1b a0                           jsr sgdrive
  181 T:45fe  20 af 51                           jsr wclrcmd
  181 T:4601  a9 00                              lda #<iobuf
  181 T:4603  a0 02                              ldy #>iobuf
  181 T:4605  20 ac 51                           jsr wprntcmd
  182 T:4608  a9 00                    m43a3     lda #<iobuf
  182 T:460a  a0 02                              ldy #>iobuf
  182 T:460c  a2 20                              ldx #$20
  182 T:460e  20 3f a0                           jsr dcreate
  183 T:4611  f0 0d                              beq m43b
  183 T:4613  c9 f3                              cmp #enfexist
  183 T:4615  d0 12                              bne m43a1
  184 T:4617  20 49 43                           jsr gtnname
  184 T:461a  90 ec                              bcc m43a3
  184 T:461c  d0 10                              bne m43a2
  184 T:461e  f0 13                              beq m43b1
  185 T:4620  a9 00                    m43b      lda #<iobuf
  185 T:4622  a0 02                              ldy #>iobuf
  185 T:4624  20 48 a0                           jsr dopen
  186 T:4627  f0 0d                              beq m43c
  186 T:4629  20 2c 4e                 m43a1     jsr error
  186 T:462c  90 05                              bcc m43b1
  186 T:462e  a9 01                    m43a2     lda #1
  186 T:4630  8d 87 40                           sta lanz
  186 T:4633  4c c8 46                 m43b1     jmp m43next
  187 T:4636  86 2c                    m43c      stx newfpb
  187 T:4638  84 2d                              sty newfpb+1
  188 T:463a  a0 2e                              ldy #fphandle
  188 T:463c  b1 2c                              lda (newfpb),y
  188 T:463e  8d 7c 40                           sta newhdl
  189 T:4641                                    ;****
  190 T:4641  20 de 46                           jsr lczeibuf
  190 T:4644  20 bd ff                           jsr setfnpar
  191 T:4647  a9 02                              lda #2
  191 T:4649  ae 33 40                           ldx iecunit
  191 T:464c  a0 00                              ldy #0
  191 T:464e  20 ba ff                           jsr setfpar
  192 T:4651  20 c0 ff                           jsr open
  192 T:4654  09 40                              ora #64
  192 T:4656  90 0d                              bcc m43d
  193 T:4658  20 2c 4e                           jsr error
  193 T:465b  90 05                              bcc m43b2
  193 T:465d  a9 01                              lda #1
  193 T:465f  8d 87 40                           sta lanz
  193 T:4662  4c c2 46                 m43b2     jmp m43l
  194 T:4665  20 b1 3c                 m43d      jsr m34b
  194 T:4668  f0 00                              beq ccpl2
  195 T:466a                                    ;****
  196 T:466a                           ccpl2     
  197 T:466a  20 37 47                           jsr cread
  197 T:466d  8d 7b 40                           sta olderr
  198 T:4670  f0 11                              beq m43f
  198 T:4672  c9 ec                              cmp #eneof
  198 T:4674  f0 0d                              beq m43f
  199 T:4676  20 2c 4e                           jsr error
  199 T:4679  90 05                              bcc m43b3
  199 T:467b  a9 01                              lda #1
  199 T:467d  8d 87 40                           sta lanz
  199 T:4680  4c bd 46                 m43b3     jmp m43i
  200 T:4683  98                       m43f      tya 
  201 T:4684  20 31 50                 m43g      jsr conv
  201 T:4687  a0 3a                              ldy #fpanz+1
  201 T:4689  91 2c                              sta (newfpb),y
  202 T:468b  88                                 dey 
  202 T:468c  8a                                 txa 
  202 T:468d  91 2c                              sta (newfpb),y
  203 T:468f  a0 3b                              ldy #fpadr
  203 T:4691  a9 00                              lda #<buffer
  203 T:4693  91 2c                              sta (newfpb),y
  204 T:4695  c8                                 iny 
  204 T:4696  a9 6c                              lda #>buffer
  204 T:4698  91 2c                              sta (newfpb),y
  205 T:469a  a0 44                              ldy #fpbank
  205 T:469c  a9 0e                              lda #prgbank
  205 T:469e  91 2c                              sta (newfpb),y
  206 T:46a0  ae 7c 40                           ldx newhdl
  206 T:46a3  20 51 a0                           jsr dwrite
  207 T:46a6  f0 0d                              beq m43h
  208 T:46a8  20 2c 4e                           jsr error
  208 T:46ab  90 05                              bcc m43b4
  208 T:46ad  a9 01                              lda #1
  208 T:46af  8d 87 40                           sta lanz
  208 T:46b2  4c bd 46                 m43b4     jmp m43i
  209 T:46b5  ad 7b 40                 m43h      lda olderr
  209 T:46b8  d0 03                              bne m43i
  209 T:46ba  4c 6a 46                           jmp ccpl2
  210 T:46bd                                    ;****
  211 T:46bd  a9 02                    m43i      lda #2
  211 T:46bf  20 c3 ff                           jsr close
  212 T:46c2  ae 7c 40                 m43l      ldx newhdl
  212 T:46c5  20 4b a0                           jsr dclose
  213 T:46c8  a5 0e                    m43next   lda lzei
  213 T:46ca  18                                 clc 
  213 T:46cb  69 14                              adc #20
  213 T:46cd  85 0e                              sta lzei
  214 T:46cf  90 02                              bcc m43j
  214 T:46d1  e6 0f                              inc lzei+1
  215 T:46d3  ce 87 40                 m43j      dec lanz
  215 T:46d6  f0 03                              beq m43k
  215 T:46d8  4c eb 45                           jmp m43loop
  216 T:46db  a9 00                    m43k      lda #0
  216 T:46dd  60                                 rts 
  217 T:46de                                    ;****
  218 T:46de  ad 8c 40                 lczeibuf  lda iecdrive
  218 T:46e1  8d 00 02                           sta iobuf
  218 T:46e4  a9 3a                              lda #":"
  218 T:46e6  8d 01 02                           sta iobuf+1
  219 T:46e9  a0 02                              ldy #2
  219 T:46eb  a2 02                              ldx #2
  220 T:46ed  b1 0e                    lczei1    lda (lzei),y
  220 T:46ef  9d 00 02                           sta iobuf,x
  220 T:46f2  f0 06                              beq lczei2
  221 T:46f4  e8                                 inx 
  221 T:46f5  c8                                 iny 
  221 T:46f6  c0 12                              cpy #18
  221 T:46f8  d0 f3                              bne lczei1
  222 T:46fa  a9 2c                    lczei2    lda #","
  222 T:46fc  9d 00 02                           sta iobuf,x
  222 T:46ff  e8                                 inx 
  222 T:4700  a0 13                              ldy #19
  222 T:4702  b1 0e                              lda (lzei),y
  222 T:4704  9d 00 02                           sta iobuf,x
  222 T:4707  e8                                 inx 
  223 T:4708  a9 00                              lda #0
  223 T:470a  9d 00 02                           sta iobuf,x
  224 T:470d  8a                                 txa 
  224 T:470e  a2 00                              ldx #<iobuf
  224 T:4710  a0 02                              ldy #>iobuf
  224 T:4712  60                                 rts 
  225 T:4713                                    ;****
  226 T:4713  a0 02                    lcpzeibuf ldy #2
  227 T:4715  b1 0e                    lcpz1     lda (lzei),y
  227 T:4717  c9 2e                              cmp #"."
  227 T:4719  d0 02                              bne lcpz1a
  227 T:471b  a9 5f                              lda #"_"
  228 T:471d  99 fe 01                 lcpz1a    sta iobuf-2,y
  228 T:4720  f0 0a                              beq lcpze
  228 T:4722  c8                                 iny 
  228 T:4723  c0 0e                              cpy #14
  228 T:4725  d0 ee                              bne lcpz1
  229 T:4727  a9 00                              lda #0
  229 T:4729  99 fe 01                           sta iobuf-2,y
  230 T:472c  ad 08 02                 lcpze     lda iobuf+8
  230 T:472f  f0 05                              beq lcpze1
  230 T:4731  a9 2e                              lda #"."
  230 T:4733  8d 08 02                           sta iobuf+8
  230 T:4736  60                       lcpze1    rts 
  231 T:4737                                    ;****
  232 T:4737  a2 02                    cread     ldx #2
  232 T:4739  20 c6 ff                           jsr chkin
  232 T:473c  09 40                              ora #64
  232 T:473e  b0 40                              bcs crde
  233 T:4740  a9 00                              lda #0
  233 T:4742  85 90                              sta status
  233 T:4744  8d 7f 40                           sta ccnt
  233 T:4747  8d 80 40                           sta ccnt+1
  234 T:474a  a9 00                              lda #<buffer
  234 T:474c  85 26                              sta oldfpb
  234 T:474e  a9 6c                              lda #>buffer
  234 T:4750  85 27                              sta oldfpb+1
  235 T:4752  20 cf ff                 crdl1     jsr basin
  235 T:4755  a0 00                              ldy #0
  235 T:4757  91 26                              sta (oldfpb),y
  236 T:4759  e6 26                              inc oldfpb
  236 T:475b  d0 02                              bne crdl2
  236 T:475d  e6 27                              inc oldfpb+1
  237 T:475f  ee 7f 40                 crdl2     inc ccnt
  237 T:4762  d0 03                              bne crdl2a
  237 T:4764  ee 80 40                           inc ccnt+1
  238 T:4767  20 e1 48                 crdl2a    jsr tststat
  238 T:476a  d0 14                              bne crde
  239 T:476c  ad 80 40                           lda ccnt+1
  239 T:476f  cd 01 40                           cmp prblen+1
  239 T:4772  90 de                              bcc crdl1
  240 T:4774  d0 08                              bne crdl3
  241 T:4776  ad 7f 40                           lda ccnt
  241 T:4779  cd 00 40                           cmp prblen
  241 T:477c  90 d4                              bcc crdl1
  242 T:477e  a9 00                    crdl3     lda #0
  243 T:4780  48                       crde      pha 
  243 T:4781  20 cc ff                           jsr clrch
  244 T:4784  a5 26                              lda oldfpb
  244 T:4786  38                                 sec 
  244 T:4787  e9 00                              sbc #<buffer
  244 T:4789  aa                                 tax 
  245 T:478a  a5 27                              lda oldfpb+1
  245 T:478c  e9 6c                              sbc #>buffer
  245 T:478e  a8                                 tay 
  245 T:478f  68                                 pla 
  245 T:4790  60                                 rts 
  246 T:4791                                    ;********
  247 T:4791  20 79 51                 mpmprint  jsr mprton
  248 T:4794  a9 40                    mpmread   lda #64
  248 T:4796  a2 06                              ldx #6
  248 T:4798  20 d6 49                           jsr mdirpin
  249 T:479b  f0 01                              beq mrd1
  249 T:479d  60                       mrd2      rts 
  250 T:479e  ad 87 40                 mrd1      lda lanz
  250 T:47a1  f0 fa                              beq mrd2
  250 T:47a3  20 b7 4d                           jsr lzeibuf
  250 T:47a6  20 48 a0                           jsr dopen
  250 T:47a9  d0 f2                              bne mrd2
  251 T:47ab  86 26                              stx oldfpb
  251 T:47ad  84 27                              sty oldfpb+1
  252 T:47af  a0 2e                              ldy #fphandle
  252 T:47b1  b1 26                              lda (oldfpb),y
  252 T:47b3  8d 7a 40                           sta oldhdl
  253 T:47b6  a0 1a                              ldy #fpsize
  253 T:47b8  b1 26                    m4rd1     lda (oldfpb),y
  253 T:47ba  99 5c 40                           sta oldsize-fpsize,y
  254 T:47bd  c8                                 iny 
  254 T:47be  c0 1e                              cpy #fpsize+4
  254 T:47c0  d0 f6                              bne m4rd1
  255 T:47c2  a2 03                              ldx #3
  255 T:47c4  a0 00                              ldy #0
  255 T:47c6  18                                 clc 
  255 T:47c7  20 9a 51                           jsr wcursor
  256 T:47ca  a2 12                              ldx #18
  256 T:47cc  a9 27                              lda #39
  256 T:47ce  20 91 51                           jsr wopen
  257 T:47d1  a9 93                              lda #19+128       ;"{clr}"
  257 T:47d3  8d 7c 40                           sta newhdl
  257 T:47d6  20 04 52                           jsr wclr
  258 T:47d9                           mrdl      
  259 T:47d9  a9 0e                              lda #prgbank
  259 T:47db  a0 44                              ldy #fpbank
  259 T:47dd  91 26                              sta (oldfpb),y
  260 T:47df  a0 3b                              ldy #fpadr
  260 T:47e1  a9 00                              lda #<buffer
  260 T:47e3  91 26                              sta (oldfpb),y
  261 T:47e5  c8                                 iny 
  261 T:47e6  a9 6c                              lda #>buffer
  261 T:47e8  91 26                              sta (oldfpb),y
  262 T:47ea  a0 39                              ldy #fpanz
  262 T:47ec  ad 00 40                           lda prblen
  262 T:47ef  91 26                              sta (oldfpb),y
  263 T:47f1  c8                                 iny 
  263 T:47f2  ad 01 40                           lda prblen+1
  263 T:47f5  91 26                              sta (oldfpb),y
  264 T:47f7  ae 7a 40                           ldx oldhdl
  264 T:47fa  20 4e a0                           jsr dread
  264 T:47fd  8d 7b 40                           sta olderr
  265 T:4800  f0 07                              beq m4re
  265 T:4802  c9 ec                              cmp #eneof
  265 T:4804  f0 2c                              beq m4rf
  266 T:4806  4c 47 48                           jmp m4rxe
  267 T:4809  ad 76 40                 m4re      lda oldsize
  267 T:480c  38                                 sec 
  267 T:480d  ed 00 40                           sbc prblen
  267 T:4810  8d 76 40                           sta oldsize
  268 T:4813  ad 77 40                           lda oldsize+1
  268 T:4816  ed 01 40                           sbc prblen+1
  268 T:4819  8d 77 40                           sta oldsize+1
  269 T:481c  b0 0b                              bcs m4re1
  269 T:481e  ad 78 40                           lda oldsize+2
  269 T:4821  d0 03                              bne m4re2
  270 T:4823  ce 79 40                           dec oldsize+3
  270 T:4826  ce 78 40                 m4re2     dec oldsize+2
  271 T:4829  ad 00 40                 m4re1     lda prblen
  271 T:482c  ae 01 40                           ldx prblen+1
  272 T:482f  4c 38 48                           jmp m4rg
  273 T:4832  ad 76 40                 m4rf      lda oldsize
  273 T:4835  ae 77 40                           ldx oldsize+1
  274 T:4838  20 5b 48                 m4rg      jsr cprint
  274 T:483b  d0 0a                              bne m4rxe
  275 T:483d  ad 7b 40                 m4rh      lda olderr
  275 T:4840  d0 03                              bne m4ri
  275 T:4842  4c d9 47                           jmp mrdl
  276 T:4845  a9 00                    m4ri      lda #0
  276 T:4847  48                       m4rxe     pha 
  277 T:4848  20 9d 51                 cprl5     jsr wgetkey
  277 T:484b  f0 fb                              beq cprl5
  278 T:484d  20 82 51                           jsr mprtoff
  278 T:4850  ae 7a 40                           ldx oldhdl
  278 T:4853  20 4b a0                           jsr dclose
  278 T:4856  20 94 51                           jsr wclose
  278 T:4859  68                                 pla 
  278 T:485a  60                                 rts 
  279 T:485b                                    ;****
  280 T:485b  8d 7f 40                 cprint    sta ccnt
  280 T:485e  8e 80 40                           stx ccnt+1
  281 T:4861  a9 00                              lda #<buffer
  281 T:4863  85 2c                              sta newfpb
  281 T:4865  a9 6c                              lda #>buffer
  281 T:4867  85 2d                              sta newfpb+1
  282 T:4869  20 32 3a                           jsr prttst
  282 T:486c  d0 44                              bne cprx
  283 T:486e  a0 00                    cprl1     ldy #0
  283 T:4870  b1 2c                              lda (newfpb),y
  284 T:4872  c9 13                              cmp #19             ;"{home}"
  284 T:4874  d0 05                              bne cprl2
  285 T:4876  cd 7c 40                           cmp newhdl
  285 T:4879  f0 0b                              beq cprla
  286 T:487b  20 b8 48                 cprl2     jsr chartest
  286 T:487e  8d 7c 40                           sta newhdl
  286 T:4881  20 b1 a0                           jsr chout
  286 T:4884  b0 2c                              bcs cprx
  287 T:4886  e6 2c                    cprla     inc newfpb
  287 T:4888  d0 02                              bne cprl3
  287 T:488a  e6 2d                              inc newfpb+1
  288 T:488c  ad 7f 40                 cprl3     lda ccnt
  288 T:488f  d0 03                              bne cprl4
  289 T:4891  ce 80 40                           dec ccnt+1
  289 T:4894  ce 7f 40                 cprl4     dec ccnt
  290 T:4897  20 9d 51                           jsr wgetkey
  290 T:489a  f0 09                              beq cprl6
  290 T:489c  c9 03                              cmp #3
  290 T:489e  f0 10                              beq cprbrk
  290 T:48a0  20 9d 51                 cprl7     jsr wgetkey
  290 T:48a3  f0 fb                              beq cprl7
  291 T:48a5  ad 7f 40                 cprl6     lda ccnt
  291 T:48a8  0d 80 40                           ora ccnt+1
  291 T:48ab  d0 c1                              bne cprl1
  292 T:48ad  a9 00                              lda #0
  292 T:48af  2c                                 .byt $2c
  292 T:48b0  a9 ea                    cprbrk    lda #enbreak
  292 T:48b2  48                       cprx      pha 
  292 T:48b3  20 49 3a                           jsr prtoff
  292 T:48b6  68                                 pla 
  292 T:48b7  60                                 rts 
  293 T:48b8                                    ;****
  294 T:48b8  aa                       chartest  tax 
  294 T:48b9  29 7f                              and #127
  294 T:48bb  c9 20                              cmp #32
  294 T:48bd  b0 0e                              bcs chatok
  295 T:48bf  a0 07                              ldy #anztkey-1
  295 T:48c1  8a                                 txa 
  296 T:48c2  d9 87 5f                 chat1     cmp chtkeys,y
  296 T:48c5  f0 06                              beq chatok
  296 T:48c7  88                                 dey 
  296 T:48c8  10 f8                              bpl chat1
  297 T:48ca  a9 40                              lda #"@"
  297 T:48cc  60                                 rts 
  298 T:48cd  18                       chatok    clc 
  298 T:48ce  8a                                 txa 
  298 T:48cf  60                                 rts 
  299 T:48d0                                    ;********
  300 T:48d0  48                       prntcmd   pha 
  300 T:48d1  20 af 51                           jsr wclrcmd
  300 T:48d4  68                                 pla 
  301 T:48d5  0a                                 asl 
  301 T:48d6  aa                                 tax 
  302 T:48d7  bd 9f 5f                           lda ptta-1,x
  302 T:48da  a8                                 tay 
  302 T:48db  bd 9e 5f                           lda ptta-2,x
  302 T:48de  4c ac 51                           jmp wprntcmd
  303 T:48e1                                    ;********
  304 T:48e1  a5 90                    tststat   lda status
  304 T:48e3  f0 09                              beq tst2
  305 T:48e5  29 bf                              and #$bf
  305 T:48e7  d0 03                              bne tst1
  306 T:48e9  a9 ec                              lda #eneof
  306 T:48eb  2c                                 .byt $2c
  307 T:48ec  a9 5d                    tst1      lda #29+64
  307 T:48ee  c9 00                    tst2      cmp #0
  307 T:48f0  60                                 rts 
  308 T:48f1                                    ;********
  309 T:48f1  20 79 51                 mpcprint  jsr mprton
  310 T:48f4                           mpcread   
  311 T:48f4  20 36 3d                           jsr gtcbmdir
  311 T:48f7  f0 01                              beq mcr1
  311 T:48f9  60                       mcrr      rts 
  311 T:48fa                           mcr1      
  312 T:48fa  a9 00                              lda #<iobuf
  312 T:48fc  a0 02                              ldy #>iobuf
  312 T:48fe  20 b2 51                           jsr wprnterr
  313 T:4901  a9 0f                              lda #15
  313 T:4903  20 d0 48                           jsr prntcmd
  314 T:4906  ad 87 40                           lda lanz
  314 T:4909  f0 ee                              beq mcrr
  315 T:490b  a9 c0                              lda #128+64
  315 T:490d  20 64 3f                           jsr mpdirin
  315 T:4910  d0 e7                              bne mcrr
  316 T:4912  20 de 46                           jsr lczeibuf
  317 T:4915  20 bd ff                           jsr setfnpar
  317 T:4918  a9 02                              lda #2
  317 T:491a  ae 33 40                           ldx iecunit
  317 T:491d  a0 00                              ldy #0
  317 T:491f  20 ba ff                           jsr setfpar
  318 T:4922  a2 03                              ldx #3
  318 T:4924  a0 00                              ldy #0
  318 T:4926  20 9a 51                           jsr wcursor
  319 T:4929  a2 12                              ldx #18
  319 T:492b  a9 27                              lda #39
  319 T:492d  20 91 51                           jsr wopen
  320 T:4930  a9 93                              lda #19+128       ;"{clr}"
  320 T:4932  8d 7c 40                           sta newhdl
  320 T:4935  20 04 52                           jsr wclr
  321 T:4938  20 c0 ff                           jsr open
  321 T:493b  09 40                              ora #64
  321 T:493d  b0 1d                              bcs mcrx
  322 T:493f  20 37 47                 mcrl      jsr cread
  322 T:4942  8d 7b 40                           sta olderr
  322 T:4945  f0 04                              beq mcr2
  322 T:4947  c9 ec                              cmp #eneof
  323 T:4949  d0 11                              bne mcrx
  323 T:494b                           mcr2      
  324 T:494b  8a                                 txa 
  324 T:494c  48                                 pha 
  324 T:494d  98                                 tya 
  324 T:494e  aa                                 tax 
  324 T:494f  68                                 pla 
  324 T:4950  20 5b 48                           jsr cprint
  324 T:4953  d0 07                              bne mcrx
  325 T:4955  ad 7b 40                           lda olderr
  325 T:4958  f0 e5                              beq mcrl
  326 T:495a  a9 00                              lda #0
  326 T:495c  48                       mcrx      pha 
  326 T:495d  a9 02                              lda #2
  326 T:495f  20 c3 ff                           jsr close
  327 T:4962  20 9d 51                 mcry      jsr wgetkey
  327 T:4965  f0 fb                              beq mcry
  328 T:4967  20 82 51                           jsr mprtoff
  328 T:496a  20 94 51                           jsr wclose
  328 T:496d  68                                 pla 
  329 T:496e  60                                 rts 

PRA 2.4 .S50

    1 T:496f                                     .include "WPU 2.0 .S3 "

WPU 2.0 .S3 


    3 T:496f                                    ;WPU 2.0 .S3  ==0801==

   20 T:496f                                    ;******** int1 * a,x = a,x
   21 T:496f  8d 43 40                 mult      sta int2
   22 T:4972  a9 00                              lda #0
   22 T:4974  8d 45 40                           sta int3
   22 T:4977  8d 46 40                           sta int3+1
   23 T:497a  8a                       mul1      txa 
   23 T:497b  4a                                 lsr 
   23 T:497c  aa                                 tax 
   23 T:497d  6e 43 40                           ror int2
   23 T:4980  0d 43 40                           ora int2
   23 T:4983  b0 04                              bcs mul2
   23 T:4985  f0 1e                              beq multe
   24 T:4987  90 13                              bcc mul3
   25 T:4989  ad 45 40                 mul2      lda int3
   25 T:498c  18                                 clc 
   25 T:498d  6d 41 40                           adc int1
   25 T:4990  8d 45 40                           sta int3
   25 T:4993  ad 46 40                           lda int3+1
   25 T:4996  6d 42 40                           adc int1+1
   25 T:4999  8d 46 40                           sta int3+1
   26 T:499c  0e 41 40                 mul3      asl int1
   26 T:499f  2e 42 40                           rol int1+1
   26 T:49a2  4c 7a 49                           jmp mul1
   27 T:49a5  ad 45 40                 multe     lda int3
   27 T:49a8  ae 46 40                           ldx int3+1
   28 T:49ab  8d 41 40                           sta int1
   28 T:49ae  8e 42 40                           stx int1+1
   28 T:49b1  60                                 rts 

PRA 2.4 .S50

    1 T:49b2                                     .include "WP2 2.1 .S60"

WP2 2.1 .S60


    3 T:49b2                                    ;WP2 2.1 .S60 ==0801==

    6 T:49b2                           mpm22                      ; pcdrive
    6 T:49b2  a9 03                              lda #3
    6 T:49b4  20 d0 48                           jsr prntcmd
    7 T:49b7  a2 00                              ldx #0
    7 T:49b9  a9 6d                              lda #<mpdt
    7 T:49bb  a0 61                              ldy #>mpdt
    7 T:49bd  20 a0 51                           jsr wsubmenu
    8 T:49c0  20 a6 51                 m22a      jsr wsubloop
    9 T:49c3  c9 0d                              cmp #13
    9 T:49c5  d0 f9                              bne m22a
   10 T:49c7  98                                 tya 
   10 T:49c8  38                                 sec 
   10 T:49c9  20 1b a0                           jsr sgdrive
   11 T:49cc  48                                 pha 
   11 T:49cd  20 94 51                           jsr wclose
   11 T:49d0  68                                 pla 
   11 T:49d1  60                                 rts 
   12 T:49d2                                    ;********
   13 T:49d2  a9 00                    mpm21     lda #0
   13 T:49d4  a2 02                              ldx #2
   14 T:49d6                                    ;****
   15 T:49d6  8d 89 40                 mdirpin   sta mpdf
   15 T:49d9  8e 83 40                           stx mpdcmd
   16 T:49dc  20 11 4b                           jsr gtpcdir
   16 T:49df  d0 05                              bne m21ab
   16 T:49e1  ad 87 40                           lda lanz
   16 T:49e4  d0 01                              bne m21ac
   16 T:49e6  60                       m21ab     rts 
   17 T:49e7  ad 83 40                 m21ac     lda mpdcmd
   17 T:49ea  20 d0 48                           jsr prntcmd
   18 T:49ed  a9 00                    m21aa     lda #0
   18 T:49ef  8d 8a 40                           sta lseit
   19 T:49f2  a9 13                              lda #mdiranz
   19 T:49f4  8d 9b 40                           sta dirmenu
   19 T:49f7  a9 1b                              lda #mdirtbrt
   19 T:49f9  8d 9c 40                           sta dirmenu+1
   20 T:49fc  a9 03                              lda #3
   20 T:49fe  8d 9d 40                           sta dirmenu+2
   20 T:4a01  a9 06                              lda #6
   20 T:4a03  8d 9e 40                           sta dirmenu+3
   21 T:4a06  a2 40                              ldx #64
   21 T:4a08  a9 9b                              lda #<dirmenu
   21 T:4a0a  a0 40                              ldy #>dirmenu
   21 T:4a0c  20 a0 51                           jsr wsubmenu
   22 T:4a0f  20 86 4c                 m21a1     jsr iniplist
   23 T:4a12  a2 a0                              ldx #128+32
   23 T:4a14  a9 9b                              lda #<dirmenu
   23 T:4a16  a0 40                              ldy #>dirmenu
   23 T:4a18  20 a0 51                           jsr wsubmenu
   24 T:4a1b  20 a6 51                 m21a      jsr wsubloop
   25 T:4a1e  c9 1d                    m21al     cmp #29          ;"{rght}"
   25 T:4a20  f0 04                              beq m21b
   25 T:4a22  c9 11                              cmp #17             ;"{down}"
   25 T:4a24  d0 21                              bne m21c
   26 T:4a26  ae 8a 40                 m21b      ldx lseit
   26 T:4a29  e8                                 inx 
   26 T:4a2a  8e 41 40                           stx int1
   26 T:4a2d  a9 00                              lda #0
   26 T:4a2f  8d 42 40                           sta int1+1
   27 T:4a32  a9 13                              lda #mdiranz
   27 T:4a34  a2 00                              ldx #0
   27 T:4a36  20 6f 49                           jsr mult
   28 T:4a39  e0 00                              cpx #0
   28 T:4a3b  d0 de                              bne m21a
   29 T:4a3d  cd 87 40                           cmp lanz
   29 T:4a40  b0 d9                              bcs m21a
   29 T:4a42  ee 8a 40                           inc lseit
   29 T:4a45  d0 c8                              bne m21a1
   30 T:4a47  c9 9d                    m21c      cmp #29+128    ;"{left}"
   30 T:4a49  f0 04                              beq m21c1
   30 T:4a4b  c9 91                              cmp #17+128       ;"{up}"
   30 T:4a4d  d0 0b                              bne m21d
   31 T:4a4f  ad 8a 40                 m21c1     lda lseit
   31 T:4a52  f0 c7                              beq m21a
   31 T:4a54  ce 8a 40                           dec lseit
   31 T:4a57  4c 0f 4a                           jmp m21a1
   32 T:4a5a  c9 8d                    m21d      cmp #13+128
   32 T:4a5c  f0 1e                              beq m21e
   33 T:4a5e  c9 3d                              cmp #"="
   33 T:4a60  f0 1a                              beq m21e
   33 T:4a62  c9 23                              cmp #"#"
   33 T:4a64  f0 16                              beq m21e
   34 T:4a66  c9 0d                              cmp #13
   34 T:4a68  f0 12                              beq m21e
   34 T:4a6a  c9 03                              cmp #3
   34 T:4a6c  d0 ad                              bne m21a
   35 T:4a6e  a9 ea                              lda #enbreak
   35 T:4a70  2c                                 .byt $2c
   35 T:4a71  a9 00                    m21f      lda #0
   36 T:4a73  48                       m21a2     pha 
   36 T:4a74  20 94 51                           jsr wclose
   36 T:4a77  20 af 51                           jsr wclrcmd
   36 T:4a7a  68                                 pla 
   36 T:4a7b  60                                 rts 
   37 T:4a7c  38                       m21e      sec 
   37 T:4a7d  e9 8d                              sbc #13+128
   37 T:4a7f  8d 82 40                           sta mpdb
   37 T:4a82  8c 73 40                           sty sma
   38 T:4a85  ad 8a 40                           lda lseit
   38 T:4a88  8d 41 40                           sta int1
   38 T:4a8b  a9 00                              lda #0
   38 T:4a8d  8d 42 40                           sta int1+1
   39 T:4a90  a9 13                              lda #mdiranz
   39 T:4a92  a2 00                              ldx #0
   39 T:4a94  20 6f 49                           jsr mult
   39 T:4a97  18                                 clc 
   39 T:4a98  6d 73 40                           adc sma
   39 T:4a9b  90 01                              bcc m21d1
   39 T:4a9d  e8                                 inx 
   40 T:4a9e  8d 41 40                 m21d1     sta int1
   40 T:4aa1  8e 42 40                           stx int1+1
   41 T:4aa4  a9 13                              lda #19
   41 T:4aa6  a2 00                              ldx #0
   41 T:4aa8  20 6f 49                           jsr mult
   42 T:4aab  18                                 clc 
   42 T:4aac  69 be                              adc #<liste
   42 T:4aae  85 0e                              sta lzei
   42 T:4ab0  8a                                 txa 
   42 T:4ab1  69 42                              adc #>liste
   42 T:4ab3  85 0f                              sta lzei+1
   43 T:4ab5  ad 82 40                           lda mpdb
   43 T:4ab8  f0 10                              beq m21fb
   44 T:4aba  49 80                              eor #$80
   44 T:4abc  d0 07                              bne m21fa
   45 T:4abe  2c 89 40                           bit mpdf
   45 T:4ac1  50 ae                              bvc m21f
   45 T:4ac3  70 31                              bvs m21ax
   46 T:4ac5  2c 89 40                 m21fa     bit mpdf
   46 T:4ac8  70 a7                              bvs m21f
   47 T:4aca  a0 0b                    m21fb     ldy #11
   47 T:4acc  b1 0e                              lda (lzei),y
   47 T:4ace  29 10                              and #$10
   47 T:4ad0  d0 27                              bne m21g
   47 T:4ad2  d0 9f                    m21a2a    bne m21a2
   48 T:4ad4  ad 82 40                           lda mpdb
   48 T:4ad7  f0 1d                              beq m21ax
   49 T:4ad9  ad 89 40                           lda mpdf
   49 T:4adc  10 18                              bpl m21ax
   50 T:4ade  a0 10                              ldy #16
   50 T:4ae0  b1 0e                              lda (lzei),y
   50 T:4ae2  49 80                              eor #128
   50 T:4ae4  91 0e                              sta (lzei),y
   51 T:4ae6  a0 02                              ldy #2
   51 T:4ae8  b1 10                              lda (lmzei),y
   51 T:4aea  49 1e                              eor #$1e
   51 T:4aec  91 10                              sta (lmzei),y
   52 T:4aee  a9 11                              lda #17             ;"{down}"
   52 T:4af0  20 a9 51                           jsr wexloop
   52 T:4af3  4c 1e 4a                           jmp m21al
   53 T:4af6  4c 1b 4a                 m21ax     jmp m21a
   54 T:4af9  ad 82 40                 m21g      lda mpdb
   54 T:4afc  d0 f8                              bne m21ax
   55 T:4afe  20 b7 4d                           jsr lzeibuf
   55 T:4b01  20 33 a0                           jsr chdir
   55 T:4b04  d0 cc                              bne m21a2a
   56 T:4b06  20 94 51                           jsr wclose
   56 T:4b09  20 a7 4b                           jsr gtpsdir
   56 T:4b0c  d0 c4                              bne m21a2a
   56 T:4b0e  4c ed 49                           jmp m21aa
   57 T:4b11                                    ;****
   58 T:4b11  8d 81 40                 gtpcdir   sta gtpd
   58 T:4b14  a9 01                              lda #1
   58 T:4b16  20 d0 48                           jsr prntcmd
   59 T:4b19  a9 a4                              lda #<isnpt
   59 T:4b1b  a0 61                              ldy #>isnpt
   59 T:4b1d  20 be 51                           jsr winput
   60 T:4b20  90 01                              bcc gtpc1
   60 T:4b22  60                                 rts 
   61 T:4b23  86 0e                    gtpc1     stx lzei
   61 T:4b25  84 0f                              sty lzei+1
   62 T:4b27  c9 00                              cmp #0
   62 T:4b29  d0 1a                              bne gpdaa
   62 T:4b2b  a9 2a                              lda #"*"
   62 T:4b2d  8d 00 02                           sta iobuf
   62 T:4b30  8d 02 02                           sta iobuf+2
   63 T:4b33  a9 00                              lda #0
   63 T:4b35  8d 03 02                           sta iobuf+3
   63 T:4b38  a9 2e                              lda #"."
   63 T:4b3a  8d 01 02                           sta iobuf+1
   64 T:4b3d  a9 00                              lda #<iobuf
   64 T:4b3f  85 0e                              sta lzei
   64 T:4b41  a9 02                              lda #>iobuf
   64 T:4b43  85 0f                              sta lzei+1
   65 T:4b45  a0 00                    gpdaa     ldy #0
   66 T:4b47  b1 0e                    gpdad     lda (lzei),y
   66 T:4b49  f0 0a                              beq gpdab
   66 T:4b4b  c9 5c                              cmp #backs
   66 T:4b4d  f0 03                              beq gpdac
   66 T:4b4f  c8                                 iny 
   66 T:4b50  d0 f5                              bne gpdad
   67 T:4b52  a9 f5                    gpdac     lda #enillnam
   67 T:4b54  60                                 rts 
   68 T:4b55  a9 00                    gpdab     lda #<iobuf
   68 T:4b57  a0 02                              ldy #>iobuf
   68 T:4b59  a2 20                              ldx #$20
   68 T:4b5b  20 36 a0                           jsr namedtp
   69 T:4b5e  f0 04                              beq gpda
   69 T:4b60  c9 f7                              cmp #ennotfnd
   69 T:4b62  d0 21                              bne gpde2
   70 T:4b64                           gpda      
   71 T:4b64  18                                 clc 
   71 T:4b65  20 18 a0                           jsr sgdta
   71 T:4b68  85 fe                              sta dtadr
   71 T:4b6a  84 ff                              sty dtadr+1
   72 T:4b6c  a0 0a                              ldy #dsattr-1
   73 T:4b6e  b1 fe                    gpdb      lda (dtadr),y
   73 T:4b70  99 b3 42                           sta pcsuch,y
   73 T:4b73  88                                 dey 
   73 T:4b74  10 f8                              bpl gpdb
   74 T:4b76  a2 18                              ldx #24
   74 T:4b78  a0 00                              ldy #0
   74 T:4b7a  18                                 clc 
   74 T:4b7b  20 9a 51                           jsr wcursor
   74 T:4b7e  a9 76                              lda #<oldsize
   74 T:4b80  a0 40                              ldy #>oldsize
   74 T:4b82  20 27 a0                           jsr gtdskfr
   75 T:4b85  d0 5a                    gpde2     bne gpde1
   75 T:4b87  a2 00                              ldx #0
   75 T:4b89  a0 03                              ldy #3
   76 T:4b8b  b9 76 40                 gpdax1    lda oldsize,y
   76 T:4b8e  20 57 4e                           jsr hexbuf
   76 T:4b91  88                                 dey 
   76 T:4b92  10 f7                              bpl gpdax1
   77 T:4b94  a9 00                              lda #0
   77 T:4b96  9d 00 02                           sta iobuf,x
   77 T:4b99  a9 00                              lda #<iobuf
   77 T:4b9b  a0 02                              ldy #>iobuf
   77 T:4b9d  20 8f 38                           jsr textout
   78 T:4ba0  a9 e8                              lda #<dirbfrei
   78 T:4ba2  a0 61                              ldy #>dirbfrei
   78 T:4ba4  20 8f 38                           jsr textout
   79 T:4ba7  a9 00                    gtpsdir   lda #0
   79 T:4ba9  8d 87 40                           sta lanz
   80 T:4bac  a9 02                              lda #<pcdta
   80 T:4bae  a0 40                              ldy #>pcdta
   80 T:4bb0  38                                 sec 
   80 T:4bb1  20 18 a0                           jsr sgdta
   81 T:4bb4  20 3b 41                           jsr stline
   82 T:4bb7  a9 be                              lda #<liste
   82 T:4bb9  85 0e                              sta lzei
   82 T:4bbb  a0 42                              ldy #>liste
   82 T:4bbd  84 0f                              sty lzei+1
   83 T:4bbf  a9 02                              lda #<pcdta
   83 T:4bc1  a0 40                              ldy #>pcdta
   83 T:4bc3  38                                 sec 
   83 T:4bc4  20 18 a0                           jsr sgdta
   84 T:4bc7  ad 81 40                           lda gtpd
   84 T:4bca  30 24                              bmi gpd1
   85 T:4bcc  a9 2a                              lda #"*"
   85 T:4bce  8d 02 40                           sta pcdta+dsname
   85 T:4bd1  8d 0a 40                           sta pcdta+dsext
   86 T:4bd4  a9 10                              lda #$10             ;subdirs
   86 T:4bd6  8d 0d 40                           sta pcdta+dsattr
   87 T:4bd9  20 2a a0                           jsr sfirst
   87 T:4bdc  20 27 4c                           jsr gpdloop
   88 T:4bdf  c9 f7                              cmp #ennotfnd
   88 T:4be1  d0 40                    gpde1     bne gpde
   89 T:4be3  ac 87 40                           ldy lanz
   89 T:4be6  f0 08                              beq gpd1
   90 T:4be8  88                                 dey 
   90 T:4be9  a2 00                              ldx #0
   90 T:4beb  a9 01                              lda #1
   90 T:4bed  20 ff 4e                           jsr sort
   91 T:4bf0  a0 0a                    gpd1      ldy #dsattr-1
   91 T:4bf2  b9 b3 42                 gpdc      lda pcsuch,y
   91 T:4bf5  99 02 40                           sta pcdta,y
   91 T:4bf8  88                                 dey 
   91 T:4bf9  10 f7                              bpl gpdc
   92 T:4bfb  ad 87 40                           lda lanz
   92 T:4bfe  8d 8d 40                           sta panzsub
   93 T:4c01  a9 20                              lda #$20
   93 T:4c03  8d 0d 40                           sta pcdta+dsattr
   94 T:4c06  20 2a a0                           jsr sfirst
   95 T:4c09  20 27 4c                           jsr gpdloop
   95 T:4c0c  c9 f7                              cmp #ennotfnd
   95 T:4c0e  d0 13                              bne gpde
   96 T:4c10  ae 8d 40                           ldx panzsub
   96 T:4c13  ec 87 40                           cpx lanz
   96 T:4c16  f0 09                              beq gpd3
   97 T:4c18  ac 87 40                           ldy lanz
   97 T:4c1b  88                                 dey 
   97 T:4c1c  a9 01                              lda #1
   97 T:4c1e  20 ff 4e                           jsr sort
   98 T:4c21  a9 00                    gpd3      lda #0
   98 T:4c23  60                       gpde      rts 
   99 T:4c24                                    ;****
  100 T:4c24  20 30 a0                 gpdl0     jsr snext
  101 T:4c27  d0 fa                    gpdloop   bne gpde
  102 T:4c29  a2 0c                              ldx #dgname
  102 T:4c2b  a0 00                              ldy #0
  103 T:4c2d  bd 02 40                 gpdl1     lda pcdta,x
  103 T:4c30  91 0e                              sta (lzei),y
  103 T:4c32  e8                                 inx 
  103 T:4c33  c8                                 iny 
  103 T:4c34  c0 08                              cpy #8
  103 T:4c36  d0 f5                              bne gpdl1
  104 T:4c38  a2 14                              ldx #dgext
  105 T:4c3a  bd 02 40                 gpdl2     lda pcdta,x
  105 T:4c3d  91 0e                              sta (lzei),y
  105 T:4c3f  e8                                 inx 
  105 T:4c40  c8                                 iny 
  105 T:4c41  c0 0b                              cpy #11
  105 T:4c43  d0 f5                              bne gpdl2
  106 T:4c45  a2 17                              ldx #dgattr
  107 T:4c47  bd 02 40                           lda pcdta,x
  107 T:4c4a  91 0e                              sta (lzei),y
  107 T:4c4c  c8                                 iny 
  108 T:4c4d  a2 1a                              ldx #dgsize
  109 T:4c4f  bd 02 40                 gpdl3     lda pcdta,x
  109 T:4c52  91 0e                              sta (lzei),y
  109 T:4c54  e8                                 inx 
  109 T:4c55  c8                                 iny 
  109 T:4c56  c0 10                              cpy #16
  109 T:4c58  d0 f5                              bne gpdl3
  110 T:4c5a  a9 00                              lda #0
  110 T:4c5c  91 0e                              sta (lzei),y
  110 T:4c5e  c8                                 iny 
  111 T:4c5f  a2 18                              ldx #dgclus
  111 T:4c61  bd 02 40                           lda pcdta,x
  111 T:4c64  91 0e                              sta (lzei),y
  111 T:4c66  c8                                 iny 
  111 T:4c67  e8                                 inx 
  112 T:4c68  bd 02 40                           lda pcdta,x
  112 T:4c6b  91 0e                              sta (lzei),y
  113 T:4c6d  a9 13                              lda #19
  113 T:4c6f  18                                 clc 
  113 T:4c70  65 0e                              adc lzei
  113 T:4c72  85 0e                              sta lzei
  113 T:4c74  90 02                              bcc gpdlx
  114 T:4c76  e6 0f                              inc lzei+1
  115 T:4c78  ee 87 40                 gpdlx     inc lanz
  116 T:4c7b  20 70 4e                           jsr testlist
  116 T:4c7e  90 03                              bcc gpdl0a
  116 T:4c80  a9 20                              lda #32
  116 T:4c82  60                                 rts 
  117 T:4c83  4c 24 4c                 gpdl0a    jmp gpdl0
  118 T:4c86                                    ;********
  119 T:4c86  ad 8a 40                 iniplist  lda lseit
  119 T:4c89  8d 41 40                           sta int1
  119 T:4c8c  a9 00                              lda #0
  119 T:4c8e  8d 42 40                           sta int1+1
  120 T:4c91  a9 13                              lda #mdiranz
  120 T:4c93  a2 00                              ldx #0
  120 T:4c95  20 6f 49                           jsr mult
  121 T:4c98  8d 41 40                           sta int1
  121 T:4c9b  ad 87 40                           lda lanz
  121 T:4c9e  38                                 sec 
  121 T:4c9f  ed 41 40                           sbc int1
  122 T:4ca2  c9 13                              cmp #mdiranz
  122 T:4ca4  90 04                              bcc ipl1
  122 T:4ca6  f0 02                              beq ipl1
  123 T:4ca8  a9 13                              lda #mdiranz
  124 T:4caa  8d 9b 40                 ipl1      sta dirmenu
  124 T:4cad  8d 88 40                           sta lmanz
  125 T:4cb0  a9 1b                              lda #mdirtbrt
  125 T:4cb2  8d 9c 40                           sta dirmenu+1
  126 T:4cb5  a9 03                              lda #3
  126 T:4cb7  8d 9d 40                           sta dirmenu+2
  126 T:4cba  a9 06                              lda #6
  126 T:4cbc  8d 9e 40                           sta dirmenu+3
  127 T:4cbf  a9 00                              lda #0
  127 T:4cc1  8d 42 40                           sta int1+1
  127 T:4cc4  a9 13                              lda #19
  127 T:4cc6  a2 00                              ldx #0
  127 T:4cc8  20 6f 49                           jsr mult
  128 T:4ccb  18                                 clc 
  128 T:4ccc  69 be                              adc #<liste
  128 T:4cce  85 0e                              sta lzei
  128 T:4cd0  8a                                 txa 
  128 T:4cd1  69 42                              adc #>liste
  128 T:4cd3  85 0f                              sta lzei+1
  129 T:4cd5  a9 9f                              lda #<dirmenu+4
  129 T:4cd7  85 10                              sta lmzei
  129 T:4cd9  a9 40                              lda #>dirmenu+4
  129 T:4cdb  85 11                              sta lmzei+1
  130 T:4cdd  a9 20                    ipl2      lda #" "
  130 T:4cdf  8d 00 02                           sta iobuf
  130 T:4ce2  8d 01 02                           sta iobuf+1
  130 T:4ce5  8d 02 02                           sta iobuf+2
  131 T:4ce8  a0 07                              ldy #7
  131 T:4cea  b1 0e                    ipl3      lda (lzei),y
  131 T:4cec  99 03 02                           sta iobuf+3,y
  131 T:4cef  88                                 dey 
  131 T:4cf0  10 f8                              bpl ipl3
  132 T:4cf2  a9 20                              lda #" "
  132 T:4cf4  8d 0b 02                           sta iobuf+3+8
  133 T:4cf7  a0 08                              ldy #8
  133 T:4cf9  b1 0e                    ipl4      lda (lzei),y
  133 T:4cfb  99 04 02                           sta iobuf+4,y
  133 T:4cfe  c8                                 iny 
  133 T:4cff  c0 0b                              cpy #11
  133 T:4d01  d0 f6                              bne ipl4
  134 T:4d03  a9 20                              lda #" "
  134 T:4d05  8d 0f 02                           sta iobuf+15
  134 T:4d08  8d 10 02                           sta iobuf+16
  135 T:4d0b  a2 11                              ldx #17
  135 T:4d0d  b1 0e                              lda (lzei),y
  135 T:4d0f  29 10                              and #$10
  135 T:4d11  f0 10                              beq ipl7
  136 T:4d13  a9 2b                              lda #"+"
  136 T:4d15  8d 01 02                           sta iobuf+1
  137 T:4d18  bd d0 61                 ipl8      lda sdirt-17,x
  137 T:4d1b  9d 00 02                           sta iobuf,x
  137 T:4d1e  f0 1a                              beq iplse
  137 T:4d20  e8                                 inx 
  137 T:4d21  d0 f5                              bne ipl8
  138 T:4d23  a0 10                    ipl7      ldy #16
  138 T:4d25  b1 0e                              lda (lzei),y
  138 T:4d27  10 05                              bpl ipl7a
  138 T:4d29  a9 3e                              lda #">"
  138 T:4d2b  8d 01 02                           sta iobuf+1
  139 T:4d2e  a0 0f                    ipl7a     ldy #15
  140 T:4d30  b1 0e                    ipl6      lda (lzei),y
  140 T:4d32  20 57 4e                           jsr hexbuf
  140 T:4d35  88                                 dey 
  140 T:4d36  c0 0b                              cpy #11
  140 T:4d38  d0 f6                              bne ipl6
  141 T:4d3a  a9 20                    iplse     lda #" "
  141 T:4d3c  9d 00 02                 ipls1     sta iobuf,x
  141 T:4d3f  e8                                 inx 
  141 T:4d40  e0 1b                              cpx #mdirtbrt
  141 T:4d42  d0 f8                              bne ipls1
  142 T:4d44  a0 1b                              ldy #mdirtbrt
  142 T:4d46  b9 ff 01                 ipls0     lda iobuf-1,y
  142 T:4d49  91 10                              sta (lmzei),y
  142 T:4d4b  88                                 dey 
  142 T:4d4c  d0 f8                              bne ipls0
  143 T:4d4e  a9 80                              lda #128
  143 T:4d50  91 10                              sta (lmzei),y
  144 T:4d52  a9 13                              lda #19
  144 T:4d54  18                                 clc 
  144 T:4d55  65 0e                              adc lzei
  144 T:4d57  85 0e                              sta lzei
  144 T:4d59  90 02                              bcc ipls2
  145 T:4d5b  e6 0f                              inc lzei+1
  145 T:4d5d                           ipls2     
  146 T:4d5d  a5 10                              lda lmzei
  146 T:4d5f  18                                 clc 
  146 T:4d60  69 1c                              adc #mdirtbrt+1
  146 T:4d62  85 10                              sta lmzei
  146 T:4d64  90 02                              bcc ipls3
  147 T:4d66  e6 11                              inc lmzei+1
  147 T:4d68  ce 88 40                 ipls3     dec lmanz
  147 T:4d6b  f0 03                              beq m24aa
  147 T:4d6d  4c dd 4c                           jmp ipl2
  148 T:4d70  60                       m24aa     rts 
  149 T:4d71                                    ;********
  150 T:4d71                           mpm26                      ; delete
  151 T:4d71  a9 80                              lda #128
  151 T:4d73  a2 07                              ldx #7
  152 T:4d75  20 d6 49                           jsr mdirpin
  153 T:4d78  d0 f6                              bne m24aa
  154 T:4d7a  ad 87 40                           lda lanz
  154 T:4d7d  f0 f1                              beq m24aa
  155 T:4d7f  20 d0 40                           jsr asksure
  155 T:4d82  b0 ec                              bcs m24aa
  156 T:4d84  a9 be                              lda #<liste
  156 T:4d86  85 0e                              sta lzei
  156 T:4d88  a9 42                              lda #>liste
  156 T:4d8a  85 0f                              sta lzei+1
  157 T:4d8c  a0 10                    m24b      ldy #16
  157 T:4d8e  b1 0e                              lda (lzei),y
  157 T:4d90  10 0a                              bpl m24c
  158 T:4d92  20 b7 4d                           jsr lzeibuf
  159 T:4d95  a2 20                              ldx #$20
  159 T:4d97  20 3c a0                           jsr delete
  160 T:4d9a  d0 13                              bne m24x
  161 T:4d9c  a9 13                    m24c      lda #19
  161 T:4d9e  18                                 clc 
  161 T:4d9f  65 0e                              adc lzei
  161 T:4da1  85 0e                              sta lzei
  161 T:4da3  90 02                              bcc m24f
  161 T:4da5  e6 0f                              inc lzei+1
  162 T:4da7  ce 87 40                 m24f      dec lanz
  162 T:4daa  d0 e0                              bne m24b
  163 T:4dac  a9 00                              lda #0
  163 T:4dae  60                                 rts 
  164 T:4daf  20 2c 4e                 m24x      jsr error
  164 T:4db2  90 e8                              bcc m24c
  165 T:4db4  a9 ea                              lda #enbreak
  165 T:4db6  60                                 rts 
  166 T:4db7                                    ;****
  167 T:4db7  a0 00                    lzeibuf   ldy #0
  167 T:4db9  a2 00                              ldx #0
  168 T:4dbb  b1 0e                    m24d      lda (lzei),y
  168 T:4dbd  9d 00 02                           sta iobuf,x
  168 T:4dc0  c8                                 iny 
  168 T:4dc1  e8                                 inx 
  168 T:4dc2  e0 08                              cpx #8
  168 T:4dc4  d0 f5                              bne m24d
  169 T:4dc6  a9 2e                              lda #"."
  169 T:4dc8  9d 00 02                           sta iobuf,x
  169 T:4dcb  e8                                 inx 
  170 T:4dcc  a0 08                              ldy #8
  171 T:4dce  b1 0e                    m24e      lda (lzei),y
  171 T:4dd0  9d 00 02                           sta iobuf,x
  171 T:4dd3  c8                                 iny 
  171 T:4dd4  e8                                 inx 
  171 T:4dd5  e0 0c                              cpx #12
  171 T:4dd7  d0 f5                              bne m24e
  172 T:4dd9  a9 00                              lda #0
  172 T:4ddb  9d 00 02                           sta iobuf,x
  173 T:4dde  a9 00                              lda #<iobuf
  173 T:4de0  a0 02                              ldy #>iobuf
  173 T:4de2  60                                 rts 
  174 T:4de3                                    ;********
  175 T:4de3                           mpm23                      ; pfad
  175 T:4de3  a9 04                              lda #4
  175 T:4de5  20 d0 48                           jsr prntcmd
  176 T:4de8  a9 9d                              lda #<ismpt
  176 T:4dea  a0 61                              ldy #>ismpt
  176 T:4dec  20 be 51                           jsr winput
  177 T:4def  b0 04                              bcs mp23a
  177 T:4df1  8a                                 txa 
  177 T:4df2  20 33 a0                           jsr chdir
  177 T:4df5  60                       mp23a     rts 
  178 T:4df6                                    ;********
  179 T:4df6                           mpm24                      ; md
  179 T:4df6  a9 05                              lda #5
  179 T:4df8  20 d0 48                           jsr prntcmd
  180 T:4dfb  a9 a4                              lda #<isnpt
  180 T:4dfd  a0 61                              ldy #>isnpt
  180 T:4dff  20 be 51                           jsr winput
  181 T:4e02  b0 f1                              bcs mp23a
  181 T:4e04  8a                                 txa 
  181 T:4e05  4c 42 a0                           jmp mkdir
  182 T:4e08                                    ;********
  183 T:4e08                           mpm25                      ; rd
  184 T:4e08  a2 06                              ldx #6
  184 T:4e0a  a9 40                              lda #64
  184 T:4e0c  20 d6 49                           jsr mdirpin
  184 T:4e0f  d0 1a                              bne m25a
  185 T:4e11  ad 87 40                           lda lanz
  185 T:4e14  f0 15                              beq m25a
  186 T:4e16  20 d0 40                           jsr asksure
  186 T:4e19  b0 10                              bcs m25a
  187 T:4e1b  a0 0b                              ldy #11
  187 T:4e1d  b1 0e                              lda (lzei),y
  187 T:4e1f  29 10                              and #$10
  187 T:4e21  f0 06                              beq m25e
  188 T:4e23  20 b7 4d                           jsr lzeibuf
  188 T:4e26  4c 45 a0                           jmp rmdir
  189 T:4e29  a9 f5                    m25e      lda #enillnam
  189 T:4e2b  60                       m25a      rts 
  190 T:4e2c                                    ;********
  191 T:4e2c  20 59 3b                 error     jsr fehlout
  191 T:4e2f  20 af 51                           jsr wclrcmd
  192 T:4e32  a9 00                              lda #<iobuf
  192 T:4e34  a0 02                              ldy #>iobuf
  192 T:4e36  20 ac 51                           jsr wprntcmd
  193 T:4e39  a9 ab                    errorq    lda #<mwt
  193 T:4e3b  a0 61                              ldy #>mwt
  193 T:4e3d  20 b8 51                           jsr wopenmsg
  194 T:4e40  20 9d 51                 errr1     jsr wgetkey
  194 T:4e43  f0 fb                              beq errr1
  195 T:4e45  c9 03                              cmp #3
  195 T:4e47  f0 04                              beq errr2
  195 T:4e49  c9 0d                              cmp #13
  195 T:4e4b  d0 f3                              bne errr1
  196 T:4e4d  48                       errr2     pha 
  196 T:4e4e  20 94 51                           jsr wclose
  196 T:4e51  68                                 pla 
  197 T:4e52  49 08                              eor #8
  197 T:4e54  e9 08                              sbc #8
  197 T:4e56  60                                 rts 
  198 T:4e57                                    ;********

  200 T:4e57  48                       hexbuf    pha 
  200 T:4e58  4a                                 lsr 
  200 T:4e59  4a                                 lsr 
  200 T:4e5a  4a                                 lsr 
  200 T:4e5b  4a                                 lsr 
  201 T:4e5c  20 62 4e                           jsr hexnbuf
  202 T:4e5f  68                                 pla 
  202 T:4e60  29 0f                              and #$0f
  203 T:4e62  18                       hexnbuf   clc 
  203 T:4e63  69 30                              adc #"0"
  203 T:4e65  c9 3a                              cmp #"9"+1
  204 T:4e67  90 02                              bcc hexnb1
  204 T:4e69  69 06                              adc #6
  205 T:4e6b  9d 00 02                 hexnb1    sta iobuf,x
  205 T:4e6e  e8                                 inx 
  205 T:4e6f  60                                 rts 

  208 T:4e70                                    ;********
  209 T:4e70  a5 0f                    testlist  lda lzei+1
  209 T:4e72  c9 6c                              cmp #>listend
  210 T:4e74  d0 04                              bne teli1
  211 T:4e76  a5 0e                              lda lzei
  211 T:4e78  c9 00                              cmp #<listend
  212 T:4e7a  60                       teli1     rts 
  213 T:4e7b                                    ;********
  214 T:4e7b  a9 08                    mpm27     lda #8
  214 T:4e7d  20 d0 48                           jsr prntcmd
  215 T:4e80  a9 a4                              lda #<isnpt
  215 T:4e82  a0 61                              ldy #>isnpt
  215 T:4e84  20 be 51                           jsr winput
  216 T:4e87  b0 f1                              bcs teli1
  216 T:4e89  86 30                              stx czei
  216 T:4e8b  84 31                              sty czei+1
  217 T:4e8d  20 d0 40                           jsr asksure
  217 T:4e90  90 01                              bcc m27a
  217 T:4e92  60                                 rts 
  218 T:4e93  a5 30                    m27a      lda czei
  218 T:4e95  a4 31                              ldy czei+1
  218 T:4e97  4c 69 2b                           jmp pformat

  220 T:4e9a                                     .end 

PRA 2.4 .S50

    1 T:4e9a                                     .include "WP3 2.4 .S17"

WP3 2.4 .S17


    3 T:4e9a                                    ;WP3 2.4 .S17 ==0801==

    6 T:4e9a                           sortinit  
    7 T:4e9a  20 f0 4e                 mpm51     jsr hk1clr
    7 T:4e9d  a9 2b                              lda #"+"
    7 T:4e9f  8d ee 5b                           sta hk11
    8 T:4ea2  a9 00                              lda #0
    8 T:4ea4  8d 91 40                           sta sofl
    8 T:4ea7  60                                 rts 
    9 T:4ea8  20 f0 4e                 mpm52     jsr hk1clr
    9 T:4eab  a9 2b                              lda #"+"
    9 T:4ead  8d fa 5b                           sta hk12
   10 T:4eb0  a9 80                              lda #128
   10 T:4eb2  8d 91 40                           sta sofl
   11 T:4eb5  a9 00                              lda #0
   11 T:4eb7  8d 92 40                           sta sonk
   11 T:4eba  60                                 rts 
   12 T:4ebb  20 f0 4e                 mpm53     jsr hk1clr
   12 T:4ebe  a9 2b                              lda #"+"
   12 T:4ec0  8d 06 5c                           sta hk13
   13 T:4ec3  a9 80                              lda #128
   13 T:4ec5  8d 91 40                           sta sofl
   14 T:4ec8  a9 01                              lda #1
   14 T:4eca  8d 92 40                           sta sonk
   14 T:4ecd  a9 00                              lda #0
   14 T:4ecf  60                                 rts 
   15 T:4ed0  20 f0 4e                 mpm54     jsr hk1clr
   15 T:4ed3  a9 2b                              lda #"+"
   15 T:4ed5  8d 12 5c                           sta hk14
   16 T:4ed8  a9 e0                              lda #128+64+32
   16 T:4eda  8d 91 40                           sta sofl
   17 T:4edd  a9 02                              lda #2
   17 T:4edf  8d 92 40                           sta sonk
   17 T:4ee2  a9 00                              lda #0
   17 T:4ee4  60                                 rts 
   18 T:4ee5  ad 91 40                 mpm55     lda sofl
   18 T:4ee8  49 20                              eor #32
   18 T:4eea  8d 91 40                           sta sofl
   19 T:4eed  a9 00                              lda #0
   19 T:4eef  60                                 rts 
   20 T:4ef0  a9 20                    hk1clr    lda #" "
   21 T:4ef2  8d ee 5b                           sta hk11
   21 T:4ef5  8d fa 5b                           sta hk12
   21 T:4ef8  8d 06 5c                           sta hk13
   22 T:4efb  8d 12 5c                           sta hk14
   22 T:4efe  60                                 rts 
   23 T:4eff                                    ;********
   24 T:4eff  8e 93 40                 sort      stx sofirst
   25 T:4f02  8c 94 40                           sty solast
   25 T:4f05  cc 93 40                           cpy sofirst
   25 T:4f08  f0 28                              beq sortr
   26 T:4f0a  8d 41 40                           sta int1
   27 T:4f0d  ad 92 40                           lda sonk
   27 T:4f10  0a                                 asl 
   27 T:4f11  0a                                 asl 
   27 T:4f12  0d 41 40                           ora int1
   28 T:4f15  aa                                 tax 
   28 T:4f16  bd b1 62                           lda soname,x
   28 T:4f19  8d 96 40                           sta sokrit
   29 T:4f1c  e8                                 inx 
   29 T:4f1d  e8                                 inx 
   29 T:4f1e  bd b1 62                           lda soname,x
   29 T:4f21  8d 97 40                           sta sokend
   30 T:4f24  ae 41 40                           ldx int1
   30 T:4f27  bd bd 62                           lda sollen,x
   30 T:4f2a  8d 98 40                           sta soelen
   31 T:4f2d  2c 91 40                           bit sofl
   31 T:4f30  30 03                              bmi sort1
   32 T:4f32  a9 00                    sortr     lda #0
   32 T:4f34  60                                 rts 
   33 T:4f35  ad 98 40                 sort1     lda soelen
   33 T:4f38  8d 41 40                           sta int1
   34 T:4f3b  a2 00                              ldx #0
   34 T:4f3d  8e 42 40                           stx int1+1
   34 T:4f40  ad 93 40                           lda sofirst
   35 T:4f43  20 6f 49                           jsr mult
   36 T:4f46  18                                 clc 
   36 T:4f47  69 be                              adc #<liste
   36 T:4f49  8d 99 40                           sta sofadr
   37 T:4f4c  8a                                 txa 
   37 T:4f4d  69 42                              adc #>liste
   37 T:4f4f  8d 9a 40                           sta sofadr+1
   38 T:4f52  ad 91 40                 sortloop  lda sofl
   38 T:4f55  29 fe                              and #$ff-1
   39 T:4f57  8d 91 40                           sta sofl
   39 T:4f5a  ad 99 40                           lda sofadr
   40 T:4f5d  85 0e                              sta lzei
   40 T:4f5f  ad 9a 40                           lda sofadr+1
   40 T:4f62  85 0f                              sta lzei+1
   41 T:4f64  ad 93 40                           lda sofirst
   41 T:4f67  8d 95 40                           sta socount
   42 T:4f6a  a5 0e                    soloop    lda lzei
   42 T:4f6c  18                                 clc 
   42 T:4f6d  6d 98 40                           adc soelen
   43 T:4f70  85 10                              sta lmzei
   43 T:4f72  a5 0f                              lda lzei+1
   43 T:4f74  69 00                              adc #0
   44 T:4f76  85 11                              sta lmzei+1
   45 T:4f78  2c 91 40                           bit sofl
   45 T:4f7b  70 13                              bvs solow
   46 T:4f7d  ac 96 40                           ldy sokrit
   47 T:4f80  b1 0e                    sol1      lda (lzei),y
   47 T:4f82  d1 10                              cmp (lmzei),y
   48 T:4f84  90 1b                              bcc solkm
   48 T:4f86  d0 22                              bne solgm
   49 T:4f88  c8                                 iny 
   49 T:4f89  cc 97 40                           cpy sokend
   49 T:4f8c  d0 f2                              bne sol1
   50 T:4f8e  f0 3b                              beq solmg
   51 T:4f90  ac 97 40                 solow     ldy sokend
   52 T:4f93  cc 96 40                 sol2      cpy sokrit
   52 T:4f96  f0 33                              beq solmg
   53 T:4f98  88                                 dey 
   53 T:4f99  b1 0e                              lda (lzei),y
   53 T:4f9b  d1 10                              cmp (lmzei),y
   54 T:4f9d  f0 f4                              beq sol2
   54 T:4f9f  b0 09                              bcs solgm
   55 T:4fa1  ad 91 40                 solkm     lda sofl
   55 T:4fa4  29 20                              and #32
   55 T:4fa6  f0 23                              beq solmg
   56 T:4fa8  d0 07                              bne sochange
   57 T:4faa  ad 91 40                 solgm     lda sofl
   57 T:4fad  29 20                              and #32
   57 T:4faf  d0 1a                              bne solmg
   58 T:4fb1  a0 00                    sochange  ldy #0
   58 T:4fb3                           soc1      
   59 T:4fb3  b1 0e                              lda (lzei),y
   59 T:4fb5  aa                                 tax 
   59 T:4fb6  b1 10                              lda (lmzei),y
   60 T:4fb8  91 0e                              sta (lzei),y
   60 T:4fba  8a                                 txa 
   60 T:4fbb  91 10                              sta (lmzei),y
   61 T:4fbd  c8                                 iny 
   61 T:4fbe  cc 98 40                           cpy soelen
   61 T:4fc1  d0 f0                              bne soc1
   62 T:4fc3  ad 91 40                           lda sofl
   62 T:4fc6  09 01                              ora #1
   62 T:4fc8  8d 91 40                           sta sofl
   63 T:4fcb  a5 10                    solmg     lda lmzei
   63 T:4fcd  85 0e                              sta lzei
   64 T:4fcf  a5 11                              lda lmzei+1
   64 T:4fd1  85 0f                              sta lzei+1
   65 T:4fd3  ee 95 40                           inc socount
   65 T:4fd6  ad 95 40                           lda socount
   66 T:4fd9  cd 94 40                           cmp solast
   66 T:4fdc  d0 8c                              bne soloop
   67 T:4fde  ad 91 40                           lda sofl
   67 T:4fe1  29 01                              and #1
   67 T:4fe3  f0 03                              beq sortrr
   68 T:4fe5  4c 52 4f                           jmp sortloop
   69 T:4fe8  a5 0e                    sortrr    lda lzei
   69 T:4fea  18                                 clc 
   69 T:4feb  6d 98 40                           adc soelen
   70 T:4fee  85 0e                              sta lzei
   70 T:4ff0  90 02                              bcc sortr1
   70 T:4ff2  e6 0f                              inc lzei+1
   71 T:4ff4  a9 00                    sortr1    lda #0
   71 T:4ff6  60                                 rts 
   72 T:4ff7                                    ;********
   73 T:4ff7  20 25 50                 mpm45     jsr hk2clr
   73 T:4ffa  a9 2b                              lda #"+"
   73 T:4ffc  8d 1f 5d                           sta hk21
   74 T:4fff  a9 80                              lda #128
   74 T:5001  8d 90 40                           sta cvfl
   74 T:5004  a9 00                              lda #0
   74 T:5006  60                                 rts 
   75 T:5007  20 25 50                 mpm46     jsr hk2clr
   75 T:500a  a9 2b                              lda #"+"
   75 T:500c  8d 2c 5d                           sta hk22
   76 T:500f  a9 40                              lda #64
   76 T:5011  8d 90 40                           sta cvfl
   76 T:5014  a9 00                              lda #0
   76 T:5016  60                                 rts 
   77 T:5017                           convinit  
   78 T:5017  20 25 50                 mpm47     jsr hk2clr
   78 T:501a  a9 2b                              lda #"+"
   78 T:501c  8d 39 5d                           sta hk23
   79 T:501f  a9 00                              lda #0
   79 T:5021  8d 90 40                           sta cvfl
   79 T:5024  60                                 rts 
   80 T:5025  a9 20                    hk2clr    lda #" "
   80 T:5027  8d 1f 5d                           sta hk21
   80 T:502a  8d 2c 5d                           sta hk22
   80 T:502d  8d 39 5d                           sta hk23
   80 T:5030  60                                 rts 
   81 T:5031  ac 90 40                 conv      ldy cvfl
   81 T:5034  d0 01                              bne conv1
   82 T:5036  60                                 rts 
   82 T:5037                           conv1     
   83 T:5037  8d 41 40                           sta int1
   83 T:503a  8e 42 40                           stx int1+1
   84 T:503d  8d 43 40                           sta int2
   84 T:5040  8e 44 40                           stx int2+1
   85 T:5043  a9 00                              lda #<buffer
   85 T:5045  85 2e                              sta rwbzei
   86 T:5047  a9 6c                              lda #>buffer
   86 T:5049  85 2f                              sta rwbzei+1
   87 T:504b  a0 00                              ldy #0
   88 T:504d  b1 2e                    cv2       lda (rwbzei),y
   89 T:504f  20 73 50                           jsr bytconv
   90 T:5052  91 2e                              sta (rwbzei),y
   91 T:5054  c8                                 iny 
   91 T:5055  d0 02                              bne cv3
   91 T:5057  e6 2f                              inc rwbzei+1
   91 T:5059                           cv3       
   92 T:5059  ad 41 40                           lda int1
   92 T:505c  d0 03                              bne cv4
   93 T:505e  ce 42 40                           dec int1+1
   93 T:5061  ce 41 40                 cv4       dec int1
   94 T:5064  ad 41 40                           lda int1
   94 T:5067  0d 42 40                           ora int1+1
   94 T:506a  d0 e1                              bne cv2
   95 T:506c  ad 43 40                           lda int2
   95 T:506f  ae 44 40                           ldx int2+1
   95 T:5072  60                                 rts 
   96 T:5073  ae 90 40                 bytconv   ldx cvfl
   97 T:5076  e0 80                              cpx #128
   97 T:5078  d0 16                              bne bcbmasc

   99 T:507a  c9 41                    basccbm   cmp #65
   99 T:507c  90 0e                              bcc bcvr
  100 T:507e  c9 5b                              cmp #91
  100 T:5080  90 0b                              bcc bcvo
  101 T:5082  c9 61                              cmp #97
  101 T:5084  90 06                              bcc bcvr
  102 T:5086  c9 7b                              cmp #123
  102 T:5088  b0 02                              bcs bcvr
  103 T:508a  49 20                    bcvx      eor #$20
  104 T:508c  60                       bcvr      rts 
  105 T:508d  09 80                    bcvo      ora #$80
  105 T:508f  60                                 rts 
  106 T:5090                           bcbmasc   
  107 T:5090  c9 41                              cmp #65
  107 T:5092  90 f8                              bcc bcvr
  108 T:5094  c9 5b                              cmp #91
  108 T:5096  90 f2                              bcc bcvx
  109 T:5098  c9 61                              cmp #97
  109 T:509a  90 f0                              bcc bcvr
  110 T:509c  c9 7b                              cmp #123
  110 T:509e  90 ea                              bcc bcvx
  111 T:50a0  c9 c1                              cmp #128+65
  111 T:50a2  90 e8                              bcc bcvr
  112 T:50a4  c9 db                              cmp #128+91
  112 T:50a6  b0 e4                              bcs bcvr
  113 T:50a8  29 7f                              and #$7f
  113 T:50aa  60                                 rts 

  116 T:50ab                                    ;********
  117 T:50ab  a9 20                    hkcclr    lda #" "
  117 T:50ad  8d 7e 5d                           sta hk51
  118 T:50b0  8d 8b 5d                           sta hk52
  118 T:50b3  8d 98 5d                           sta hk53
  118 T:50b6  60                                 rts 
  119 T:50b7  a9 20                    hkpclr    lda #" "
  119 T:50b9  8d 57 5d                           sta hk56
  120 T:50bc  8d 57 5d                           sta hk57
  120 T:50bf  8d 64 5d                           sta hk58
  120 T:50c2  60                                 rts 
  121 T:50c3                                    ;****
  122 T:50c3  20 82 51                 mprtinit  jsr mprtoff
  123 T:50c6  20 ab 50                 mpout     jsr hkcclr
  123 T:50c9  20 b7 50                           jsr hkpclr
  124 T:50cc  ad 35 40                           lda prtfl
  124 T:50cf  29 03                              and #3
  125 T:50d1  a2 2b                              ldx #"+"
  125 T:50d3  a8                                 tay 
  125 T:50d4  d0 05                              bne mpi1
  126 T:50d6  8e 7e 5d                           stx hk51
  126 T:50d9  f0 0e                              beq mpi4
  127 T:50db  88                       mpi1      dey 
  127 T:50dc  d0 05                              bne mpi2
  128 T:50de  8e 98 5d                           stx hk53
  128 T:50e1  f0 06                              beq mpi4
  129 T:50e3  88                       mpi2      dey 
  129 T:50e4  d0 03                              bne mpi4
  130 T:50e6  8e 8b 5d                           stx hk52
  131 T:50e9  a9 20                    mpi4      lda #" "
  131 T:50eb  8d b2 5d                           sta hk54
  131 T:50ee  8d bf 5d                           sta hk55
  132 T:50f1  ad 35 40                           lda prtfl
  132 T:50f4  29 08                              and #%00001000
  132 T:50f6  f0 03                              beq mpi5
  133 T:50f8  8e b2 5d                           stx hk54
  134 T:50fb  ad 35 40                 mpi5      lda prtfl
  134 T:50fe  29 20                              and #%00100000
  135 T:5100  f0 03                              beq mpi6
  135 T:5102  8e bf 5d                           stx hk55
  136 T:5105  ad 34 40                 mpi6      lda prtdev
  136 T:5108  29 3f                              and #63
  136 T:510a  38                                 sec 
  136 T:510b  e9 02                              sbc #2
  137 T:510d  a8                                 tay 
  137 T:510e  d0 05                              bne mpi7
  138 T:5110  8e 57 5d                           stx hk56
  138 T:5113  f0 0e                              beq mpi9
  139 T:5115  88                       mpi7      dey 
  139 T:5116  d0 05                              bne mpi8
  140 T:5118  8e 57 5d                           stx hk57
  140 T:511b  f0 06                              beq mpi9
  141 T:511d  88                       mpi8      dey 
  141 T:511e  d0 03                              bne mpi9
  142 T:5120  8e 64 5d                           stx hk58
  143 T:5123  a9 00                    mpi9      lda #0
  143 T:5125  60                                 rts 
  144 T:5126                                    ;****
  145 T:5126  ad 35 40                 mppnokon  lda prtfl
  145 T:5129  29 fc                              and #255-3
  146 T:512b  8d 35 40                           sta prtfl
  146 T:512e  4c c6 50                           jmp mpout
  147 T:5131  ad 35 40                 mppacbm   lda prtfl
  147 T:5134  29 fc                              and #255-3
  148 T:5136  09 02                              ora #2
  148 T:5138  8d 35 40                           sta prtfl
  148 T:513b  4c c6 50                           jmp mpout
  149 T:513e  ad 35 40                 mppcasc   lda prtfl
  149 T:5141  29 fc                              and #255-3
  150 T:5143  09 01                              ora #1
  150 T:5145  8d 35 40                           sta prtfl
  150 T:5148  4c c6 50                           jmp mpout
  151 T:514b                                    ;****
  152 T:514b  ad 35 40                 mppcr     lda prtfl
  152 T:514e  49 08                              eor #8
  152 T:5150  8d 35 40                           sta prtfl
  153 T:5153  4c c6 50                           jmp mpout
  154 T:5156  ad 35 40                 mpplf     lda prtfl
  154 T:5159  49 20                              eor #32
  154 T:515b  8d 35 40                           sta prtfl
  155 T:515e  4c c6 50                           jmp mpout
  156 T:5161                                    ;****
  157 T:5161  a9 02                    mpp232    lda #2
  157 T:5163  8d 34 40                           sta prtdev
  157 T:5166  4c c6 50                           jmp mpout
  158 T:5169  a9 03                    mppiec    lda #3
  158 T:516b  8d 34 40                           sta prtdev
  158 T:516e  4c c6 50                           jmp mpout
  159 T:5171  a9 04                    mppcentr  lda #4
  159 T:5173  8d 34 40                           sta prtdev
  159 T:5176  4c c6 50                           jmp mpout
  160 T:5179                                    ;****
  161 T:5179  ad 35 40                 mprton    lda prtfl
  161 T:517c  09 80                              ora #128
  162 T:517e  8d 35 40                           sta prtfl
  162 T:5181  60                                 rts 
  163 T:5182  ad 35 40                 mprtoff   lda prtfl
  163 T:5185  29 7f                              and #127
  164 T:5187  8d 35 40                           sta prtfl
  164 T:518a  60                                 rts 

  166 T:518b                                     .end 

PRA 2.4 .S50

    1 T:518b                                     .include "WPW 2.1 .S64"

WPW 2.1 .S64


    3 T:518b                                    ;WPW 2.1 .S64 ==0801==

    6 T:518b                                    cursor=bcpos
    7 T:518b                                    esc=27
    8 T:518b                                    ;********
    9 T:518b                                    manz=40
   10 T:518b                                    mtab=41
   11 T:518b                                    smanz=0
   12 T:518b                                    sml=1
   13 T:518b                                    smor=2
   14 T:518b                                    smlr=3
   15 T:518b                                    smtab=4
   16 T:518b                                    ;********
   17 T:518b  4c 0c 52                 wminit    jmp pminit
   18 T:518e  4c 42 52                 wmenloop  jmp menuloop
   19 T:5191  4c d0 51                 wopen     jmp pwopen
   20 T:5194  4c f1 51                 wclose    jmp pwclose
   21 T:5197  4c 8a a0                 wout      jmp bout
   22 T:519a  4c 9c a0                 wcursor   jmp cursor
   23 T:519d  4c 9f a0                 wgetkey   jmp bgkey
   24 T:51a0  4c 1f 53                 wsubmenu  jmp submenu
   25 T:51a3  4c c3 53                 wsmclose  jmp smclose
   26 T:51a6  4c 65 53                 wsubloop  jmp smloop
   27 T:51a9  4c 6d 53                 wexloop   jmp sml1a
   28 T:51ac  4c 52 54                 wprntcmd  jmp ppcmd
   29 T:51af  4c 4e 54                 wclrcmd   jmp pclrcmd
   30 T:51b2  4c 77 54                 wprnterr  jmp pperr
   31 T:51b5  4c 73 54                 wclrerr   jmp pclrerr
   32 T:51b8  4c 86 54                 wopenmsg  jmp popmsg
   33 T:51bb  4c 62 54                 wprnttxt  jmp pptxt
   34 T:51be  4c a0 54                 winput    jmp pwinput
   35 T:51c1  4c 90 a0                 wcuran    jmp bcan
   36 T:51c4  4c 93 a0                 wcuraus   jmp bcaus
   37 T:51c7  4c 8d a0                 wgetscr   jmp bin

   39 T:51ca  4c 96 a0                 setbck    jmp bbcol
   40 T:51cd  4c 99 a0                 settxt    jmp btcol

   43 T:51d0                                    ;********
   44 T:51d0  48                       pwopen    pha 
   44 T:51d1  8a                                 txa 
   44 T:51d2  48                                 pha 
   45 T:51d3  20 07 52                           jsr wescout
   45 T:51d6  a9 54                              lda #"T"
   45 T:51d8  20 97 51                           jsr wout
   46 T:51db  68                                 pla 
   46 T:51dc  aa                                 tax 
   46 T:51dd  68                                 pla 
   46 T:51de  a8                                 tay 
   46 T:51df  18                                 clc 
   46 T:51e0  20 9a 51                           jsr wcursor
   47 T:51e3  20 07 52                           jsr wescout
   47 T:51e6  a9 42                              lda #"B"
   47 T:51e8  20 97 51                           jsr wout
   48 T:51eb  20 04 52                           jsr wclr
   49 T:51ee  a9 00                              lda #0
   49 T:51f0  60                                 rts 
   50 T:51f1                                    ;********
   51 T:51f1  20 04 52                 pwclose   jsr wclr
   51 T:51f4  a9 13                              lda #19             ;"{home}"
   51 T:51f6  20 97 51                           jsr wout
   51 T:51f9  20 97 51                           jsr wout
   51 T:51fc  a9 92                              lda #18+128       ;"{rvof}"
   51 T:51fe  20 97 51                           jsr wout
   52 T:5201  a9 00                              lda #0
   52 T:5203  60                                 rts 
   53 T:5204                                    ;********
   54 T:5204  a9 93                    wclr      lda #19+128    ;"{clr}"
   54 T:5206  2c                                 .byt $2c
   55 T:5207  a9 1b                    wescout   lda #esc
   55 T:5209  4c 97 51                           jmp wout
   56 T:520c                                    ;********
   57 T:520c  85 12                    pminit    sta wzei
   57 T:520e  84 13                              sty wzei+1
   58 T:5210  20 94 51                           jsr wclose
   58 T:5213  20 04 52                           jsr wclr
   59 T:5216  20 07 52                           jsr wescout
   59 T:5219  a9 4f                              lda #"O"
   59 T:521b  20 97 51                           jsr wout
   60 T:521e  a2 01                              ldx #1
   60 T:5220  a0 00                              ldy #0
   60 T:5222  18                                 clc 
   60 T:5223  20 9a 51                           jsr wcursor
   61 T:5226  a9 12                              lda #18             ;"{rvon}"
   61 T:5228  20 97 51                           jsr wout
   62 T:522b  a0 00                              ldy #0
   63 T:522d  b1 12                    pmi1      lda (wzei),y
   63 T:522f  20 97 51                           jsr wout
   63 T:5232  c8                                 iny 
   63 T:5233  c0 28                              cpy #40
   63 T:5235  d0 f6                              bne pmi1
   64 T:5237  a9 92                              lda #18+128       ;"{rvof}"
   64 T:5239  20 97 51                           jsr wout
   65 T:523c  a9 00                              lda #0
   65 T:523e  8d 71 40                           sta wmenu
   65 T:5241  60                                 rts 
   66 T:5242  20 e2 52                 menuloop  jsr mnorm
   67 T:5245  20 9d 51                 mnl1      jsr wgetkey
   67 T:5248  f0 fb                              beq mnl1
   68 T:524a  a0 03                    mnl1a     ldy #menk-1
   69 T:524c  d9 a1 5e                 mnl2      cmp menkey,y
   69 T:524f  f0 06                              beq mnl3
   69 T:5251  88                                 dey 
   69 T:5252  10 f8                              bpl mnl2
   70 T:5254  4c 42 52                           jmp menuloop
   71 T:5257  98                       mnl3      tya 
   71 T:5258  0a                                 asl 
   71 T:5259  aa                                 tax 
   71 T:525a  20 67 52                           jsr mnl4
   72 T:525d  90 e3                              bcc menuloop
   72 T:525f  c9 0d                              cmp #13
   72 T:5261  d0 e7                              bne mnl1a
   73 T:5263  ae 71 40                           ldx wmenu
   73 T:5266  60                                 rts 
   74 T:5267  bd a6 5e                 mnl4      lda menka+1,x
   74 T:526a  48                                 pha 
   75 T:526b  bd a5 5e                           lda menka,x
   75 T:526e  48                                 pha 
   75 T:526f  60                                 rts 
   76 T:5270                                    ;****
   77 T:5270  20 df 52                 menext    jsr mrevers
   78 T:5273  ee 71 40                           inc wmenu
   79 T:5276  a0 28                              ldy #manz
   79 T:5278  b1 12                              lda (wzei),y
   79 T:527a  cd 71 40                           cmp wmenu
   80 T:527d  d0 05                              bne mener
   80 T:527f  a9 00                              lda #0
   80 T:5281  8d 71 40                           sta wmenu
   81 T:5284  18                       mener     clc 
   81 T:5285  60                                 rts 
   82 T:5286  20 df 52                 mevor     jsr mrevers
   83 T:5289  ad 71 40                           lda wmenu
   83 T:528c  f0 05                              beq mev1
   84 T:528e  ce 71 40                           dec wmenu
   84 T:5291  18                                 clc 
   84 T:5292  60                                 rts 
   85 T:5293  a0 28                    mev1      ldy #manz
   85 T:5295  b1 12                              lda (wzei),y
   86 T:5297  8d 71 40                           sta wmenu
   86 T:529a  ce 71 40                           dec wmenu
   86 T:529d  18                       merr      clc 
   86 T:529e  60                                 rts 
   87 T:529f  20 df 52                 meret     jsr mrevers
   88 T:52a2  ad 71 40                           lda wmenu
   88 T:52a5  20 d8 52                           jsr mtadr
   88 T:52a8  c8                                 iny 
   89 T:52a9  b1 12                              lda (wzei),y
   89 T:52ab  29 40                              and #64
   89 T:52ad  f0 ee                              beq merr
   90 T:52af  a9 0d                              lda #13
   90 T:52b1  a0 00                              ldy #0
   90 T:52b3  38                                 sec 
   90 T:52b4  60                                 rts 
   91 T:52b5  ad 71 40                 mesub     lda wmenu
   91 T:52b8  20 d8 52                           jsr mtadr
   91 T:52bb  c8                                 iny 
   92 T:52bc  b1 12                              lda (wzei),y
   92 T:52be  10 dd                              bpl merr
   93 T:52c0  c8                                 iny 
   93 T:52c1  b1 12                              lda (wzei),y
   93 T:52c3  48                                 pha 
   94 T:52c4  c8                                 iny 
   94 T:52c5  b1 12                              lda (wzei),y
   94 T:52c7  a8                                 tay 
   94 T:52c8  68                                 pla 
   95 T:52c9  a2 00                              ldx #0
   95 T:52cb  20 a0 51                           jsr wsubmenu
   96 T:52ce  20 a6 51                 mesub1    jsr wsubloop
   97 T:52d1  c9 11                    mesub2    cmp #17          ;"{down}"
   97 T:52d3  f0 f9                              beq mesub1
   98 T:52d5  4c a3 51                           jmp wsmclose
   99 T:52d8                                    ;********
  100 T:52d8  0a                       mtadr     asl 
  100 T:52d9  0a                                 asl 
  100 T:52da  18                                 clc 
  100 T:52db  69 29                              adc #mtab
  100 T:52dd  a8                                 tay 
  100 T:52de  60                                 rts 
  101 T:52df  a9 12                    mrevers   lda #18          ;"{rvon}"
  101 T:52e1  2c                                 .byt $2c
  102 T:52e2  a9 92                    mnorm     lda #18+128    ;"{rvof}"
  102 T:52e4  20 97 51                           jsr wout
  103 T:52e7  ad 71 40                           lda wmenu
  103 T:52ea  f0 0a                              beq mno1
  104 T:52ec  38                                 sec 
  104 T:52ed  e9 01                              sbc #1
  105 T:52ef  20 d8 52                           jsr mtadr
  106 T:52f2  b1 12                              lda (wzei),y
  106 T:52f4  a8                                 tay 
  107 T:52f5  2c                                 .byt $2c
  107 T:52f6  a0 00                    mno1      ldy #0
  108 T:52f8  8c 72 40                           sty wza
  109 T:52fb  a2 01                              ldx #1
  109 T:52fd  18                                 clc 
  109 T:52fe  20 9a 51                           jsr wcursor
  110 T:5301  ad 71 40                           lda wmenu
  110 T:5304  20 d8 52                           jsr mtadr
  110 T:5307  b1 12                              lda (wzei),y
  111 T:5309  ac 72 40                           ldy wza
  111 T:530c  8d 72 40                           sta wza
  112 T:530f  b1 12                    mno2      lda (wzei),y
  112 T:5311  20 97 51                           jsr wout
  113 T:5314  c8                                 iny 
  113 T:5315  cc 72 40                           cpy wza
  113 T:5318  d0 f5                              bne mno2
  114 T:531a  a9 92                              lda #18+128       ;"{rvof}"
  114 T:531c  4c 97 51                           jmp wout
  115 T:531f                                    ;****************
  116 T:531f  85 1c                    submenu   sta wszei
  116 T:5321  84 1d                              sty wszei+1
  117 T:5323  8e 75 40                           stx smf
  117 T:5326  e0 80                              cpx #128
  117 T:5328  b0 19                              bcs subm1
  118 T:532a  a0 02                              ldy #smor
  118 T:532c  b1 1c                              lda (wszei),y
  119 T:532e  aa                                 tax 
  119 T:532f  c8                                 iny 
  119 T:5330  b1 1c                              lda (wszei),y
  119 T:5332  a8                                 tay 
  119 T:5333  18                                 clc 
  120 T:5334  20 9a 51                           jsr wcursor
  121 T:5337  a0 00                              ldy #smanz
  121 T:5339  b1 1c                              lda (wszei),y
  121 T:533b  aa                                 tax 
  121 T:533c  ca                                 dex 
  122 T:533d  c8                                 iny 
  122 T:533e  b1 1c                              lda (wszei),y
  122 T:5340  20 91 51                           jsr wopen
  123 T:5343  a9 00                    subm1     lda #0
  123 T:5345  8d 74 40                           sta wsmenu
  123 T:5348  20 04 52                           jsr wclr
  124 T:534b  2c 75 40                           bit smf
  124 T:534e  70 14                              bvs smi11
  125 T:5350  20 ff 53                 smi1      jsr smrevers
  125 T:5353  ee 74 40                           inc wsmenu
  126 T:5356  a0 00                              ldy #smanz
  126 T:5358  b1 1c                              lda (wszei),y
  127 T:535a  cd 74 40                           cmp wsmenu
  127 T:535d  d0 f1                              bne smi1
  128 T:535f  a9 00                              lda #0
  128 T:5361  8d 74 40                           sta wsmenu
  128 T:5364  60                       smi11     rts 
  129 T:5365  20 02 54                 smloop    jsr smnorm
  130 T:5368  20 9d 51                 sml1      jsr wgetkey
  130 T:536b  f0 fb                              beq sml1
  131 T:536d  a0 04                    sml1a     ldy #smka-1
  132 T:536f  d9 ad 5e                 sml2      cmp smkey,y
  132 T:5372  f0 05                              beq sml3
  132 T:5374  88                                 dey 
  132 T:5375  10 f8                              bpl sml2
  133 T:5377  30 08                              bmi smend
  134 T:5379  98                       sml3      tya 
  134 T:537a  0a                                 asl 
  134 T:537b  aa                                 tax 
  134 T:537c  20 86 53                           jsr sml4
  135 T:537f  90 e4                              bcc smloop
  135 T:5381  38                       smend     sec 
  135 T:5382  ac 74 40                           ldy wsmenu
  135 T:5385  60                                 rts 
  136 T:5386  bd b3 5e                 sml4      lda smadr+1,x
  136 T:5389  48                                 pha 
  137 T:538a  bd b2 5e                           lda smadr,x
  137 T:538d  48                                 pha 
  137 T:538e  60                                 rts 
  138 T:538f                                    ;****
  139 T:538f  a9 1d                    smnext    lda #29          ;"{rght}"
  139 T:5391  4c 81 53                           jmp smend
  140 T:5394  a9 9d                    smvor     lda #29+128    ;"{left}"
  140 T:5396  4c 81 53                           jmp smend
  141 T:5399  20 ff 53                 smdown    jsr smrevers
  142 T:539c  a0 00                              ldy #smanz
  142 T:539e  b1 1c                              lda (wszei),y
  143 T:53a0  38                                 sec 
  143 T:53a1  e9 01                              sbc #1
  144 T:53a3  cd 74 40                           cmp wsmenu
  144 T:53a6  f0 05                              beq smd1
  145 T:53a8  ee 74 40                           inc wsmenu
  145 T:53ab  18                                 clc 
  145 T:53ac  60                                 rts 
  146 T:53ad  a9 11                    smd1      lda #17          ;"{down}"
  146 T:53af  38                                 sec 
  146 T:53b0  60                                 rts 
  147 T:53b1  20 ff 53                 smup      jsr smrevers
  148 T:53b4  ad 74 40                           lda wsmenu
  148 T:53b7  f0 05                              beq smu1
  149 T:53b9  ce 74 40                           dec wsmenu
  149 T:53bc  18                                 clc 
  149 T:53bd  60                                 rts 
  150 T:53be  a9 91                    smu1      lda #17+128    ;"{up}"
  150 T:53c0  4c 81 53                           jmp smend
  151 T:53c3  48                       smclose   pha 
  152 T:53c4  20 94 51                           jsr wclose
  152 T:53c7  68                                 pla 
  152 T:53c8  38                                 sec 
  152 T:53c9  60                                 rts 
  153 T:53ca  20 d9 53                 smret     jsr smtadr
  154 T:53cd  a0 00                              ldy #0
  154 T:53cf  b1 10                              lda (lmzei),y
  154 T:53d1  10 04                              bpl smrr
  155 T:53d3  a9 0d                              lda #13
  155 T:53d5  d0 aa                              bne smend
  156 T:53d7  18                       smrr      clc 
  156 T:53d8  60                                 rts 
  157 T:53d9                                    ;****
  158 T:53d9  a0 01                    smtadr    ldy #sml
  158 T:53db  b1 1c                              lda (wszei),y
  158 T:53dd  18                                 clc 
  158 T:53de  69 01                              adc #1
  158 T:53e0  8d 41 40                           sta int1
  158 T:53e3  a2 00                              ldx #0
  158 T:53e5  8e 42 40                           stx int1+1
  159 T:53e8  ad 74 40                           lda wsmenu
  159 T:53eb  20 6f 49                           jsr mult
  160 T:53ee  18                                 clc 
  160 T:53ef  69 04                              adc #smtab
  160 T:53f1  90 01                              bcc sma1
  160 T:53f3  e8                                 inx 
  161 T:53f4  18                       sma1      clc 
  161 T:53f5  65 1c                              adc wszei
  161 T:53f7  85 10                              sta lmzei
  161 T:53f9  8a                                 txa 
  161 T:53fa  65 1d                              adc wszei+1
  161 T:53fc  85 11                              sta lmzei+1
  161 T:53fe  60                                 rts 
  162 T:53ff                                    ;****
  163 T:53ff  a9 12                    smrevers  lda #18          ;"{rvon}"
  163 T:5401  2c                                 .byt $2c
  164 T:5402  a9 92                    smnorm    lda #18+128    ;"{rvof}"
  164 T:5404  48                                 pha 
  165 T:5405  ae 74 40                           ldx wsmenu
  165 T:5408  a0 00                              ldy #0
  165 T:540a  18                                 clc 
  165 T:540b  20 9a 51                           jsr wcursor
  166 T:540e  a0 01                              ldy #sml
  166 T:5410  b1 1c                              lda (wszei),y
  167 T:5412  8d 73 40                           sta sma
  168 T:5415  20 d9 53                           jsr smtadr
  168 T:5418  a0 01                              ldy #1
  169 T:541a  68                                 pla 
  169 T:541b  20 97 51                           jsr wout
  169 T:541e  c9 92                              cmp #18+128       ;"{rvof}"
  169 T:5420  d0 07                              bne smrv1
  169 T:5422  ad 75 40                           lda smf
  169 T:5425  29 20                              and #32
  169 T:5427  d0 0c                              bne smn1
  170 T:5429  b1 10                    smrv1     lda (lmzei),y
  170 T:542b  20 97 51                           jsr wout
  170 T:542e  c8                                 iny 
  171 T:542f  ce 73 40                           dec sma
  171 T:5432  d0 f5                              bne smrv1
  172 T:5434  60                                 rts 
  173 T:5435  a9 12                    smn1      lda #18          ;"{rvon}"
  173 T:5437  20 97 51                           jsr wout
  174 T:543a  a9 28                              lda #"("
  174 T:543c  20 97 51                           jsr wout
  174 T:543f  c8                                 iny 
  174 T:5440  ce 73 40                           dec sma
  174 T:5443  ce 73 40                           dec sma
  175 T:5446  20 29 54                           jsr smrv1
  175 T:5449  a9 29                              lda #")"
  175 T:544b  4c 97 51                           jmp wout
  176 T:544e                                    ;********
  177 T:544e  a9 bc                    pclrcmd   lda #<leerzei
  177 T:5450  a0 5e                              ldy #>leerzei
  178 T:5452  85 22                    ppcmd     sta wczei
  178 T:5454  84 23                              sty wczei+1
  179 T:5456  a0 00                              ldy #0
  179 T:5458  a2 00                              ldx #0
  179 T:545a  18                                 clc 
  179 T:545b  20 9a 51                           jsr wcursor
  180 T:545e  a5 22                    ppe1      lda wczei
  180 T:5460  a4 23                              ldy wczei+1
  181 T:5462  85 22                    pptxt     sta wczei
  181 T:5464  84 23                              sty wczei+1
  182 T:5466  a0 00                              ldy #0
  183 T:5468  b1 22                    ppc1      lda (wczei),y
  183 T:546a  f0 06                              beq ppc2
  183 T:546c  20 97 51                           jsr wout
  184 T:546f  c8                                 iny 
  184 T:5470  d0 f6                              bne ppc1
  185 T:5472  60                       ppc2      rts 
  186 T:5473                                    ;****
  187 T:5473  a9 bc                    pclrerr   lda #<leerzei
  187 T:5475  a0 5e                              ldy #>leerzei
  188 T:5477  85 22                    pperr     sta wczei
  188 T:5479  84 23                              sty wczei+1
  189 T:547b  a0 00                              ldy #0
  189 T:547d  a2 18                              ldx #24
  189 T:547f  18                                 clc 
  189 T:5480  20 9a 51                           jsr wcursor
  190 T:5483  4c 5e 54                           jmp ppe1
  191 T:5486                                    ;********
  192 T:5486  85 22                    popmsg    sta wczei
  192 T:5488  84 23                              sty wczei+1
  193 T:548a  a2 08                              ldx #8
  193 T:548c  a0 08                              ldy #8
  193 T:548e  18                                 clc 
  193 T:548f  20 9a 51                           jsr wcursor
  194 T:5492  a9 17                              lda #23
  194 T:5494  a2 07                              ldx #7
  194 T:5496  20 91 51                           jsr wopen
  195 T:5499  a5 22                              lda wczei
  195 T:549b  a4 23                              ldy wczei+1
  195 T:549d  4c 62 54                           jmp pptxt
  196 T:54a0                                    ;********
  197 T:54a0  85 22                    pwinput   sta wczei
  197 T:54a2  84 23                              sty wczei+1
  198 T:54a4  a2 0f                              ldx #15
  198 T:54a6  a0 00                              ldy #0
  198 T:54a8  18                                 clc 
  198 T:54a9  20 9a 51                           jsr wcursor
  199 T:54ac  a5 22                              lda wczei
  199 T:54ae  a4 23                              ldy wczei+1
  200 T:54b0  20 bb 51                           jsr wprnttxt
  201 T:54b3  38                                 sec 
  201 T:54b4  20 9a 51                           jsr wcursor
  201 T:54b7  8c 72 40                           sty wza
  202 T:54ba  a9 27                              lda #39
  202 T:54bc  38                                 sec 
  202 T:54bd  ed 72 40                           sbc wza
  202 T:54c0  8d 72 40                           sta wza
  203 T:54c3  38                                 sec 
  203 T:54c4  e9 01                              sbc #1
  203 T:54c6  a2 00                              ldx #0
  203 T:54c8  20 91 51                           jsr wopen
  204 T:54cb  20 c1 51                 winloop   jsr wcuran
  205 T:54ce  20 9d 51                 winl      jsr wgetkey
  205 T:54d1  f0 fb                              beq winl
  206 T:54d3  48                                 pha 
  206 T:54d4  20 c4 51                           jsr wcuraus
  206 T:54d7  68                                 pla 
  207 T:54d8  c9 03                              cmp #3
  207 T:54da  f0 2b                              beq wil2
  208 T:54dc  aa                                 tax 
  208 T:54dd  29 7f                              and #127
  208 T:54df  c9 20                              cmp #32
  208 T:54e1  b0 0d                              bcs winl1
  209 T:54e3  a0 09                              ldy #inpanz-1
  209 T:54e5  8a                                 txa 
  209 T:54e6  d9 e4 5e                 winl2     cmp inpok,y
  210 T:54e9  f0 05                              beq winl1
  210 T:54eb  88                                 dey 
  210 T:54ec  10 f8                              bpl winl2
  211 T:54ee  30 db                              bmi winloop
  212 T:54f0  8a                       winl1     txa 
  212 T:54f1  c9 13                              cmp #19             ;"{home}"
  212 T:54f3  d0 05                              bne wil1
  213 T:54f5  cd 41 40                           cmp int1
  213 T:54f8  f0 d1                              beq winloop
  214 T:54fa  c9 0d                    wil1      cmp #13
  214 T:54fc  f0 09                              beq wil2
  215 T:54fe  8d 41 40                           sta int1
  215 T:5501  20 97 51                           jsr wout
  215 T:5504  4c cb 54                           jmp winloop
  216 T:5507  8d 73 40                 wil2      sta sma
  216 T:550a  a9 13                              lda #19             ;"{home}"
  216 T:550c  cd 41 40                           cmp int1
  216 T:550f  f0 03                              beq wil3
  217 T:5511  20 97 51                           jsr wout
  218 T:5514  a0 00                    wil3      ldy #0
  219 T:5516  20 c7 51                 wil4      jsr wgetscr
  220 T:5519  99 00 02                           sta iobuf,y
  220 T:551c  c8                                 iny 
  221 T:551d  cc 72 40                           cpy wza
  221 T:5520  d0 f4                              bne wil4
  222 T:5522  88                                 dey 
  223 T:5523  b9 00 02                 wil5      lda iobuf,y
  223 T:5526  c9 20                              cmp #" "
  223 T:5528  d0 03                              bne wil6
  224 T:552a  88                                 dey 
  224 T:552b  10 f6                              bpl wil5
  225 T:552d  c8                       wil6      iny 
  225 T:552e  a9 00                              lda #0
  225 T:5530  99 00 02                           sta iobuf,y
  226 T:5533  98                                 tya 
  226 T:5534  48                                 pha 
  226 T:5535  20 94 51                           jsr wclose
  227 T:5538  a0 00                              ldy #0
  227 T:553a  a2 0f                              ldx #15
  227 T:553c  18                                 clc 
  227 T:553d  20 9a 51                           jsr wcursor
  228 T:5540  a0 27                              ldy #39
  228 T:5542  a9 20                    wil7      lda #" "
  228 T:5544  20 97 51                           jsr wout
  228 T:5547  88                                 dey 
  228 T:5548  d0 f8                              bne wil7
  229 T:554a  68                                 pla 
  229 T:554b  ae 73 40                           ldx sma
  229 T:554e  e0 03                              cpx #3
  229 T:5550  d0 04                              bne winlx
  229 T:5552  38                                 sec 
  229 T:5553  a9 ea                              lda #enbreak
  229 T:5555  60                                 rts 
  230 T:5556  a2 00                    winlx     ldx #<iobuf
  230 T:5558  a0 02                              ldy #>iobuf
  230 T:555a  18                                 clc 
  230 T:555b  60                                 rts 

  232 T:555c                                     .end 

PRA 2.4 .S50

    1 T:555c                                     .include "PRR 2.4 .S30"

PRR 2.4 .S30


    3 T:555c                                    ;PRR 2.4 .S30 ==0801==
    4 T:555c                           svtab     
    5 T:555c  01 00                              .word 1
    6 T:555e  64 55                              .word jmpadr
    7 T:5560  66 55                              .word newadr
    8 T:5562  37 40                              .word vchout

   10 T:5564  76 00                    jmpadr    .word (chout-bdos)*2/3
   11 T:5566  9f 3a                    newadr    .word pchout

   14 T:5568  20 20 3c 44 49 52 3e ... dirdtext  .asc "  <DIR>  "
   14 T:5571  00                                 .byt 0
   15 T:5572  0d                       dirstext  .byt 13
   15 T:5573  44 49 53 4b 45 54 54 ...           .asc "DISKETTE IN LAUFWERK "
   15 T:5588  00                                 .byt 0
   16 T:5589  0d                       dirntext  .byt 13
   16 T:558a  4e 41 4d 45 20 44 45 ...           .asc "NAME DER DISKETTE :"
   16 T:559d  00                                 .byt 0
   17 T:559e  20 44 41 54 45 49 45 ... dirftext  .asc " DATEIEN AUF DER DISKETTE"
   17 T:55b7  0d 00                              .byt 13,0
   18 T:55b9  20 42 59 54 45 53 20 ... dirbtext  .asc " BYTES FREI"
   18 T:55c4  0d 00                              .byt 13,0
   19 T:55c6  27 03 00 00 00           dhi       .byt >10000,>1000,>100,>10,>1
   20 T:55cb  10 e8 64 0a 01           dlo       .byt <10000,<1000,<100,<10,<1
   21 T:55d0                                    ;********

   34 T:55d0                           bef       
   35 T:55d0  44 45 cc                           .asc "DE","L"+128
   36 T:55d3  4d c4                              .asc "M","D"+128
   37 T:55d5  52 c4                              .asc "R","D"+128
   38 T:55d7  43 52 45 41 54 c5                  .asc "CREAT","E"+128
   39 T:55dd  43 c4                              .asc "C","D"+128
   40 T:55df  46 4f 52 4d 41 d4                  .asc "FORMA","T"+128
   41 T:55e5  52 45 4e 41 4d c5                  .asc "RENAM","E"+128
   42 T:55eb  44 41 54 c5                        .asc "DAT","E"+128
   43 T:55ef  54 49 4d c5                        .asc "TIM","E"+128
   44 T:55f3                                    maxmenu=9
   45 T:55f3  45 58 49 d4                        .asc "EXI","T"+128
   46 T:55f7  52 45 41 c4                        .asc "REA","D"+128
   47 T:55fb  57 52 49 54 c5                     .asc "WRIT","E"+128
   48 T:5600  43 4f 50 d9                        .asc "COP","Y"+128
   49 T:5604  53 41 56 c5                        .asc "SAV","E"+128
   50 T:5608  4c 4f 41 c4                        .asc "LOA","D"+128
   51 T:560c  44 49 d2                           .asc "DI","R"+128
   52 T:560f  d1                                 .asc "Q"+128
   53 T:5610  4d c3                              .asc "M","C"+128
   54 T:5612  42 d0                              .asc "B","P"+128
   55 T:5614  52 c1                              .asc "R","A"+128
   56 T:5616  57 c1                              .asc "W","A"+128
   57 T:5618  cd                                 .asc "M"+128
   58 T:5619  bb                                 .byt ";"+$80
   59 T:561a  d0                                 .asc "P"+128
   60 T:561b  d2                                 .asc "R"+128
   61 T:561c  d7                                 .asc "W"+128
   62 T:561d  43 4f cc                           .asc "CO","L"+128
   63 T:5620  53 59 d3                           .asc "SY","S"+128
   64 T:5623  d5                                 .asc "U"+128
   65 T:5624  43 41 d4                           .asc "CA","T"+128
   66 T:5627  4d 45 4e d5                        .asc "MEN","U"+128
   67 T:562b  43 4f 50 59 43 4f ce               .asc "COPYCO","N"+128
   68 T:5632  50 52 49 4e d4                     .asc "PRIN","T"+128
   69 T:5637  50 52 54 44 45 d6                  .asc "PRTDE","V"+128
   70 T:563d  45 43 48 cf                        .asc "ECH","O"+128

   72 T:5641  00                                 .byt 0
   73 T:5642  58 2b 5d 2b 60 2b 63 ... adr       .word del-1,md-1,rd-1,cr-1,cd-1
   74 T:564c  68 2b 2f 36                        .word pformat-1,prename-1
   75 T:5650  c5 35 af 35                        .word pdate-1,ptime-1
   76 T:5654  21 2c 4a 2c 0a 2d ba 2d            .word ex-1,pread-1,pwrite-1,pcopy-1
   77 T:565c  f5 2e 23 31 fd 36                  .word psave-1,pload-1,dir-1
   78 T:5662  b0 33 d5 33 de 33 4b ...           .word pq-1,pc-1,pb-1,pra-1,pwa-1
   79 T:566c  85 34 20 35 2c 2a fa ...           .word pm-1,pg-1,pp-1,pr-1,pw-1
   80 T:5676  4b 35 a6 2a                        .word pcol-1,lload-1
   81 T:567a  9c 33 52 39 59 2a                  .word pu-1,pcat-1,pmenu-1
   82 T:5680  21 33 0b 3a 70 3a                  .word copycon-1,pprint-1,pprtdev-1
   83 T:5686  55 3a                              .word pecho-1

   85 T:5688  93 11 11 50 52 4f 4d ... coprt     .asc 19+128,17,17,"PROMPT V 2.4  "
   86 T:5699  32 34 2e 30 38 2e 31 ...           .asc "24.08.1989 BY A.FACHAT"
   87 T:56af  0d 0a 00                           .byt 13,10,0
   88 T:56b2  0d                       tpon      .byt 13
   88 T:56b3  50 52 49 4e 54 20 4f 4e            .asc "PRINT ON"
   88 T:56bb  0d 00                              .byt 13,0
   89 T:56bd  0d                       tpoff     .byt 13
   89 T:56be  50 52 49 4e 54 20 4f ...           .asc "PRINT OFF"
   89 T:56c7  0d 00                              .byt 13,0
   90 T:56c9  0d                       tsource   .byt 13
   91 T:56ca  4c 45 47 45 4e 20 53 ...           .asc "LEGEN SIE BITTE DIE QUELLDISKETTE EIN   UND DRUECKEN "
   92 T:56ff  27 52 45 54 55 52 4e 27            .asc "'RETURN'"
   92 T:5707  0d 00                              .byt 13,0
   93 T:5709  0d                       ttarget   .byt 13
   94 T:570a  4c 45 47 45 4e 20 53 ...           .asc "LEGEN SIE BITTE DIE ZIELDISKETTE EIN    UND DRUECKEN "
   95 T:573f  27 52 45 54 55 52 4e 27            .asc "'RETURN'"
   95 T:5747  0d 00                              .byt 13,0
   96 T:5749  0d                       tsoutar   .byt 13
   97 T:574a  4c 45 47 45 4e 20 53 ...           .asc "LEGEN SIE BITTE DIE QUELLDISKETTE UND   "
   98 T:5772  44 49 45 20 5a 49 45 ...           .asc "DIE ZIELDISKETTE EIN UND DRUECKEN       "
   99 T:579a  27 52 45 54 55 52 4e 27            .asc "'RETURN'"
   99 T:57a2  0d 00                              .byt 13,0

  101 T:57a4  0e 02 09                 datum     .byt 14,2,9;+1980=14.2.88
  102 T:57a7  ff fe fd fc fb fa f9     errnum    .byt <-1,<-2,<-3,<-4,<-5,<-6,<-7
  103 T:57ae  f8 f7 f6 f5 f4 f3 f2 f1            .byt <-8,<-9,<-10,<-11,<-12,<-13,<-14,<-15
  104 T:57b6  f0 ef ee ed ec eb ea               .byt <-16,<-17,<-18,<-19,<-20,<-21,<-22
  105 T:57bd  0f 08                              .byt <15,<8
  106 T:57bf  41 42 43 44 45 46 47 ...           .byt 65,66,67,68,69,70,71,72,73
  107 T:57c8  20                                 .byt 32
  108 T:57c9  02 03 05 06 09 0b 0e               .byt 2,3,5,6,9,11,14
  109 T:57d0  5d                                 .byt 29+64
  110 T:57d1  e9 e8 e7                           .byt <-23,<-24,<-25
  111 T:57d4                                    erranz=24+9+1+7+1+3
  112 T:57d4                           ert                        ;
  113 T:57d4  42 45 46 45 48 4c 45 ...           .asc "BEFEHLE NICHT IMPLEMENTIERT"
  113 T:57ef  00                                 .byt 0
  114 T:57f0  55 45 42 45 52 54 52 ...           .asc "UEBERTRAGUNGSFEHLER"
  114 T:5803  00                                 .byt 0
  115 T:5804  4b 45 49 4e 45 20 53 ...           .asc "KEINE SCHNELLE UEBERTRAGUNG"
  115 T:581f  00                                 .byt 0
  116 T:5820  4b 45 49 4e 45 20 4d ...           .asc "KEINE MFM-DISKETTE"
  116 T:5832  00                                 .byt 0
  117 T:5833  50 41 52 41 4d 45 54 ...           .asc "PARAMETER AUSSERHALB DER GRENZEN"
  117 T:5853  00                                 .byt 0
  118 T:5854  43 4c 55 53 54 45 52 ...           .asc "CLUSTER NICHT GEFUNDEN"
  118 T:586a  00                                 .byt 0
  119 T:586b  50 46 41 44 20 4e 49 ...           .asc "PFAD NICHT GEFUNDEN"
  119 T:587e  00                                 .byt 0
  120 T:587f  41 4b 54 55 45 4c 4c ...           .asc "AKTUELLES VERZEICHNIS"
  120 T:5894  00                                 .byt 0
  121 T:5895  4e 41 4d 45 20 4e 49 ...           .asc "NAME NICHT GEFUNDEN"
  121 T:58a8  00                                 .byt 0
  122 T:58a9  50 46 41 44 20 5a 55 ...           .asc "PFAD ZU LANG"
  122 T:58b5  00                                 .byt 0
  123 T:58b6  55 4e 45 52 4c 41 55 ...           .asc "UNERLAUBTER NAME"
  123 T:58c6  00                                 .byt 0
  124 T:58c7  44 49 53 4b 45 54 54 ...           .asc "DISKETTE VOLL"
  124 T:58d4  00                                 .byt 0
  125 T:58d5  44 41 54 45 49 20 45 ...           .asc "DATEI EXISTIERT"
  125 T:58e4  00                                 .byt 0
  126 T:58e5  55 4e 54 45 52 56 45 ...           .asc "UNTERVERZEICHNIS NICHT LEER"
  126 T:5900  00                                 .byt 0
  127 T:5901  55 4e 45 52 4c 41 55 ...           .asc "UNERLAUBTES LAUFWERK"
  127 T:5915  00                                 .byt 0
  128 T:5916  4c 41 55 46 57 45 52 ...           .asc "LAUFWERK NICHT BEREIT"
  128 T:592b  00                                 .byt 0
  129 T:592c  5a 55 56 49 45 4c 45 ...           .asc "ZUVIELE DATEIEN"
  129 T:593b  00                                 .byt 0
  130 T:593c  44 41 54 45 49 20 4f ...           .asc "DATEI OFFEN"
  130 T:5947  00                                 .byt 0
  131 T:5948  44 41 54 45 49 20 4e ...           .asc "DATEI NICHT OFFEN"
  131 T:5959  00                                 .byt 0
  132 T:595a  45 4e 44 45 20 44 45 ...           .asc "ENDE DER DATEI"
  132 T:5968  00                                 .byt 0
  133 T:5969  4b 45 49 4e 20 46 52 ...           .asc "KEIN FREIER PUFFER"
  133 T:597b  00                                 .byt 0
  134 T:597c  55 4e 54 45 52 42 52 ...           .asc "UNTERBRECHUNG"
  134 T:5989  00                                 .byt 0
  135 T:598a  4c 41 55 46 57 45 52 ...           .asc "LAUFWERK NICHT VORHANDEN"
  135 T:59a2  00                                 .byt 0
  136 T:59a3  53 43 48 52 45 49 42 ...           .asc "SCHREIBSCHUTZ AN"
  136 T:59b3  00                                 .byt 0
  137 T:59b4  54 4f 4f 20 4d 41 4e ...           .asc "TOO MANY FILES"
  137 T:59c2  00                                 .byt 0
  138 T:59c3  46 49 4c 45 20 4f 50 ...           .asc "FILE OPEN"
  138 T:59cc  00                                 .byt 0
  139 T:59cd  46 49 4c 45 20 4e 4f ...           .asc "FILE NOT OPEN"
  139 T:59da  00                                 .byt 0
  140 T:59db  46 49 4c 45 20 4e 4f ...           .asc "FILE NOT FOUND"
  140 T:59e9  00                                 .byt 0
  141 T:59ea  44 45 56 49 43 45 20 ...           .asc "DEVICE NOT PRESENT"
  141 T:59fc  00                                 .byt 0
  142 T:59fd  4e 4f 54 20 49 4e 50 ...           .asc "NOT INPUT FILE"
  142 T:5a0b  00                                 .byt 0
  143 T:5a0c  4e 4f 54 20 4f 55 54 ...           .asc "NOT OUTPUT FILE"
  143 T:5a1b  00                                 .byt 0
  144 T:5a1c  4d 49 53 53 49 4e 47 ...           .asc "MISSING FILENAME"
  144 T:5a2c  00                                 .byt 0
  145 T:5a2d  49 4c 4c 45 47 41 4c ...           .asc "ILLEGAL DEVICE NUMBER"
  145 T:5a42  00                                 .byt 0
  146 T:5a43  56 45 52 5a 45 49 43 ...           .asc "VERZEICHNISLISTE VOLL"
  146 T:5a58  00                                 .byt 0
  147 T:5a59  53 45 4b 54 4f 52 20 ...           .asc "SEKTOR NICHT GEFUNDEN"
  147 T:5a6e  00                                 .byt 0
  148 T:5a6f  4b 45 49 4e 45 20 41 ...           .asc "KEINE ADRESSMARKE"
  148 T:5a80  00                                 .byt 0
  149 T:5a81  43 52 43 2d 44 41 54 ...           .asc "CRC-DATENFEHLER"
  149 T:5a90  00                                 .byt 0
  150 T:5a91  46 4f 52 4d 41 54 46 ...           .asc "FORMATFEHLER"
  150 T:5a9d  00                                 .byt 0
  151 T:5a9e  48 45 41 44 45 52 2d ...           .asc "HEADER-PRUEFSUMMENFEHLER"
  151 T:5ab6  00                                 .byt 0
  152 T:5ab7  44 49 53 4b 45 54 54 ...           .asc "DISKETTENWECHSEL"
  152 T:5ac7  00                                 .byt 0
  153 T:5ac8  53 59 4e 54 41 58 46 ...           .asc "SYNTAXFEHLER"
  153 T:5ad4  00                                 .byt 0
  154 T:5ad5  4c 4f 41 44 20 45 52 ...           .asc "LOAD ERROR"
  154 T:5adf  00                                 .byt 0
  155 T:5ae0  49 2f 4f 2d 44 45 56 ...           .asc "I/O-DEVICE NOT PRESENT"
  155 T:5af6  00                                 .byt 0
  156 T:5af7  45 4e 44 42 46 20                  .asc "ENDBF "
  156 T:5afd  00                                 .byt 0
  157 T:5afe  45 4e 44 42 45 20                  .asc "ENDBE "
  157 T:5b04  00                                 .byt 0
  158 T:5b05  2d 4d 45 4c 44 55 4e 47  errnumt   .asc "-MELDUNG"
  158 T:5b0d  00                                 .byt 0

  161 T:5b0e  6c 3b 78 3b              mpma      .word mpm1-1,mpm2-1
  162 T:5b12  84 3b 90 3b 9c 3b                  .word mpm3-1,mpm4-1,mpm5-1
  163 T:5b18  aa 3b cb 3b              mpm1a     .word mpm11-1,mpm12-1
  164 T:5b1c  20 3c 15 3c 00 00                  .word mpm13-1,mpm14-1,0
  165 T:5b22  99 4e a7 4e ba 4e                  .word mpm51-1,mpm52-1,mpm53-1
  166 T:5b28  cf 4e e4 4e                        .word mpm54-1,mpm55-1
  167 T:5b2c  d1 49 b1 49              mpm2a     .word mpm21-1,mpm22-1
  168 T:5b30  e2 4d 93 47 90 47                  .word mpm23-1,mpmread-1,mpmprint-1
  169 T:5b36  f5 4d 07 4e 70 4d                  .word mpm24-1,mpm25-1,mpm26-1
  170 T:5b3c  c6 36 7a 4e 2b 3c                  .word mrename-1,mpm27-1,mpm28-1
  171 T:5b42  49 3f 4e 3c              mpm3a     .word mpm31-1,mpm32-1
  172 T:5b46  f3 48 f0 48                        .word mpcread-1,mpcprint-1
  173 T:5b4a  3e 40 7d 3c                        .word mpm33-1,mpm34-1
  174 T:5b4e  b2 41 b0 43              mpm4a     .word mpm41-1,mpm42-1
  175 T:5b52  99 45 00 00 f6 4f                  .word mpm43-1,0,mpm45-1
  176 T:5b58  06 50 16 50                        .word mpm46-1,mpm47-1
  177 T:5b5c  00 00                    mpm5a     .word 0

  182 T:5b5e  68 51                              .word mppiec-1
  183 T:5b60  70 51 00 00                        .word mppcentr-1,0
  184 T:5b64  25 51 30 51                        .word mppnokon-1,mppacbm-1
  185 T:5b68  3d 51 00 00                        .word mppcasc-1,0
  186 T:5b6c  4a 51 55 51                        .word mppcr-1,mpplf-1
  187 T:5b70                                    ;********
  188 T:5b70                           mainmenu  
  189 T:5b70  20 42 44 4f 53 20 20 ...           .asc " BDOS    PC    CBM    COPY   PRINT      "
  190 T:5b98  05                                 .byt 5
  191 T:5b99  08 80                              .byt 8,128
  191 T:5b9b  ad 5b                              .word mallg
  192 T:5b9d  0e 80                              .byt 14,128
  192 T:5b9f  29 5c                              .word mpcdisk
  193 T:5ba1  15 80                              .byt 21,128
  193 T:5ba3  a6 5c                              .word mcbmdisk
  194 T:5ba5  1c 80                              .byt 28,128
  194 T:5ba7  e6 5c                              .word mcopy
  195 T:5ba9  23 80                              .byt 35,128
  195 T:5bab  45 5d                              .word mprint
  196 T:5bad  0a                       mallg     .byt 10
  197 T:5bae  0b 02 01                           .byt 11,2,1
  198 T:5bb1  80                                 .byt 128
  198 T:5bb2  20 43 4f 50 59 52 49 ...           .asc " COPYRIGHT "
  199 T:5bbd  80                                 .byt 128
  199 T:5bbe  20 46 41 52 42 45 4e ...           .asc " FARBEN    "
  200 T:5bc9  80                                 .byt 128
  200 T:5bca  20 43 4c 49 20 20 20 ...           .asc " CLI       "
  201 T:5bd5  80                                 .byt 128
  201 T:5bd6  20 45 4e 44 45 20 20 ...           .asc " ENDE      "
  202 T:5be1  00                                 .byt 0
  202 T:5be2  2d 53 4f 52 54 20 4e ...           .asc "-SORT NACH-"
  203 T:5bed  80                                 .byt 128
  203 T:5bee  20 4e 49 43 48 54 53 ... hk11      .asc " NICHTS    "
  204 T:5bf9  80                                 .byt 128
  204 T:5bfa  20 4e 41 4d 45 20 20 ... hk12      .asc " NAME      "
  205 T:5c05  80                                 .byt 128
  205 T:5c06  20 45 58 54 2f 53 50 ... hk13      .asc " EXT/SPUR  "
  206 T:5c11  80                                 .byt 128
  206 T:5c12  20 47 52 4f 45 53 53 ... hk14      .asc " GROESSE   "
  207 T:5c1d  80                                 .byt 128
  207 T:5c1e  20 41 55 46 2f 41 42 ... hk15      .asc " AUF/AB    "
  208 T:5c29  0b                       mpcdisk   .byt 11
  209 T:5c2a  0a 02 09                           .byt 10,2,9
  210 T:5c2d  80                                 .byt 128
  210 T:5c2e  20 44 49 52 20 20 20 ...           .asc " DIR      "
  211 T:5c38  80                                 .byt 128
  211 T:5c39  20 44 52 49 56 45 20 ...           .asc " DRIVE    "
  212 T:5c43  80                                 .byt 128
  212 T:5c44  20 50 46 41 44 20 20 ...           .asc " PFAD     "
  213 T:5c4e  80                                 .byt 128
  213 T:5c4f  20 52 45 41 44 20 20 ...           .asc " READ     "
  214 T:5c59  80                                 .byt 128
  214 T:5c5a  20 50 52 49 4e 54 20 ...           .asc " PRINT    "
  215 T:5c64  80                                 .byt 128
  215 T:5c65  20 4d 41 4b 45 20 44 ...           .asc " MAKE DIR "
  216 T:5c6f  80                                 .byt 128
  216 T:5c70  20 44 45 4c 20 44 49 ...           .asc " DEL DIR  "
  217 T:5c7a  80                                 .byt 128
  217 T:5c7b  20 44 45 4c 45 54 45 ...           .asc " DELETE   "
  218 T:5c85  80                                 .byt 128
  218 T:5c86  20 52 45 4e 41 4d 45 ...           .asc " RENAME   "
  219 T:5c90  80                                 .byt 128
  219 T:5c91  20 46 4f 52 4d 41 54 ...           .asc " FORMAT   "
  220 T:5c9b  80                                 .byt 128
  220 T:5c9c  20 43 4f 4d 4d 41 4e ...           .asc " COMMAND  "
  221 T:5ca6  06                       mcbmdisk  .byt 6
  222 T:5ca7  09 02 0f                           .byt 9,2,15
  223 T:5caa  80                                 .byt 128
  223 T:5cab  20 43 41 54 20 20 20 ...           .asc " CAT     "
  224 T:5cb4  80                                 .byt 128
  224 T:5cb5  20 55 4e 49 54 20 20 ...           .asc " UNIT    "
  225 T:5cbe  80                                 .byt 128
  225 T:5cbf  20 52 45 41 44 20 20 ...           .asc " READ    "
  226 T:5cc8  80                                 .byt 128
  226 T:5cc9  20 50 52 49 4e 54 20 ...           .asc " PRINT   "
  227 T:5cd2  80                                 .byt 128
  227 T:5cd3  20 53 43 52 41 54 43 ...           .asc " SCRATCH "
  228 T:5cdc  80                                 .byt 128
  228 T:5cdd  20 43 4f 4d 4d 41 4e ...           .asc " COMMAND "
  229 T:5ce6  07                       mcopy     .byt 7
  230 T:5ce7  0c 02 16                           .byt 12,2,22
  231 T:5cea  80                                 .byt 128
  231 T:5ceb  20 50 43 20 20 2d 3e ...           .asc " PC  -> PC  "
  232 T:5cf7  80                                 .byt 128
  232 T:5cf8  20 50 43 20 20 2d 3e ...           .asc " PC  -> CBM "
  233 T:5d04  80                                 .byt 128
  233 T:5d05  20 43 42 4d 20 2d 3e ...           .asc " CBM -> PC  "
  234 T:5d11  00                                 .byt 0
  234 T:5d12  2d 2d 54 45 58 54 43 ...           .asc "--TEXTCOPY--"
  235 T:5d1e  80                                 .byt 128
  235 T:5d1f  20 41 53 43 20 2d 3e ... hk21      .asc " ASC -> CBM "
  236 T:5d2b  80                                 .byt 128
  236 T:5d2c  20 43 42 4d 20 2d 3e ... hk22      .asc " CBM -> ASC "
  237 T:5d38  80                                 .byt 128
  237 T:5d39  20 41 55 53 20 20 20 ... hk23      .asc " AUS        "
  238 T:5d45  0a                       mprint    .byt 10+rs232
  239 T:5d46  0c 02 1a                           .byt 12,2,26
  240 T:5d49  00                                 .byt 0
  240 T:5d4a  2d 2d 2d 44 45 56 49 ...           .asc "---DEVICE---"

  247 T:5d56  80                                 .byt 128

  249 T:5d57                           hk56      

  251 T:5d57  20 49 45 43 2d 42 55 ... hk57      .asc " IEC-BUS    "
  252 T:5d63  80                                 .byt 128
  252 T:5d64  20 43 45 4e 54 52 4f ... hk58      .asc " CENTRONICS "
  253 T:5d70  00                                 .byt 0
  253 T:5d71  2d 2d 4b 4f 4e 56 45 ...           .asc "--KONVERT---"
  254 T:5d7d  80                                 .byt 128
  254 T:5d7e  20 4b 45 49 4e 45 20 ... hk51      .asc " KEINE      "
  255 T:5d8a  80                                 .byt 128
  255 T:5d8b  20 41 53 43 20 2d 3e ... hk52      .asc " ASC -> CBM "
  256 T:5d97  80                                 .byt 128
  256 T:5d98  20 43 42 4d 20 2d 3e ... hk53      .asc " CBM -> ASC "
  257 T:5da4  00                                 .byt 0
  257 T:5da5  2d 2d 2d 43 52 2f 4c ...           .asc "---CR/LF----"
  258 T:5db1  80                                 .byt 128
  258 T:5db2  20 43 52 20 2d 3e 20 ... hk54      .asc " CR -> CRLF "
  259 T:5dbe  80                                 .byt 128
  259 T:5dbf  20 4c 46 20 2d 3e 20 ... hk55      .asc " LF -> CRLF "
  260 T:5dcb                           coptxt    
  261 T:5dcb  93                                 .asc 19+128        ;"{clr}"
  262 T:5dcc  20 20 20 20 20 20 4d ...           .asc "      MENU V 2.4 "
  262 T:5ddd  0d 0d                              .byt 13,13
  263 T:5ddf  20 20 20 20 20 20 20 ...           .asc "       COPYRIGHT"
  263 T:5def  0d 0d                              .byt 13,13
  264 T:5df1  32 34 2e 30 38 2e 31 ...           .asc "24.08.1989 BY A.FACHAT"
  265 T:5e07  0d 0d                              .byt 13,13
  266 T:5e09  20 44 52 55 45 43 4b ...           .asc " DRUECKEN SIE 'RETURN'"
  267 T:5e1f  00                                 .byt 0
  268 T:5e20                           coltxt    
  269 T:5e20  93                                 .asc 19+128        ;"{clr}"
  270 T:5e21  20 56 45 52 41 45 4e ...           .asc " VERAENDERN DER FARBEN: "
  271 T:5e39  0d                                 .byt 13
  272 T:5e3a  20 20 48 49 4e 54 45 ...           .asc "  HINTERGRUND MIT :"
  272 T:5e4d  0d                                 .byt 13
  273 T:5e4e  20 20 20 20 43 55 52 ...           .asc "    CURSOR RECHTS/LINKS "
  274 T:5e66  20 20 54 45 58 54 20 ...           .asc "  TEXT MIT :"
  274 T:5e72  0d                                 .byt 13
  275 T:5e73  20 20 20 20 43 55 52 ...           .asc "    CURSOR HOCH/RUNTER "
  276 T:5e8a  0d 0d                              .byt 13,13
  277 T:5e8c  20 57 45 49 54 45 52 ...           .asc " WEITER MIT 'RETURN'"
  278 T:5ea0  00                                 .byt 0
  279 T:5ea1                                    ;********
  280 T:5ea1                                    menk=4

  282 T:5ea1  1d 9d 11 0d              menkey    .byt 29,29+128,17,13
  283 T:5ea5  6f 52 85 52 b4 52 9e 52  menka     .word menext-1,mevor-1,mesub-1,meret-1
  284 T:5ead                                    ;********
  285 T:5ead                                    smka=5

  287 T:5ead  1d 9d 11 91 0d           smkey     .byt 29,29+128,17,17+128,13
  288 T:5eb2  8e 53 93 53 98 53 b0 ... smadr     .word smnext-1,smvor-1,smdown-1,smup-1,smret-1
  289 T:5ebc                                    ;********
  290 T:5ebc  20 20 20 20 20 20 20 ... leerzei   .asc "                                       "
  290 T:5ee3  00                                 .byt 0
  291 T:5ee4                                    inpanz=10

  293 T:5ee4  1d 11 91 9d 13 93 94     inpok     .asc 29,17,17+128,29+128,19,19+128,20+128
  293 T:5eeb  0d 03 14                           .byt 13,3,20
  294 T:5eee  44 52 49 56 45 3a        cppt1     .asc "DRIVE:"
  294 T:5ef4  00                                 .byt 0

  296 T:5ef5  13 44 41 54 45 49 20 ... gtnnt     .asc 19,"DATEI EXISTIERT SCHON !"
  296 T:5f0d  0d 0d                              .byt 13,13
  297 T:5f0f  3c 52 55 4e 2f 53 54 ...           .asc "<RUN/STOP>=ENDE"
  297 T:5f1e  0d                                 .byt 13

  299 T:5f1f  11 3c 3d 3e 20 20 20 ...           .asc 17,"<=>       =NEUEN NAMEN"
  299 T:5f36  0d                                 .byt 13

  301 T:5f37  11 3c 52 45 54 3e 20 ...           .asc 17,"<RET>     =WEITER"
  301 T:5f49  00                                 .byt 0

  303 T:5f4a  13 11 11 20 20 4c 45 ... adt       .asc 19,17,17,"  LEGEN SIE DIE"
  303 T:5f5c  0d                                 .byt 13

  305 T:5f5d  11 20 20 51 55 45 4c ...           .asc 17,"  QUELL- UND DIE ZIEL-"
  305 T:5f74  0d                                 .byt 13

  307 T:5f75  11 20 20 44 49 53 4b ...           .asc 17,"  DISKETTE EIN !"
  307 T:5f86  00                                 .byt 0

  309 T:5f87  0d 0a 11 91 13 93 1d 9d  chtkeys   .byt 13,10,17,17+128,19,19+128,29,29+128
  310 T:5f8f                                    anztkey=8
  311 T:5f8f  20 45 58 49 53 54 49 ... gtnnt3    .asc " EXISTIERT SCHON"
  311 T:5f9f  00                                 .byt 0
  312 T:5fa0  be 5f e3 5f 09 60 1c 60  ptta      .word ptt1,ptt2,ptt3,ptt4
  313 T:5fa8  35 60 4d 60 74 60 96 ...           .word ptt5,ptt6,ptt7,ptt8,ptt9
  314 T:5fb2  cf 60 e5 60 02 61 24 61            .word ptt10,ptt11,ptt12,ptt13
  315 T:5fba  3c 61 56 61                        .word ptt14,ptt15
  316 T:5fbe  47 45 42 45 4e 20 53 ... ptt1      .asc "GEBEN SIE SUCHMASKE EIN (Z.B. AB?C*)"
  316 T:5fe2  00                                 .byt 0
  317 T:5fe3  3c 52 55 4e 2f 53 54 ... ptt2      .asc "<RUN/STOP>,<SH.RET>=SUBDIR,<RET>=ENDE"
  317 T:6008  00                                 .byt 0
  318 T:6009  3c 52 45 54 3e 20 57 ... ptt3      .asc "<RET> WAEHLT DRIVE"
  318 T:601b  00                                 .byt 0
  319 T:601c  47 45 42 45 4e 20 53 ... ptt4      .asc "GEBEN SIE NEUEN PFAD EIN"
  319 T:6034  00                                 .byt 0
  320 T:6035  47 45 42 45 4e 20 53 ... ptt5      .asc "GEBEN SIE DEN NAMEN EIN"
  320 T:604c  00                                 .byt 0
  321 T:604d  3c 52 55 4e 2f 53 54 ... ptt6      .asc "<RUN/STOP>,<SH.RET>=SUBDIR,<=>=WAEHLEN"
  321 T:6073  00                                 .byt 0
  322 T:6074  3c 52 55 4e 2f 53 54 ... ptt7      .asc "<RUN/STOP>,<=>=WAEHLEN,<RET>=ENDE"
  322 T:6095  00                                 .byt 0
  323 T:6096  47 45 42 45 4e 20 53 ... ptt8      .asc "GEBEN SIE DRIVE + NAME DER DISK EIN"
  323 T:60b9  00                                 .byt 0
  324 T:60ba  47 45 42 45 4e 20 53 ... ptt9      .asc "GEBEN SIE BEFEHL EIN"
  324 T:60ce  00                                 .byt 0
  325 T:60cf  3c 52 55 4e 2f 53 54 ... ptt10     .asc "<RUN/STOP>,<RET>=ENDE"
  325 T:60e4  00                                 .byt 0
  326 T:60e5  3c 52 45 54 3e 20 57 ... ptt11     .asc "<RET> WAEHLT UNIT ODER DRIVE"
  326 T:6101  00                                 .byt 0
  327 T:6102  47 45 42 45 4e 20 53 ... ptt12     .asc "GEBEN SIE ZIELLAUFWERK + PFAD EIN"
  327 T:6123  00                                 .byt 0
  328 T:6124  44 52 55 45 43 4b 45 ... ptt13     .asc "DRUECKEN SIE EINE TASTE"
  328 T:613b  00                                 .byt 0
  329 T:613c  47 45 42 45 4e 20 53 ... ptt14     .asc "GEBEN SIE NEUEN NAMEN EIN"
  329 T:6155  00                                 .byt 0
  330 T:6156  3c 52 55 4e 2f 53 54 ... ptt15     .asc "<RUN/STOP>,<=>=WAEHLEN"
  330 T:616c  00                                 .byt 0
  331 T:616d  04                       mpdt      .byt 4
  332 T:616e  0a 0a 0f                           .byt 10,10,15
  333 T:6171  80                                 .byt 128
  333 T:6172  20 44 52 49 56 45 20 ...           .asc " DRIVE A: "
  334 T:617c  80                                 .byt 128
  334 T:617d  20 44 52 49 56 45 20 ...           .asc " DRIVE B: "
  335 T:6187  80                                 .byt 128
  335 T:6188  20 44 52 49 56 45 20 ...           .asc " DRIVE C: "
  336 T:6192  80                                 .byt 128
  336 T:6193  20 44 52 49 56 45 20 ...           .asc " DRIVE D: "
  337 T:619d  50 46 41 44 20 3a        ismpt     .asc "PFAD :"
  337 T:61a3  00                                 .byt 0
  338 T:61a4  4e 41 4d 45 20 3a        isnpt     .asc "NAME :"
  338 T:61aa  00                                 .byt 0

  340 T:61ab  93 11                    mwt       .asc 19+128,17

  342 T:61ad  11 20 20 20 20 20 46 ...           .asc 17,"     FEHLER !"
  342 T:61bb  0d 0d                              .byt 13,13

  344 T:61bd  11 52 45 54 20 20 20 ...           .asc 17,"RET      = WEITER"
  344 T:61cf  0d                                 .byt 13

  346 T:61d0  11 52 55 4e 2f 53 54 ...           .asc 17,"RUN/STOP = ENDE"
  347 T:61e0  00                                 .byt 0
  348 T:61e1  20 3c 44 49 52 3e        sdirt     .asc " <DIR>"
  348 T:61e7  00                                 .byt 0
  349 T:61e8  20 42 59 54 45 53 20 ... dirbfrei  .asc " BYTES FREI"
  349 T:61f3  00                                 .byt 0
  350 T:61f4                                    ;********
  351 T:61f4  07 09 07 0d              m32mt     .byt 7,9,7,13
  352 T:61f8  80                                 .byt 128
  352 T:61f9  20 55 4e 49 54 20 38 ...           .asc " UNIT 8  "
  353 T:6202  80                                 .byt 128
  353 T:6203  20 55 4e 49 54 20 39 ...           .asc " UNIT 9  "
  354 T:620c  80                                 .byt 128
  354 T:620d  20 55 4e 49 54 20 31 ...           .asc " UNIT 10 "
  355 T:6216  80                                 .byt 128
  355 T:6217  20 55 4e 49 54 20 31 ...           .asc " UNIT 11 "
  356 T:6220  00                                 .byt 0
  356 T:6221  20 20 20 20 20 20 20 ...           .asc "         "
  357 T:622a  80                                 .byt 128
  357 T:622b  20 44 52 49 56 45 20 ...           .asc " DRIVE 0 "
  358 T:6234  80                                 .byt 128
  358 T:6235  20 44 52 49 56 45 20 ...           .asc " DRIVE 1 "
  359 T:623e  44 49 53 4b 2d 42 45 ... m34t      .asc "DISK-BEFEHL :"
  359 T:624b  00                                 .byt 0
  360 T:624c  4d 41 53 4b 45 20 3a     ismct     .asc "MASKE :"
  360 T:6253  00                                 .byt 0
  361 T:6254  20 42 4c 2e 46 52 45 49  m31bft    .asc " BL.FREI"
  361 T:625c  00                                 .byt 0

  367 T:625d                                    mdiranz=19
  367 T:625d                                    mdirtbrt=27
  368 T:625d                                    ;dirmenu am ende
  369 T:625d                                    mdirtlen=mdiranz*(mdirtbrt+1)+4

  371 T:625d  13                       ast       .asc 19
  371 T:625e  0d                                 .byt 13
  372 T:625f  20 53 49 4e 44 20 53 ...           .asc " SIND SIE SICH SICHER ?"
  372 T:6276  0d 0d                              .byt 13,13
  373 T:6278  20 20 20 20 52 55 4e ...           .asc "    RUN/STOP =NEIN"
  373 T:628a  0d 0d                              .byt 13,13
  374 T:628c  20 20 20 20 52 45 54 ...           .asc "    RETURN   =JA"
  374 T:629c  00                                 .byt 0
  375 T:629d  42 45 46 45 48 4c 20 3a  mbeft     .asc "BEFEHL :"
  375 T:62a5  00                                 .byt 0
  376 T:62a6  43 42 4d 3e 44           stlt1     .asc "CBM>D"
  376 T:62ab  00                                 .byt 0
  377 T:62ac  3a 50 43 3e              stlt2     .asc ":PC>"
  377 T:62b0  00                                 .byt 0
  378 T:62b1                                    stlend=39-5-4-5
  379 T:62b1  02 00                    soname    .byt 2,0
  380 T:62b3  12 08                    sonamend  .byt 18,8
  381 T:62b5  13 08                    soext     .byt 19,8
  382 T:62b7  14 0b                    soextend  .byt 20,11
  383 T:62b9  00 0c                    sosize    .byt 0,12
  384 T:62bb  02 10                    sosizend  .byt 2,16
  385 T:62bd  14 13                    sollen    .byt 20,19

  387 T:62bf                                     .end 

PRA 2.4 .S50

    1 T:62bf                                     .bss 

   55 B:4000                                    varanf=*
   56 B:4000                                     .include "PRD 2.4 .S28"

PRD 2.4 .S28


    3 B:4000                                    ;PRD 2.4 .S28 ==0801==
    4 B:4000  00 00                    prblen    .word 0
    5 B:4002                           ddtp      

    7 B:4002  00 fe cc 00 2c ff 00 ...           .dsb dtplen,0
    8 B:4030  00                       fformat   .byt 0
    9 B:4031  00 00                    fadr      .word 0
   10 B:4033  00                       iecunit   .byt 0
   11 B:4034  00                       prtdev    .byt 0
   12 B:4035  00                       prtfl     .byt 0
   13 B:4036  00                       prtdiv    .byt 0
   14 B:4037  00 00                    vchout    .word 0

   17 B:4039  00 00                    dosd0     .word 0
   18 B:403b  00 00                    iecd0     .word 0
   19 B:403d  00 00                    drvd0     .word 0
   20 B:403f                                    ;*********
   21 B:403f  00 00                    dircount  .word 0
   22 B:4041  00 00                    dint1     .word 0
   23 B:4043  00 00                    dint2     .word 0
   24 B:4045  00 00                    dint3     .word 0
   25 B:4047  00                       dabuf     .byt 0
   26 B:4048  00 00 00 00              dword     .word 0,0
   27 B:404c  00 00                    dcl       .word 0
   28 B:404e  00 00                    dpa       .word 0
   29 B:4050  00                       cnt       .byt 0
   30 B:4051  00                       handle    .byt 0
   31 B:4052  00                       handl2    .byt 0
   32 B:4053  00                       st1       .byt 0
   33 B:4054  00                       flag      .byt 0
   34 B:4055  00                       dr1       .byt 0
   35 B:4056  00                       dr2       .byt 0
   36 B:4057  00 00                    nadr      .word 0
   37 B:4059  00 00                    fad2      .word 0
   38 B:405b  00 00                    tplen     .word 0
   39 B:405d  00 00                    fl1       .word 0
   40 B:405f  00 00 00 00              laenge    .byt 0,0,0,0
   41 B:4063  00 00 00 00 00 00 00 ... pblock    .word 0,0,0,0,0
   42 B:406d  00 00                    llvec     .word 0
   43 B:406f  00                       clitcol   .byt 0
   44 B:4070  00                       clibcol   .byt 0
   45 B:4071                                    ;********

   56 B:4071                                    int1=dint1
   57 B:4071                                    int2=dint2
   58 B:4071                                    int3=dint3

   60 B:4071  00                       wmenu     .byt 0
   61 B:4072  00                       wza       .byt 0
   62 B:4073  00                       sma       .byt 0
   63 B:4074  00                       wsmenu    .byt 0
   64 B:4075  00                       smf       .byt 0
   65 B:4076  00 00 00 00              oldsize   .byt 0,0,0,0
   66 B:407a  00                       oldhdl    .byt 0
   67 B:407b  00                       olderr    .byt 0
   68 B:407c  00                       newhdl    .byt 0
   69 B:407d  00                       olddrv    .byt 0
   70 B:407e  00                       newdrv    .byt 0
   71 B:407f  00 00                    ccnt      .byt 0,0
   72 B:4081  00                       gtpd      .byt 0
   73 B:4082  00                       mpdb      .byt 0
   74 B:4083  00                       mpdcmd    .byt 0
   75 B:4084  00 00                    cdir      .word 0
   76 B:4086  00                       gdb       .byt 0
   77 B:4087  00                       lanz      .byt 0
   78 B:4088  00                       lmanz     .byt 0
   79 B:4089  00                       mpdf      .byt 0
   80 B:408a  00                       lseit     .byt 0
   81 B:408b  00                       abuf      .byt 0
   82 B:408c  00                       iecdrive  .byt 0
   83 B:408d  00                       panzsub   .byt 0
   84 B:408e  00                       menutcol  .byt 0
   85 B:408f  00                       menubcol  .byt 0
   86 B:4090  00                       cvfl      .byt 0

   90 B:4091  00                       sofl      .byt 0
   91 B:4092  00                       sonk      .byt 0
   92 B:4093  00                       sofirst   .byt 0
   93 B:4094  00                       solast    .byt 0
   94 B:4095  00                       socount   .byt 0
   95 B:4096  00                       sokrit    .byt 0
   96 B:4097  00                       sokend    .byt 0
   97 B:4098  00                       soelen    .byt 0
   98 B:4099  00 00                    sofadr    .word 0
   99 B:409b                           dirmenu   

  101 B:409b  00 fe 3f 05 2c ff 00 ...           .dsb mdirtlen,0
  102 B:42b3                           pcsuch    

  104 B:42b3  00 fe b9 00 2c ff 00 ...           .dsb dsattr,0
  105 B:42be                                    pcdta=ddtp
  106 B:42be                                    liste=*

  108 B:42be                                    buffer=bufanf
  109 B:42be                                    dbuf=$0100
  110 B:42be                                    listend=bufanf
  111 B:42be                                     .end 

PRA 2.4 .S50

    1 B:42be                                    varend=*

   58 B:42be                                     .text 
   59 T:62bf  be 42                              .word varend             ;=listanf
   60 T:62c1  00 6c                              .word bufanf                ;=listend

   63 T:62c3                                     .end 
